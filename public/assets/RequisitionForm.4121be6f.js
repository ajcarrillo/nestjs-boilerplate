import{Q as kt}from"./QPage.508d9960.js";import{_ as St}from"./plugin-vue_export-helper.21dcd24c.js";import{p as we,k as jt,l as R,s as $,aP as Je,c as s,v as Ae,r as j,w as oe,h as u,$ as he,x as Ht,g as Fe,J as Xe,X as U,aV as Yt,a2 as ut,a3 as Nt,a5 as st,aa as Et,a9 as At,ah as Ot,ax as It,j as Pt,N as Tt,V as Rt,ag as Ye,d as k,_ as ge,an as Ge,u as de,ap as Ze,F as $t}from"./index.c6535512.js";import{u as zt,a as xe,Q as Bt}from"./QForm.866d1cbd.js";import{u as Ut,a as Qt}from"./use-dark.23b804b4.js";import{a as dt,i as Lt,h as Wt,u as Kt,b as Jt,d as Xt,c as Gt,e as Zt,f as et,l as ea}from"./layout.7b62d204.js";import{t as ta,_ as aa,a as tt,f as na,g as la,j as Ne}from"./date.75b33cd8.js";import{q as ie,t as oa,y as ia,Q as ra,D as ua,E as sa,F as da,a as ca}from"./format.e5167fe8.js";import{Q as va,c as fa}from"./QChip.b9af2c8a.js";import{Q as ma}from"./QSpace.52176573.js";import{R as ha,u as ga,a as ya,F as _a}from"./FilePreview.fb9ab4ef.js";import{c as at}from"./index.7adaf3a2.js";const ba={},pa={class:"q-my-xs q-pt-sm q-ml-md tw-text-2xl tw-font-bold tw-text-slate-700"};function xa(t,c){return we(),jt(kt,null,{default:R(()=>[$("h5",pa,[Je(t.$slots,"title")]),Je(t.$slots,"body")]),_:3})}var ln=St(ba,[["render",xa]]);function qa(){const t=new Map;return{getCache:function(c,b){return t[c]===void 0?t[c]=b:t[c]},getCacheWithFn:function(c,b){return t[c]===void 0?t[c]=b():t[c]}}}const wa=["gregorian","persian"],Fa={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:t=>wa.includes(t),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},Ca=["update:modelValue"];function Z(t){return t.year+"/"+ie(t.month)+"/"+ie(t.day)}function Da(t,c){const b=s(()=>t.disable!==!0&&t.readonly!==!0),C=s(()=>t.editable===!0?0:-1),g=s(()=>{const v=[];return t.color!==void 0&&v.push(`bg-${t.color}`),t.textColor!==void 0&&v.push(`text-${t.textColor}`),v.join(" ")});function F(){return t.locale!==void 0?{...c.lang.date,...t.locale}:c.lang.date}function w(v){const N=new Date,E=v===!0?null:0;if(t.calendar==="persian"){const H=ta(N);return{year:H.jy,month:H.jm,day:H.jd}}return{year:N.getFullYear(),month:N.getMonth()+1,day:N.getDate(),hour:E,minute:E,second:E,millisecond:E}}return{editable:b,tabindex:C,headerClass:g,getLocale:F,getCurrentDate:w}}const le=20,Va=["Calendar","Years","Months"],nt=t=>Va.includes(t),Ee=t=>/^-?[\d]+\/[0-1]\d$/.test(t),ce=" \u2014 ";function ee(t){return t.year+"/"+ie(t.month)}var lt=Ae({name:"QDate",props:{...Fa,...dt,...Ut,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Ee},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Ee},navigationMaxYearMonth:{type:String,validator:Ee},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:nt}},emits:[...Ca,"rangeStart","rangeEnd","navigation"],setup(t,{slots:c,emit:b}){const{proxy:C}=Fe(),{$q:g}=C,F=Qt(t,g),{getCache:w}=qa(),{tabindex:v,headerClass:N,getLocale:E,getCurrentDate:H}=Da(t,g);let A;const W=Lt(t),J=Wt(W),Q=j(null),f=j(ze()),p=j(E()),X=s(()=>ze()),m=s(()=>E()),D=s(()=>H()),o=j(Be(f.value,p.value)),_=j(t.defaultView),d=g.lang.rtl===!0?"right":"left",O=j(d.value),z=j(d.value),q=o.value.year,M=j(q-q%le-(q<0?le:0)),Y=j(null),ye=s(()=>{const e=t.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${t.minimal===!0?"minimal":"standard"}`+(F.value===!0?" q-date--dark q-dark":"")+(t.bordered===!0?" q-date--bordered":"")+(t.square===!0?" q-date--square no-border-radius":"")+(t.flat===!0?" q-date--flat no-shadow":"")+(t.disable===!0?" disabled":t.readonly===!0?" q-date--readonly":"")}),K=s(()=>t.color||"primary"),L=s(()=>t.textColor||"white"),re=s(()=>t.emitImmediately===!0&&t.multiple!==!0&&t.range!==!0),fe=s(()=>Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue!==null&&t.modelValue!==void 0?[t.modelValue]:[]),h=s(()=>fe.value.filter(e=>typeof e=="string").map(e=>Ve(e,f.value,p.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),S=s(()=>{const e=a=>Ve(a,f.value,p.value);return fe.value.filter(a=>Yt(a)===!0&&a.from!==void 0&&a.to!==void 0).map(a=>({from:e(a.from),to:e(a.to)})).filter(a=>a.from.dateHash!==null&&a.to.dateHash!==null&&a.from.dateHash<a.to.dateHash)}),I=s(()=>t.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const a=tt(e.year,e.month,e.day);return new Date(a.gy,a.gm-1,a.gd)}),te=s(()=>t.calendar==="persian"?Z:(e,a,n)=>na(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),a===void 0?f.value:a,n===void 0?p.value:n,e.year,e.timezoneOffset)),ae=s(()=>h.value.length+S.value.reduce((e,a)=>e+1+la(I.value(a.to),I.value(a.from)),0)),Oe=s(()=>{if(t.title!==void 0&&t.title!==null&&t.title.length>0)return t.title;if(Y.value!==null){const n=Y.value.init,i=I.value(n);return p.value.daysShort[i.getDay()]+", "+p.value.monthsShort[n.month-1]+" "+n.day+ce+"?"}if(ae.value===0)return ce;if(ae.value>1)return`${ae.value} ${p.value.pluralDay}`;const e=h.value[0],a=I.value(e);return isNaN(a.valueOf())===!0?ce:p.value.headerTitle!==void 0?p.value.headerTitle(a,e):p.value.daysShort[a.getDay()]+", "+p.value.monthsShort[e.month-1]+" "+e.day}),ct=s(()=>h.value.concat(S.value.map(a=>a.from)).sort((a,n)=>a.year-n.year||a.month-n.month)[0]),vt=s(()=>h.value.concat(S.value.map(a=>a.to)).sort((a,n)=>n.year-a.year||n.month-a.month)[0]),Ie=s(()=>{if(t.subtitle!==void 0&&t.subtitle!==null&&t.subtitle.length>0)return t.subtitle;if(ae.value===0)return ce;if(ae.value>1){const e=ct.value,a=vt.value,n=p.value.monthsShort;return n[e.month-1]+(e.year!==a.year?" "+e.year+ce+n[a.month-1]+" ":e.month!==a.month?ce+n[a.month-1]:"")+" "+a.year}return h.value[0].year}),_e=s(()=>{const e=[g.iconSet.datetime.arrowLeft,g.iconSet.datetime.arrowRight];return g.lang.rtl===!0?e.reverse():e}),Pe=s(()=>t.firstDayOfWeek!==void 0?Number(t.firstDayOfWeek):p.value.firstDayOfWeek),ft=s(()=>{const e=p.value.daysShort,a=Pe.value;return a>0?e.slice(a,7).concat(e.slice(0,a)):e}),G=s(()=>{const e=o.value;return t.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Ne(e.year,e.month)}),mt=s(()=>typeof t.eventColor=="function"?t.eventColor:()=>t.eventColor),P=s(()=>{if(t.navigationMinYearMonth===void 0)return null;const e=t.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),T=s(()=>{if(t.navigationMaxYearMonth===void 0)return null;const e=t.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),Ce=s(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return P.value!==null&&P.value.year>=o.value.year&&(e.year.prev=!1,P.value.year===o.value.year&&P.value.month>=o.value.month&&(e.month.prev=!1)),T.value!==null&&T.value.year<=o.value.year&&(e.year.next=!1,T.value.year===o.value.year&&T.value.month<=o.value.month&&(e.month.next=!1)),e}),be=s(()=>{const e={};return h.value.forEach(a=>{const n=ee(a);e[n]===void 0&&(e[n]=[]),e[n].push(a.day)}),e}),Te=s(()=>{const e={};return S.value.forEach(a=>{const n=ee(a.from),i=ee(a.to);if(e[n]===void 0&&(e[n]=[]),e[n].push({from:a.from.day,to:n===i?a.to.day:void 0,range:a}),n<i){let l;const{year:x,month:r}=a.from,y=r<12?{year:x,month:r+1}:{year:x+1,month:1};for(;(l=ee(y))<=i;)e[l]===void 0&&(e[l]=[]),e[l].push({from:void 0,to:l===i?a.to.day:void 0,range:a}),y.month++,y.month>12&&(y.year++,y.month=1)}}),e}),me=s(()=>{if(Y.value===null)return;const{init:e,initHash:a,final:n,finalHash:i}=Y.value,[l,x]=a<=i?[e,n]:[n,e],r=ee(l),y=ee(x);if(r!==B.value&&y!==B.value)return;const V={};return r===B.value?(V.from=l.day,V.includeFrom=!0):V.from=1,y===B.value?(V.to=x.day,V.includeTo=!0):V.to=G.value,V}),B=s(()=>ee(o.value)),ht=s(()=>{const e={};if(t.options===void 0){for(let n=1;n<=G.value;n++)e[n]=!0;return e}const a=typeof t.options=="function"?t.options:n=>t.options.includes(n);for(let n=1;n<=G.value;n++){const i=B.value+"/"+ie(n);e[n]=a(i)}return e}),gt=s(()=>{const e={};if(t.events===void 0)for(let a=1;a<=G.value;a++)e[a]=!1;else{const a=typeof t.events=="function"?t.events:n=>t.events.includes(n);for(let n=1;n<=G.value;n++){const i=B.value+"/"+ie(n);e[n]=a(i)===!0&&mt.value(i)}}return e}),yt=s(()=>{let e,a;const{year:n,month:i}=o.value;if(t.calendar!=="persian")e=new Date(n,i-1,1),a=new Date(n,i-1,0).getDate();else{const l=tt(n,i,1);e=new Date(l.gy,l.gm-1,l.gd);let x=i-1,r=n;x===0&&(x=12,r--),a=Ne(r,x)}return{days:e.getDay()-Pe.value-1,endDay:a}}),Re=s(()=>{const e=[],{days:a,endDay:n}=yt.value,i=a<0?a+7:a;if(i<6)for(let r=n-i;r<=n;r++)e.push({i:r,fill:!0});const l=e.length;for(let r=1;r<=G.value;r++){const y={i:r,event:gt.value[r],classes:[]};ht.value[r]===!0&&(y.in=!0,y.flat=!0),e.push(y)}if(be.value[B.value]!==void 0&&be.value[B.value].forEach(r=>{const y=l+r-1;Object.assign(e[y],{selected:!0,unelevated:!0,flat:!1,color:K.value,textColor:L.value})}),Te.value[B.value]!==void 0&&Te.value[B.value].forEach(r=>{if(r.from!==void 0){const y=l+r.from-1,V=l+(r.to||G.value)-1;for(let He=y;He<=V;He++)Object.assign(e[He],{range:r.range,unelevated:!0,color:K.value,textColor:L.value});Object.assign(e[y],{rangeFrom:!0,flat:!1}),r.to!==void 0&&Object.assign(e[V],{rangeTo:!0,flat:!1})}else if(r.to!==void 0){const y=l+r.to-1;for(let V=l;V<=y;V++)Object.assign(e[V],{range:r.range,unelevated:!0,color:K.value,textColor:L.value});Object.assign(e[y],{flat:!1,rangeTo:!0})}else{const y=l+G.value-1;for(let V=l;V<=y;V++)Object.assign(e[V],{range:r.range,unelevated:!0,color:K.value,textColor:L.value})}}),me.value!==void 0){const r=l+me.value.from-1,y=l+me.value.to-1;for(let V=r;V<=y;V++)e[V].color=K.value,e[V].editRange=!0;me.value.includeFrom===!0&&(e[r].editRangeFrom=!0),me.value.includeTo===!0&&(e[y].editRangeTo=!0)}o.value.year===D.value.year&&o.value.month===D.value.month&&(e[l+D.value.day-1].today=!0);const x=e.length%7;if(x>0){const r=7-x;for(let y=1;y<=r;y++)e.push({i:y,fill:!0})}return e.forEach(r=>{let y="q-date__calendar-item ";r.fill===!0?y+="q-date__calendar-item--fill":(y+=`q-date__calendar-item--${r.in===!0?"in":"out"}`,r.range!==void 0&&(y+=` q-date__range${r.rangeTo===!0?"-to":r.rangeFrom===!0?"-from":""}`),r.editRange===!0&&(y+=` q-date__edit-range${r.editRangeFrom===!0?"-from":""}${r.editRangeTo===!0?"-to":""}`),(r.range!==void 0||r.editRange===!0)&&(y+=` text-${r.color}`)),r.classes=y}),e}),_t=s(()=>t.disable===!0?{"aria-disabled":"true"}:t.readonly===!0?{"aria-readonly":"true"}:{});oe(()=>t.modelValue,e=>{if(A===e)A=0;else{const{year:a,month:n}=Be(f.value,p.value);ue(a,n)}}),oe(_,()=>{Q.value!==null&&C.$el.contains(document.activeElement)===!0&&Q.value.focus()}),oe(()=>o.value.year,e=>{b("navigation",{year:e,month:o.value.month})}),oe(()=>o.value.month,e=>{b("navigation",{year:o.value.year,month:e})}),oe(X,e=>{Ke(e,p.value,"mask"),f.value=e}),oe(m,e=>{Ke(f.value,e,"locale"),p.value=e});function $e(){const e=D.value,a=be.value[ee(e)];(a===void 0||a.includes(e.day)===!1)&&ke(e),De(e.year,e.month)}function bt(e){nt(e)===!0&&(_.value=e)}function pt(e,a){["month","year"].includes(e)&&(e==="month"?Qe:Me)(a===!0?-1:1)}function De(e,a){_.value="Calendar",ue(e,a)}function xt(e,a){if(t.range===!1||!e){Y.value=null;return}const n=Object.assign({...o.value},e),i=a!==void 0?Object.assign({...o.value},a):n;Y.value={init:n,initHash:Z(n),final:i,finalHash:Z(i)},De(n.year,n.month)}function ze(){return t.calendar==="persian"?"YYYY/MM/DD":t.mask}function Ve(e,a,n){return aa(e,a,n,t.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Be(e,a){const n=Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue?[t.modelValue]:[];if(n.length===0)return Ue();const i=n[n.length-1],l=Ve(i.from!==void 0?i.from:i,e,a);return l.dateHash===null?Ue():l}function Ue(){let e,a;if(t.defaultYearMonth!==void 0){const n=t.defaultYearMonth.split("/");e=parseInt(n[0],10),a=parseInt(n[1],10)}else{const n=D.value!==void 0?D.value:H();e=n.year,a=n.month}return{year:e,month:a,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+ie(a)+"/01"}}function Qe(e){let a=o.value.year,n=Number(o.value.month)+e;n===13?(n=1,a++):n===0&&(n=12,a--),ue(a,n),re.value===!0&&pe("month")}function Me(e){const a=Number(o.value.year)+e;ue(a,o.value.month),re.value===!0&&pe("year")}function qt(e){ue(e,o.value.month),_.value=t.defaultView==="Years"?"Months":"Calendar",re.value===!0&&pe("year")}function wt(e){ue(o.value.year,e),_.value="Calendar",re.value===!0&&pe("month")}function Ft(e,a){const n=be.value[a];(n!==void 0&&n.includes(e.day)===!0?Se:ke)(e)}function ne(e){return{year:e.year,month:e.month,day:e.day}}function ue(e,a){P.value!==null&&e<=P.value.year&&(e=P.value.year,a<P.value.month&&(a=P.value.month)),T.value!==null&&e>=T.value.year&&(e=T.value.year,a>T.value.month&&(a=T.value.month));const n=e+"/"+ie(a)+"/01";n!==o.value.dateHash&&(O.value=o.value.dateHash<n==(g.lang.rtl!==!0)?"left":"right",e!==o.value.year&&(z.value=O.value),Xe(()=>{M.value=e-e%le-(e<0?le:0),Object.assign(o.value,{year:e,month:a,day:1,dateHash:n})}))}function Le(e,a,n){const i=e!==null&&e.length===1&&t.multiple===!1?e[0]:e;A=i;const{reason:l,details:x}=We(a,n);b("update:modelValue",i,l,x)}function pe(e){const a=h.value[0]!==void 0&&h.value[0].dateHash!==null?{...h.value[0]}:{...o.value};Xe(()=>{a.year=o.value.year,a.month=o.value.month;const n=t.calendar!=="persian"?new Date(a.year,a.month,0).getDate():Ne(a.year,a.month);a.day=Math.min(Math.max(1,a.day),n);const i=se(a);A=i;const{details:l}=We("",a);b("update:modelValue",i,e,l)})}function We(e,a){return a.from!==void 0?{reason:`${e}-range`,details:{...ne(a.target),from:ne(a.from),to:ne(a.to)}}:{reason:`${e}-day`,details:ne(a)}}function se(e,a,n){return e.from!==void 0?{from:te.value(e.from,a,n),to:te.value(e.to,a,n)}:te.value(e,a,n)}function ke(e){let a;if(t.multiple===!0)if(e.from!==void 0){const n=Z(e.from),i=Z(e.to),l=h.value.filter(r=>r.dateHash<n||r.dateHash>i),x=S.value.filter(({from:r,to:y})=>y.dateHash<n||r.dateHash>i);a=l.concat(x).concat(e).map(r=>se(r))}else{const n=fe.value.slice();n.push(se(e)),a=n}else a=se(e);Le(a,"add",e)}function Se(e){if(t.noUnset===!0)return;let a=null;if(t.multiple===!0&&Array.isArray(t.modelValue)===!0){const n=se(e);e.from!==void 0?a=t.modelValue.filter(i=>i.from!==void 0?i.from!==n.from&&i.to!==n.to:!0):a=t.modelValue.filter(i=>i!==n),a.length===0&&(a=null)}Le(a,"remove",e)}function Ke(e,a,n){const i=h.value.concat(S.value).map(l=>se(l,e,a)).filter(l=>l.from!==void 0?l.from.dateHash!==null&&l.to.dateHash!==null:l.dateHash!==null);b("update:modelValue",(t.multiple===!0?i:i[0])||null,n)}function Ct(){if(t.minimal!==!0)return u("div",{class:"q-date__header "+N.value},[u("div",{class:"relative-position"},[u(he,{name:"q-transition--fade"},()=>u("div",{key:"h-yr-"+Ie.value,class:"q-date__header-subtitle q-date__header-link "+(_.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:v.value,...w("vY",{onClick(){_.value="Years"},onKeyup(e){e.keyCode===13&&(_.value="Years")}})},[Ie.value]))]),u("div",{class:"q-date__header-title relative-position flex no-wrap"},[u("div",{class:"relative-position col"},[u(he,{name:"q-transition--fade"},()=>u("div",{key:"h-sub"+Oe.value,class:"q-date__header-title-label q-date__header-link "+(_.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:v.value,...w("vC",{onClick(){_.value="Calendar"},onKeyup(e){e.keyCode===13&&(_.value="Calendar")}})},[Oe.value]))]),t.todayBtn===!0?u(U,{class:"q-date__header-today self-start",icon:g.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:v.value,onClick:$e}):null])])}function je({label:e,type:a,key:n,dir:i,goTo:l,boundaries:x,cls:r}){return[u("div",{class:"row items-center q-date__arrow"},[u(U,{round:!0,dense:!0,size:"sm",flat:!0,icon:_e.value[0],tabindex:v.value,disable:x.prev===!1,...w("go-#"+a,{onClick(){l(-1)}})})]),u("div",{class:"relative-position overflow-hidden flex flex-center"+r},[u(he,{name:"q-transition--jump-"+i},()=>u("div",{key:n},[u(U,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:v.value,...w("view#"+a,{onClick:()=>{_.value=a}})})]))]),u("div",{class:"row items-center q-date__arrow"},[u(U,{round:!0,dense:!0,size:"sm",flat:!0,icon:_e.value[1],tabindex:v.value,disable:x.next===!1,...w("go+#"+a,{onClick(){l(1)}})})])]}const Dt={Calendar:()=>[u("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[u("div",{class:"q-date__navigation row items-center no-wrap"},je({label:p.value.months[o.value.month-1],type:"Months",key:o.value.month,dir:O.value,goTo:Qe,boundaries:Ce.value.month,cls:" col"}).concat(je({label:o.value.year,type:"Years",key:o.value.year,dir:z.value,goTo:Me,boundaries:Ce.value.year,cls:""}))),u("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},ft.value.map(e=>u("div",{class:"q-date__calendar-item"},[u("div",e)]))),u("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[u(he,{name:"q-transition--slide-"+O.value},()=>u("div",{key:B.value,class:"q-date__calendar-days fit"},Re.value.map(e=>u("div",{class:e.classes},[e.in===!0?u(U,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:v.value,...w("day#"+e.i,{onClick:()=>{Vt(e.i)},onMouseover:()=>{Mt(e.i)}})},e.event!==!1?()=>u("div",{class:"q-date__event bg-"+e.event}):null):u("div",""+e.i)]))))])])],Months(){const e=o.value.year===D.value.year,a=i=>P.value!==null&&o.value.year===P.value.year&&P.value.month>i||T.value!==null&&o.value.year===T.value.year&&T.value.month<i,n=p.value.monthsShort.map((i,l)=>{const x=o.value.month===l+1;return u("div",{class:"q-date__months-item flex flex-center"},[u(U,{class:e===!0&&D.value.month===l+1?"q-date__today":null,flat:x!==!0,label:i,unelevated:x,color:x===!0?K.value:null,textColor:x===!0?L.value:null,tabindex:v.value,disable:a(l+1),...w("month#"+l,{onClick:()=>{wt(l+1)}})})])});return t.yearsInMonthView===!0&&n.unshift(u("div",{class:"row no-wrap full-width"},[je({label:o.value.year,type:"Years",key:o.value.year,dir:z.value,goTo:Me,boundaries:Ce.value.year,cls:" col"})])),u("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const e=M.value,a=e+le,n=[],i=l=>P.value!==null&&P.value.year>l||T.value!==null&&T.value.year<l;for(let l=e;l<=a;l++){const x=o.value.year===l;n.push(u("div",{class:"q-date__years-item flex flex-center"},[u(U,{key:"yr"+l,class:D.value.year===l?"q-date__today":null,flat:!x,label:l,dense:!0,unelevated:x,color:x===!0?K.value:null,textColor:x===!0?L.value:null,tabindex:v.value,disable:i(l),...w("yr#"+l,{onClick:()=>{qt(l)}})})]))}return u("div",{class:"q-date__view q-date__years flex flex-center"},[u("div",{class:"col-auto"},[u(U,{round:!0,dense:!0,flat:!0,icon:_e.value[0],tabindex:v.value,disable:i(e),...w("y-",{onClick:()=>{M.value-=le}})})]),u("div",{class:"q-date__years-content col self-stretch row items-center"},n),u("div",{class:"col-auto"},[u(U,{round:!0,dense:!0,flat:!0,icon:_e.value[1],tabindex:v.value,disable:i(a),...w("y+",{onClick:()=>{M.value+=le}})})])])}};function Vt(e){const a={...o.value,day:e};if(t.range===!1){Ft(a,B.value);return}if(Y.value===null){const n=Re.value.find(l=>l.fill!==!0&&l.i===e);if(t.noUnset!==!0&&n.range!==void 0){Se({target:a,from:n.range.from,to:n.range.to});return}if(n.selected===!0){Se(a);return}const i=Z(a);Y.value={init:a,initHash:i,final:a,finalHash:i},b("rangeStart",ne(a))}else{const n=Y.value.initHash,i=Z(a),l=n<=i?{from:Y.value.init,to:a}:{from:a,to:Y.value.init};Y.value=null,ke(n===i?a:{target:a,...l}),b("rangeEnd",{from:ne(l.from),to:ne(l.to)})}}function Mt(e){if(Y.value!==null){const a={...o.value,day:e};Object.assign(Y.value,{final:a,finalHash:Z(a)})}}return Object.assign(C,{setToday:$e,setView:bt,offsetCalendar:pt,setCalendarTo:De,setEditingRange:xt}),()=>{const e=[u("div",{class:"q-date__content col relative-position"},[u(he,{name:"q-transition--fade"},Dt[_.value])])],a=Ht(c.default);return a!==void 0&&e.push(u("div",{class:"q-date__actions"},a)),t.name!==void 0&&t.disable!==!0&&J(e,"push"),u("div",{class:ye.value,..._t.value},[Ct(),u("div",{ref:Q,class:"q-date__main col column",tabindex:-1},e)])}}}),ot=Ae({name:"QPopupProxy",props:{...oa,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(t,{slots:c,emit:b,attrs:C}){const{proxy:g}=Fe(),{$q:F}=g,w=j(!1),v=j(null),N=s(()=>parseInt(t.breakpoint,10)),{canShow:E}=ia({showing:w});function H(){return F.screen.width<N.value||F.screen.height<N.value?"dialog":"menu"}const A=j(H()),W=s(()=>A.value==="menu"?{maxHeight:"99vh"}:{});oe(()=>H(),f=>{w.value!==!0&&(A.value=f)});function J(f){w.value=!0,b("show",f)}function Q(f){w.value=!1,A.value=H(),b("hide",f)}return Object.assign(g,{show(f){E(f)===!0&&v.value.show(f)},hide(f){v.value.hide(f)},toggle(f){v.value.toggle(f)}}),ut(g,"currentComponent",()=>({type:A.value,ref:v.value})),()=>{const f={ref:v,...W.value,...C,onShow:J,onHide:Q};let p;return A.value==="dialog"?p=va:(p=ra,Object.assign(f,{target:t.target,contextMenu:t.contextMenu,noParentEvent:!0,separateClosePopup:!0})),u(p,f,c.default)}}});function ve(t,c,b,C){const g=[];return t.forEach(F=>{C(F)===!0?g.push(F):c.push({failedPropValidation:b,file:F})}),g}function qe(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),st(t)}const Ma={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ka=["rejected"];function Sa({editable:t,dnd:c,getFileInput:b,addFilesToQueue:C}){const{props:g,emit:F,proxy:w}=Fe(),v=j(null),N=s(()=>g.accept!==void 0?g.accept.split(",").map(m=>(m=m.trim(),m==="*"?"*/":(m.endsWith("/*")&&(m=m.slice(0,m.length-1)),m.toUpperCase()))):null),E=s(()=>parseInt(g.maxFiles,10)),H=s(()=>parseInt(g.maxTotalSize,10));function A(m){if(t.value)if(m!==Object(m)&&(m={target:null}),m.target!==null&&m.target.matches('input[type="file"]')===!0)m.clientX===0&&m.clientY===0&&Nt(m);else{const D=b();D&&D!==m.target&&D.click(m)}}function W(m){t.value&&m&&C(null,m)}function J(m,D,o,_){let d=Array.from(D||m.target.files);const O=[],z=()=>{O.length>0&&F("rejected",O)};if(g.accept!==void 0&&N.value.indexOf("*/")===-1&&(d=ve(d,O,"accept",q=>N.value.some(M=>q.type.toUpperCase().startsWith(M)||q.name.toUpperCase().endsWith(M))),d.length===0))return z();if(g.maxFileSize!==void 0){const q=parseInt(g.maxFileSize,10);if(d=ve(d,O,"max-file-size",M=>M.size<=q),d.length===0)return z()}if(g.multiple!==!0&&d.length>0&&(d=[d[0]]),d.forEach(q=>{q.__key=q.webkitRelativePath+q.lastModified+q.name+q.size}),_===!0){const q=o.map(M=>M.__key);d=ve(d,O,"duplicate",M=>q.includes(M.__key)===!1)}if(d.length===0)return z();if(g.maxTotalSize!==void 0){let q=_===!0?o.reduce((M,Y)=>M+Y.size,0):0;if(d=ve(d,O,"max-total-size",M=>(q+=M.size,q<=H.value)),d.length===0)return z()}if(typeof g.filter=="function"){const q=g.filter(d);d=ve(d,O,"filter",M=>q.includes(M))}if(g.maxFiles!==void 0){let q=_===!0?o.length:0;if(d=ve(d,O,"max-files",()=>(q++,q<=E.value)),d.length===0)return z()}if(z(),d.length>0)return d}function Q(m){qe(m),c.value!==!0&&(c.value=!0)}function f(m){st(m),(m.relatedTarget!==null||Et.is.safari!==!0?m.relatedTarget!==v.value:document.elementsFromPoint(m.clientX,m.clientY).includes(v.value)===!1)===!0&&(c.value=!1)}function p(m){qe(m);const D=m.dataTransfer.files;D.length>0&&C(null,D),c.value=!1}function X(m){if(c.value===!0)return u("div",{ref:v,class:`q-${m}__dnd absolute-full`,onDragenter:qe,onDragover:qe,onDragleave:f,onDrop:p})}return Object.assign(w,{pickFiles:A,addFiles:W}),{pickFiles:A,addFiles:W,onDragover:Q,onDragleave:f,processFiles:J,getDndNode:X,maxFilesNumber:E,maxTotalSizeNumber:H}}var ja=Ae({name:"QFile",inheritAttrs:!1,props:{...Kt,...dt,...Ma,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Jt,...ka],setup(t,{slots:c,emit:b,attrs:C}){const{proxy:g}=Fe(),F=Xt(),w=j(null),v=j(!1),N=Gt(t),{pickFiles:E,onDragover:H,onDragleave:A,processFiles:W,getDndNode:J}=Sa({editable:F.editable,dnd:v,getFileInput:ye,addFilesToQueue:K}),Q=zt(t),f=s(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),p=s(()=>et(f.value)),X=s(()=>f.value.map(h=>h.name).join(", ")),m=s(()=>ua(f.value.reduce((h,S)=>h+S.size,0))),D=s(()=>({totalSize:m.value,filesNumber:f.value.length,maxFiles:t.maxFiles})),o=s(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:N.value,...C,id:F.targetUid.value,disabled:F.editable.value!==!0})),_=s(()=>"q-file q-field--auto-height"+(v.value===!0?" q-file--dnd":"")),d=s(()=>t.multiple===!0&&t.append===!0);function O(h){const S=f.value.slice();S.splice(h,1),q(S)}function z(h){const S=f.value.findIndex(h);S>-1&&O(S)}function q(h){b("update:modelValue",t.multiple===!0?h:h[0])}function M(h){h.keyCode===13&&At(h)}function Y(h){(h.keyCode===13||h.keyCode===32)&&E(h)}function ye(){return w.value}function K(h,S){const I=W(h,S,f.value,d.value),te=ye();te!=null&&(te.value=""),I!==void 0&&((t.multiple===!0?t.modelValue&&I.every(ae=>f.value.includes(ae)):t.modelValue===I[0])||q(d.value===!0?f.value.concat(I):I))}function L(){return[u("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function re(){if(c.file!==void 0)return f.value.length===0?L():f.value.map((S,I)=>c.file({index:I,file:S,ref:this}));if(c.selected!==void 0)return f.value.length===0?L():c.selected({files:f.value,ref:this});if(t.useChips===!0)return f.value.length===0?L():f.value.map((S,I)=>u(fa,{key:"file-"+I,removable:F.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{O(I)}},()=>u("span",{class:"ellipsis",textContent:S.name})));const h=t.displayValue!==void 0?t.displayValue:X.value;return h.length>0?[u("div",{class:t.inputClass,style:t.inputStyle,textContent:h})]:L()}function fe(){const h={ref:w,...o.value,...Q.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:K};return t.multiple===!0&&(h.multiple=!0),u("input",h)}return Object.assign(F,{fieldClass:_,emitValue:q,hasValue:p,inputRef:w,innerValue:f,floatingLabel:s(()=>p.value===!0||et(t.displayValue)),computedCounter:s(()=>{if(t.counterLabel!==void 0)return t.counterLabel(D.value);const h=t.maxFiles;return`${f.value.length}${h!==void 0?" / "+h:""} (${m.value})`}),getControlChild:()=>J("file"),getControl:()=>{const h={ref:F.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return F.editable.value===!0&&Object.assign(h,{onDragover:H,onDragleave:A,onKeydown:M,onKeyup:Y}),u("div",h,[fe()].concat(re()))}}),Object.assign(g,{removeAtIndex:O,removeFile:z,getNativeElement:()=>w.value}),ut(g,"nativeEl",()=>w.value),Zt(F)}});function it(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const c=parseInt(t,10);return isNaN(c)?0:c}var rt=Ot({name:"close-popup",beforeMount(t,{value:c}){const b={depth:it(c),handler(C){b.depth!==0&&setTimeout(()=>{const g=sa(t);g!==void 0&&da(g,C,b.depth)})},handlerKey(C){It(C,13)===!0&&b.handler(C)}};t.__qclosepopup=b,t.addEventListener("click",b.handler),t.addEventListener("keyup",b.handlerKey)},updated(t,{value:c,oldValue:b}){c!==b&&(t.__qclosepopup.depth=it(c))},beforeUnmount(t){const c=t.__qclosepopup;t.removeEventListener("click",c.handler),t.removeEventListener("keyup",c.handlerKey),delete t.__qclosepopup}});const Ha=()=>{const t=j(),c=j(!1);return{isLoading:c,requisitionFile:t,uploadRequisitionFile:async C=>{const g=new FormData;g.append("file",t.value),c.value=!0;const{data:F}=await ha.uploadFile(C,g);return c.value=!1,ea.showSuccessNotification("Archivo subido con \xE9xito"),t.value=void 0,F.file_name}}},Ya={class:"row q-gutter-md"},Na={class:"col"},Ea={class:"row q-gutter-md"},Aa={class:"col"},Oa={class:"row q-gutter-md"},Ia={class:"col"},Pa={class:"row items-center justify-end"},Ta={class:"col"},Ra={class:"row items-center justify-end"},$a={key:0,class:"row q-gutter-md"},za={class:"col"},Ba={key:0,class:"col"},Ua={class:"row q-mt-md"},on=Pt({__name:"RequisitionForm",props:{requisition:{default:()=>({requisition_number:"",preparation_date:"",processing_date:"",estimated_amount:0})}},setup(t){const c=t,b="https://nestjs-boilerplate-production.up.railway.app",{uploadRequisitionFile:C,requisitionFile:g,isLoading:F}=Ha(),w={requisition_number:"",preparation_date:"",processing_date:"",estimated_amount:0},v=Tt(at(c.requisition)||at(w)),N=j(),{requisitionStoreMutations:E}=ga(),{requisitionUpdateMutations:H}=ya(),{isLoading:A,data:W}=E,{isLoading:J}=H,Q=Rt(),f={requisition_number:[o=>!!o||"El n\xFAmero de requisici\xF3n es requerido",o=>o.length==3||"El n\xFAmero de requisici\xF3n debe tener 3 d\xEDgitos",o=>!isNaN(Number(o))||"El n\xFAmero de requisici\xF3n debe ser un n\xFAmero"],estimated_amount:[o=>!!o||"El monto estimado es requerido",o=>!isNaN(Number(o))||"El monto estimado debe ser un n\xFAmero"]},p=j(),X=s(()=>!!c.requisition.id);async function m(){var _,d;!await((_=N.value)==null?void 0:_.validate())||(X.value?await H.mutateAsync(v):(await E.mutateAsync(v),await Q.push({name:"requisitions.edit",params:{id:(d=W.value)==null?void 0:d.id}})))}async function D(o){g.value=o,v.file=await C(c.requisition.id),p.value=void 0}return(o,_)=>(we(),Ye($t,null,[k(de(Bt),{ref_key:"qRequisitionForm",ref:N,class:"q-pb-md"},{default:R(()=>[$("div",Ya,[$("div",Na,[k(xe,{modelValue:v.requisition_number,"onUpdate:modelValue":_[0]||(_[0]=d=>v.requisition_number=d),counter:"",dense:"",label:"N\xFAmero de requisici\xF3n",maxlength:"3",outlined:"",rules:f.requisition_number},{prepend:R(()=>[k(ge,{name:"tag"})]),_:1},8,["modelValue","rules"])])]),$("div",Ea,[$("div",Aa,[k(xe,{modelValue:v.estimated_amount,"onUpdate:modelValue":_[1]||(_[1]=d=>v.estimated_amount=d),modelModifiers:{number:!0},dense:"","input-class":"tw-text-right",label:"Monto estimado",outlined:"",rules:f.estimated_amount,type:"number"},{prepend:R(()=>[k(ge,{name:"attach_money"})]),_:1},8,["modelValue","rules"])])]),$("div",Oa,[$("div",Ia,[k(xe,{modelValue:v.preparation_date,"onUpdate:modelValue":_[3]||(_[3]=d=>v.preparation_date=d),dense:"",label:"Fecha de elaboraci\xF3n",outlined:"",rules:[d=>!!d||"La fecha de elaboraci\xF3n es requerida"]},{append:R(()=>[k(ge,{class:"cursor-pointer",name:"event"},{default:R(()=>[k(ot,{cover:"","transition-hide":"scale","transition-show":"scale"},{default:R(()=>[k(lt,{modelValue:v.preparation_date,"onUpdate:modelValue":_[2]||(_[2]=d=>v.preparation_date=d),mask:"YYYY-MM-DD"},{default:R(()=>[$("div",Pa,[Ge(k(U,{color:"primary",flat:"",label:"Close"},null,512),[[rt]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),$("div",Ta,[k(xe,{modelValue:v.processing_date,"onUpdate:modelValue":_[5]||(_[5]=d=>v.processing_date=d),dense:"",label:"Fecha de tr\xE1mite",outlined:"",rules:[d=>!!d||"La fecha de tr\xE1mite es requerida"]},{append:R(()=>[k(ge,{class:"cursor-pointer",name:"event"},{default:R(()=>[k(ot,{cover:"","transition-hide":"scale","transition-show":"scale"},{default:R(()=>[k(lt,{modelValue:v.processing_date,"onUpdate:modelValue":_[4]||(_[4]=d=>v.processing_date=d),mask:"YYYY-MM-DD"},{default:R(()=>[$("div",Ra,[Ge(k(U,{color:"primary",flat:"",label:"Close"},null,512),[[rt]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])])]),de(X)?(we(),Ye("div",$a,[$("div",za,[k(ja,{modelValue:p.value,"onUpdate:modelValue":[_[6]||(_[6]=d=>p.value=d),D],accept:".jpg, image/*, application/pdf",dense:"",label:"Haga click para subir el archivo o arrastralo aqu\xED",loading:de(F),outlined:""},{prepend:R(()=>[k(ge,{name:"attach_file"})]),_:1},8,["modelValue","loading"])]),v.file?(we(),Ye("div",Ba,[k(_a,{"file-url":`${de(b)}/api/files/requisitions/${c.requisition.id}/${v.file}`},null,8,["file-url"])])):Ze("",!0)])):Ze("",!0)]),_:1},512),k(ca),$("div",Ua,[k(ma),$("div",null,[k(U,{color:"primary",label:"Guardar",loading:de(A)||de(J),onClick:m},null,8,["loading"])])])],64))}});export{ln as C,on as _};
