import{j as F,N as g,r as x,c as Q,p as E,k as V,l as o,d as t,u,Z as y,aH as h,a6 as k,s as U}from"./index.404f6180.js";import{l as A,Q as M,a as C}from"./layout.eb1e0f2e.js";import{C as I,Q as L}from"./CardForm.95c686e3.js";import{u as T,a as q,b as S,c as B,T as z,Q as K,d as $}from"./QCardActions.4c2ff797.js";import{a as D,b as H,c as P}from"./format.e886d86d.js";import{A as _}from"./ActionResource.38ddfcc1.js";import"./use-dark.ed1c6acc.js";import"./focus-manager.33224ae2.js";import"./index.2cf0d985.js";import"./QCard.f0638023.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./scroll.75c71c19.js";import"./QPage.63d049a8.js";import"./utils.esm.dcf38a17.js";const j=async()=>{const{data:a}=await _.getActions();return a},G=async a=>{const{data:e}=await _.storeAction(a);return e},R=async a=>{const{id:e,name:i}=a,{data:r}=await _.updateAction(e,{name:i});return r},Z=()=>{const{isLoading:a,isError:e,data:i,error:r}=T({queryKey:["actions"],queryFn:j,staleTime:6e5});return{isLoading:a,isError:e,data:i,error:r}},J=()=>{const a=q();return{actionStoreMutations:S({mutationFn:G,onSuccess:()=>{a.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n creada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al crear acci\xF3n")}})}},O=()=>{const a=q();return{actionUpdateMutations:S({mutationFn:R,onSuccess:()=>{a.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n actualizada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al actualizar acci\xF3n")}})}},W=F({__name:"ActionForm",props:{action:null},setup(a){const e=a,{actionStoreMutations:i}=J(),{isLoading:r}=i,{actionUpdateMutations:s}=O(),{isLoading:m}=s,b=g({name:""}),l=g(B(e.action||b)),d=x(),c={name:[v=>!!v||"El nombre es requerido"]},n=Q(()=>e.action&&"id"in e.action),w=Q(()=>n.value?"Editar acci\xF3n":"Agregar acci\xF3n");async function N(){var p,f;!await((p=d.value)==null?void 0:p.validate())||(n.value?await s.mutateAsync(l):(await i.mutateAsync(l),l.name="",(f=d.value)==null||f.reset()))}return(v,p)=>(E(),V(I,{title:u(w)},{form:o(()=>[t(u(M),{ref_key:"actionForm",ref:d,class:"q-gutter-md"},{default:o(()=>[t(D,null,{default:o(()=>[t(H,null,{default:o(()=>[t(P,null,{default:o(()=>[t(C,{modelValue:l.name,"onUpdate:modelValue":p[0]||(p[0]=f=>l.name=f),dense:"",label:"Nombre",outlined:"",rules:c.name},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),actions:o(()=>[t(y,{color:"primary",label:"Guardar",loading:u(r)||u(m),onClick:N},null,8,["loading"])]),_:1},8,["title"]))}}),X={class:"q-gutter-sm"},pt=F({__name:"IndexPage",setup(a){const{data:e,isLoading:i}=Z(),r=x(""),s=x(!1);let m=g({name:""});const b=[{name:"id",field:"id",required:!0,label:"ID",sortable:!0,align:"left"},{name:"name",field:"name",label:"Nombre",sortable:!0,align:"left"},{name:"action",align:"center",label:"Acciones",field:"action",sortable:!1}];h(()=>{s.value||(m=g({name:""}))});function l(d){s.value=!0,m=d}return(d,c)=>(E(),V(z,null,{"card-body":o(()=>[t(K,{columns:b,loading:u(i),rows:u(e),"rows-per-page-options":[20,30,40,50],title:"Acciones"},{"top-right":o(()=>[t(y,{class:"q-mr-xs",color:"primary",icon:"add",label:"Nueva Acci\xF3n",outline:"",onClick:c[0]||(c[0]=n=>s.value=!0)}),t(C,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=n=>r.value=n),class:"q-mr-xs",debounce:"300",dense:"",outlined:"",placeholder:"Search"},{append:o(()=>[t(k,{name:"search"})]),_:1},8,["modelValue"]),t(y,{color:"primary","icon-right":"archive",label:"Exportar CSV","no-caps":""})]),"body-cell-action":o(n=>[t(L,{props:n},{default:o(()=>[U("div",X,[t(y,{color:"primary",dense:"",flat:"",icon:"edit",rounded:"",size:"sm",onClick:w=>l(n.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["loading","rows"])]),footer:o(()=>[t($,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=n=>s.value=n)},{default:o(()=>[t(W,{action:u(m)},null,8,["action"])]),_:1},8,["modelValue"])]),_:1}))}});export{pt as default};
