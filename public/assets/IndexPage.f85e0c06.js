import{Q as T}from"./QInput.5a757dc1.js";import{Q as p,a as b}from"./QItem.3abe05b4.js";import{Q as l,a as Y}from"./QTable.14f30bfe.js";import{Q as U}from"./QSelect.52923b78.js";import{Q as E}from"./QPopupEdit.90624894.js";import{j as M,S as A,r as c,k as g,l as t,p as _,d as a,q as n,t as r,u as s,ah as N,X as $}from"./index.a852c7dd.js";import{Q as j}from"./QTr.f1adea96.js";import{e as G,f as L,g as X}from"./useSubBudgets.6bf8767b.js";import{T as z}from"./TablePage.adfa3862.js";import{d as H}from"./date.b0104a9d.js";import{F as J}from"./FilePreview.1dd00e8a.js";import{u as K}from"./useMoney.dbc60660.js";import{_ as O}from"./DeleteCardDialog.537111ac.js";import{u as W}from"./BudgetResource.e21a87b9.js";import"./use-key-composition.0193e5f8.js";import"./use-dark.84119dd2.js";import"./focus-manager.387b0375.js";import"./QMenu.1dc72ab8.js";import"./scroll.1d333f42.js";import"./QList.3193c694.js";import"./QCheckbox.ecd43410.js";import"./format.d73ecc87.js";import"./QItemLabel.aabbfeaa.js";import"./layout.1849cf49.js";import"./useQuery.esm.6e7da3a0.js";import"./utils.esm.3b6b5005.js";import"./useMutation.esm.e5230e92.js";import"./mutation.esm.b0df21c1.js";import"./QCard.1e7bb02d.js";import"./QPage.ea4e39d9.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QTooltip.1169fa0c.js";import"./QCardSection.1618d2d3.js";import"./QImg.3db4217f.js";import"./QSpace.c017440e.js";import"./QBanner.5f3597ee.js";import"./MyCardTitle.440134c5.js";import"./index.2cf0d985.js";const v=H.formatDate,Me=M({__name:"IndexPage",setup(Z){const w=W(),{selectedBudget:y}=A(w),{currencyFormat:B}=K(),D="https://nestjs-boilerplate-production.up.railway.app",{subBudgetRequisitions:q}=G(y),{search:k,subBudgetDictionary:V,subBudgetDictionaryIsFetching:ee}=L(),I=[{name:"consecutiveId",field:"consecutiveId",label:"ID",align:"left"},{name:"requisition_number",field:"requisition_number",label:"N\xFAm. Requisici\xF3n"},{name:"estimated_amount",field:"estimated_amount",label:"Monto Estimado"},{name:"preparation_date",field:o=>v(o.preparation_date,"YYYY-MM-DD"),label:"Fecha de Preparaci\xF3n",align:"left"},{name:"processing_date",field:o=>v(o.processing_date,"YYYY-MM-DD"),label:"Fecha de Procesamiento",align:"left"},{name:"area",field:o=>o.area.description,label:"\xC1rea",align:"left"},{name:"event",field:o=>o.subBudget.event,label:"Evento",align:"left"},{name:"file",field:"file",label:"Archivo",align:"left"},{name:"actions",field:"actions",label:"Acciones",align:"left"}];c(void 0);const f=c(""),d=c(!1),m=c(void 0),{isDeletingSubBudgetRequisition:Q,deleteSubBudgetReq:x}=X();async function S(o,i){if(o===""){i();return}i(()=>{k.value=o})}async function F(o,i){console.log({value:o,initialValue:i})}function R(o){m.value=o,d.value=!0}async function C(){var o,i;await x({subBudgetId:(o=m.value)==null?void 0:o.subBudget.id,requisitionId:(i=m.value)==null?void 0:i.id}),P()}function P(){d.value=!1,m.value=void 0}return(o,i)=>(_(),g(z,null,{"card-body":t(()=>[a(Y,{columns:I,filter:f.value,pagination:{rowsPerPage:20},rows:s(q),title:"Requisiciones","wrap-cells":""},{"top-right":t(()=>[a(T,{modelValue:f.value,"onUpdate:modelValue":i[0]||(i[0]=e=>f.value=e),clearable:"",dense:"",label:"Buscar",outlined:""},null,8,["modelValue"])]),body:t(e=>[a(j,{props:e},{default:t(()=>[a(l,{key:"consecutiveId",props:e},{default:t(()=>[a(p,{class:"text-primary tw-font-bold",clickable:"",to:{name:"sub-budgets.edit.requisition",params:{id:e.row.subBudget.id,reqId:e.row.id}}},{default:t(()=>[a(b,null,{default:t(()=>[n(r((e.rowIndex+1).toString()),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1032,["props"]),a(l,{key:"requisition_number",props:e},{default:t(()=>[n(r(e.row.requisition_number),1)]),_:2},1032,["props"]),a(l,{key:"estimated_amount",props:e},{default:t(()=>[n(r(s(B)(e.row.estimated_amount)),1)]),_:2},1032,["props"]),a(l,{key:"preparation_date",props:e},{default:t(()=>[n(r(e.row.preparation_date),1)]),_:2},1032,["props"]),a(l,{key:"processing_date",props:e},{default:t(()=>[n(r(e.row.processing_date),1)]),_:2},1032,["props"]),a(l,{key:"area",props:e},{default:t(()=>[n(r(e.row.area.description),1)]),_:2},1032,["props"]),a(l,{key:"event",props:e},{default:t(()=>[n(r(e.row.subBudget.event)+" ",1),a(E,{modelValue:e.row.subBudget,"onUpdate:modelValue":u=>e.row.subBudget=u,buttons:"","label-cancel":"Cancelar","label-set":"Guardar",persistent:"",onSave:F},{default:t(u=>[a(U,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,class:"full-width",clearable:"",dense:"","emit-value":"","input-debounce":"600",label:"Evento","map-options":"","option-label":"event","option-value":"id",options:s(V),outlined:"","use-input":"",onFilter:S},{"no-option":t(()=>[a(p,null,{default:t(()=>[a(b,{class:"text-grey"},{default:t(()=>[n(" Sin resultados ")]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(l,{key:"file",props:e},{default:t(()=>[e.row.file?(_(),g(J,{key:0,"file-url":`${s(D)}/api/files/preview/${e.row.file}`},null,8,["file-url"])):N("",!0)]),_:2},1032,["props"]),a(l,{key:"actions",props:e},{default:t(()=>[a($,{color:"negative",flat:"",icon:"delete",round:"",onClick:u=>R(e.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["filter","rows"])]),footer:t(()=>[a(O,{modelValue:d.value,"onUpdate:modelValue":i[1]||(i[1]=e=>d.value=e),"card-title":"\xBFDesea eliminar la requisici\xF3n?",deleting:s(Q),onConfirmDelete:C},null,8,["modelValue","deleting"])]),_:1}))}});export{Me as default};
