import{y as Te,r as p,c as S,z as Ge,o as Ct,i as Tt,ah as ge,aS as Vt,h as $,b0 as Xe,a5 as Ue,ar as kt,a1 as Mt,_ as le,N as Ye,g as ye,aY as Dt,v as fe,w as Y,E as St,D as Pt,x as ce,H as Qt,ai as Ze,O as et,b1 as Bt,j as Pe,V as tt,m as Qe,M as at,p as X,k as ue,l as o,d as t,q,t as y,u as K,b as lt,s as x,aH as At,ap as It,b2 as $t,ag as Me,F as De,an as Se,X as te,b3 as ze}from"./index.14e8ebb5.js";import{u as Rt,p as Oe}from"./planeacion.api.91fa18e5.js";import{Q as Et}from"./QResizeObserver.f619f632.js";import{j as Ve,c as Ne,a as ae,Q as Lt}from"./format.d9f81dde.js";import{r as Ft,b as jt,Q as se}from"./QSelect.3bb31b5f.js";import{Q as Ke}from"./QTooltip.133969a2.js";import{a as de,b as me,Q as Be}from"./QItemLabel.7fed4ad0.js";import{Q as Ut}from"./QToggle.b77bfd12.js";import{Q as zt}from"./QList.2e5bba7a.js";import{Q as oe}from"./QInput.0f74b52d.js";import{Q as Ot}from"./QBtnGroup.374ee16e.js";import{a as Nt,Q as D}from"./QTable.4cc72d32.js";import{Q as Kt,a as We}from"./QTr.e392dde6.js";import{u as Wt,a as Ht,b as Jt,c as Gt}from"./use-panel.ad4505e0.js";import{u as ot,a as nt}from"./use-dark.e748ccdc.js";import{T as Xt}from"./TouchPan.343c3ff2.js";import{Q as he}from"./QCardSection.0d056ee7.js";import{Q as it}from"./QCardActions.dee82ce4.js";import{Q as rt}from"./QCard.01814d56.js";import{a as ut,Q as Yt}from"./QChip.c477ed29.js";import{Q as Zt}from"./QPage.6a9365d9.js";import{C as ke}from"./ClosePopup.559675a8.js";import{b as ea}from"./useBudgets.97580f0c.js";import{T as ta}from"./TablePage.c82df34f.js";import{Q as aa}from"./QForm.4ada3f4b.js";import{Q as la}from"./QSpace.a3e1f224.js";import{u as oa}from"./useDictionaries.6e55a643.js";import{c as st}from"./index.7adaf3a2.js";import{_ as na}from"./plugin-vue_export-helper.21dcd24c.js";import{u as ia,a as ra}from"./useBudgetDetail.5d3a1ab8.js";import{u as ua}from"./useMoney.dbc60660.js";import{u as sa}from"./useExportDataToCsv.e8a7b01e.js";import{u as ca}from"./useTableFilter.369342e0.js";import{l as _e}from"./layout.a470fe7f.js";import{u as ct}from"./useMutation.esm.fc6ad15c.js";import"./index.2cf0d985.js";import"./scroll.d839d060.js";import"./QCheckbox.cc510596.js";import"./touch.70a9dd44.js";import"./utils.esm.1cc111ad.js";import"./app.ceedfc2e.js";import"./ArticleResource.aab864ed.js";import"./date.d6e11009.js";import"./mutation.esm.6a2477d4.js";let da=0;const ma=["click","keydown"],fa={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${da++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function va(e,h,v,m){const f=Tt(Xe,Te);if(f===Te)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Te;const{proxy:k}=ye(),M=p(null),A=p(null),R=p(null),E=S(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),I=S(()=>f.currentModel.value===e.name),N=S(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(I.value===!0?" q-tab--active"+(f.tabProps.value.activeClass?" "+f.tabProps.value.activeClass:"")+(f.tabProps.value.activeColor?` text-${f.tabProps.value.activeColor}`:"")+(f.tabProps.value.activeBgColor?` bg-${f.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&f.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||f.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(m!==void 0?m.linkClass.value:"")),L=S(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(f.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),c=S(()=>e.disable===!0||f.hasFocus.value===!0||I.value===!1&&f.hasActiveTab.value===!0?-1:e.tabindex||0);function T(b,_){if(_!==!0&&M.value!==null&&M.value.focus(),e.disable===!0){m!==void 0&&m.hasRouterLink.value===!0&&Ue(b);return}if(m===void 0){f.updateModel({name:e.name}),v("click",b);return}if(m.hasRouterLink.value===!0){const n=(s={})=>{let V;const z=s.to===void 0||Dt(s.to,e.to)===!0?f.avoidRouteWatcher=Rt():null;return m.navigateToRouterLink(b,{...s,returnRouterError:!0}).catch(J=>{V=J}).then(J=>{if(z===f.avoidRouteWatcher&&(f.avoidRouteWatcher=!1,V===void 0&&(J===void 0||J.message.startsWith("Avoided redundant navigation")===!0)&&f.updateModel({name:e.name})),s.returnRouterError===!0)return V!==void 0?Promise.reject(V):J})};v("click",b,n),b.defaultPrevented!==!0&&n();return}v("click",b)}function F(b){kt(b,[13,32])?T(b,!0):Mt(b)!==!0&&b.keyCode>=35&&b.keyCode<=40&&b.altKey!==!0&&b.metaKey!==!0&&f.onKbdNavigate(b.keyCode,k.$el)===!0&&Ue(b),v("keydown",b)}function U(){const b=f.tabProps.value.narrowIndicator,_=[],n=$("div",{ref:R,class:["q-tab__indicator",f.tabProps.value.indicatorClass]});e.icon!==void 0&&_.push($(le,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&_.push($("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&_.push(e.alertIcon!==void 0?$(le,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):$("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),b===!0&&_.push(n);const s=[$("div",{class:"q-focus-helper",tabindex:-1,ref:M}),$("div",{class:L.value},Ye(h.default,_))];return b===!1&&s.push(n),s}const B={name:S(()=>e.name),rootRef:A,tabIndicatorRef:R,routeData:m};Ge(()=>{f.unregisterTab(B)}),Ct(()=>{f.registerTab(B)});function W(b,_){const n={ref:A,class:N.value,tabindex:c.value,role:"tab","aria-selected":I.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:T,onKeydown:F,..._};return ge($(b,n,U()),[[Vt,E.value]])}return{renderTab:W,$tabs:f}}var He=fe({name:"QTab",props:fa,emits:ma,setup(e,{slots:h,emit:v}){const{renderTab:m}=va(e,h,v);return()=>m("div")}});function ba(e,h,v){const m=v===!0?["left","right"]:["top","bottom"];return`absolute-${h===!0?m[0]:m[1]}${e?` text-${e}`:""}`}const ga=["left","center","right","justify"];var ha=fe({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>ga.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:h,emit:v}){const{proxy:m}=ye(),{$q:f}=m,{registerTick:k}=Ve(),{registerTick:M}=Ve(),{registerTick:A}=Ve(),{registerTimeout:R,removeTimeout:E}=Ne(),{registerTimeout:I,removeTimeout:N}=Ne(),L=p(null),c=p(null),T=p(e.modelValue),F=p(!1),U=p(!0),B=p(!1),W=p(!1),b=[],_=p(0),n=p(!1);let s=null,V=null,z;const J=S(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:ba(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),pe=S(()=>{const l=_.value,d=T.value;for(let g=0;g<l;g++)if(b[g].name.value===d)return!0;return!1}),we=S(()=>`q-tabs__content--align-${F.value===!0?"left":W.value===!0?"justify":e.align}`),ve=S(()=>`q-tabs row no-wrap items-center q-tabs--${F.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),qe=S(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+we.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),ne=S(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),ie=S(()=>e.vertical!==!0&&f.lang.rtl===!0),i=S(()=>Ft===!1&&ie.value===!0);Y(ie,re),Y(()=>e.modelValue,l=>{r({name:l,setCurrent:!0,skipEmit:!0})}),Y(()=>e.outsideArrows,H);function r({name:l,setCurrent:d,skipEmit:g}){T.value!==l&&(g!==!0&&e["onUpdate:modelValue"]!==void 0&&v("update:modelValue",l),(d===!0||e["onUpdate:modelValue"]===void 0)&&(u(T.value,l),T.value=l))}function H(){k(()=>{a({width:L.value.offsetWidth,height:L.value.offsetHeight})})}function a(l){if(ne.value===void 0||c.value===null)return;const d=l[ne.value.container],g=Math.min(c.value[ne.value.scroll],Array.prototype.reduce.call(c.value.children,(Q,C)=>Q+(C[ne.value.content]||0),0)),P=d>0&&g>d;F.value=P,P===!0&&M(re),W.value=d<parseInt(e.breakpoint,10)}function u(l,d){const g=l!=null&&l!==""?b.find(Q=>Q.name.value===l):null,P=d!=null&&d!==""?b.find(Q=>Q.name.value===d):null;if(g&&P){const Q=g.tabIndicatorRef.value,C=P.tabIndicatorRef.value;s!==null&&(clearTimeout(s),s=null),Q.style.transition="none",Q.style.transform="none",C.style.transition="none",C.style.transform="none";const w=Q.getBoundingClientRect(),j=C.getBoundingClientRect();C.style.transform=e.vertical===!0?`translate3d(0,${w.top-j.top}px,0) scale3d(1,${j.height?w.height/j.height:1},1)`:`translate3d(${w.left-j.left}px,0,0) scale3d(${j.width?w.width/j.width:1},1,1)`,A(()=>{s=setTimeout(()=>{s=null,C.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",C.style.transform="none"},70)})}P&&F.value===!0&&O(P.rootRef.value)}function O(l){const{left:d,width:g,top:P,height:Q}=c.value.getBoundingClientRect(),C=l.getBoundingClientRect();let w=e.vertical===!0?C.top-P:C.left-d;if(w<0){c.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(w),re();return}w+=e.vertical===!0?C.height-Q:C.width-g,w>0&&(c.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(w),re())}function re(){const l=c.value;if(l===null)return;const d=l.getBoundingClientRect(),g=e.vertical===!0?l.scrollTop:Math.abs(l.scrollLeft);ie.value===!0?(U.value=Math.ceil(g+d.width)<l.scrollWidth-1,B.value=g>0):(U.value=g>0,B.value=e.vertical===!0?Math.ceil(g+d.height)<l.scrollHeight:Math.ceil(g+d.width)<l.scrollWidth)}function Ae(l){V!==null&&clearInterval(V),V=setInterval(()=>{gt(l)===!0&&Z()},5)}function Ie(){Ae(i.value===!0?Number.MAX_SAFE_INTEGER:0)}function $e(){Ae(i.value===!0?0:Number.MAX_SAFE_INTEGER)}function Z(){V!==null&&(clearInterval(V),V=null)}function vt(l,d){const g=Array.prototype.filter.call(c.value.children,j=>j===d||j.matches&&j.matches(".q-tab.q-focusable")===!0),P=g.length;if(P===0)return;if(l===36)return O(g[0]),g[0].focus(),!0;if(l===35)return O(g[P-1]),g[P-1].focus(),!0;const Q=l===(e.vertical===!0?38:37),C=l===(e.vertical===!0?40:39),w=Q===!0?-1:C===!0?1:void 0;if(w!==void 0){const j=ie.value===!0?-1:1,G=g.indexOf(d)+w*j;return G>=0&&G<P&&(O(g[G]),g[G].focus({preventScroll:!0})),!0}}const bt=S(()=>i.value===!0?{get:l=>Math.abs(l.scrollLeft),set:(l,d)=>{l.scrollLeft=-d}}:e.vertical===!0?{get:l=>l.scrollTop,set:(l,d)=>{l.scrollTop=d}}:{get:l=>l.scrollLeft,set:(l,d)=>{l.scrollLeft=d}});function gt(l){const d=c.value,{get:g,set:P}=bt.value;let Q=!1,C=g(d);const w=l<C?-1:1;return C+=w*5,C<0?(Q=!0,C=0):(w===-1&&C<=l||w===1&&C>=l)&&(Q=!0,C=l),P(d,C),re(),Q}function Re(l,d){for(const g in l)if(l[g]!==d[g])return!1;return!0}function ht(){let l=null,d={matchedLen:0,queryDiff:9999,hrefLen:0};const g=b.filter(w=>w.routeData!==void 0&&w.routeData.hasRouterLink.value===!0),{hash:P,query:Q}=m.$route,C=Object.keys(Q).length;for(const w of g){const j=w.routeData.exact.value===!0;if(w.routeData[j===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:G,query:xe,matched:qt,href:xt}=w.routeData.resolvedLink.value,Ce=Object.keys(xe).length;if(j===!0){if(G!==P||Ce!==C||Re(Q,xe)===!1)continue;l=w.name.value;break}if(G!==""&&G!==P||Ce!==0&&Re(xe,Q)===!1)continue;const ee={matchedLen:qt.length,queryDiff:C-Ce,hrefLen:xt.length-G.length};if(ee.matchedLen>d.matchedLen){l=w.name.value,d=ee;continue}else if(ee.matchedLen!==d.matchedLen)continue;if(ee.queryDiff<d.queryDiff)l=w.name.value,d=ee;else if(ee.queryDiff!==d.queryDiff)continue;ee.hrefLen>d.hrefLen&&(l=w.name.value,d=ee)}l===null&&b.some(w=>w.routeData===void 0&&w.name.value===T.value)===!0||r({name:l,setCurrent:!0})}function _t(l){if(E(),n.value!==!0&&L.value!==null&&l.target&&typeof l.target.closest=="function"){const d=l.target.closest(".q-tab");d&&L.value.contains(d)===!0&&(n.value=!0,F.value===!0&&O(d))}}function yt(){R(()=>{n.value=!1},30)}function be(){Le.avoidRouteWatcher===!1?I(ht):N()}function Ee(){if(z===void 0){const l=Y(()=>m.$route.fullPath,be);z=()=>{l(),z=void 0}}}function pt(l){b.push(l),_.value++,H(),l.routeData===void 0||m.$route===void 0?I(()=>{if(F.value===!0){const d=T.value,g=d!=null&&d!==""?b.find(P=>P.name.value===d):null;g&&O(g.rootRef.value)}}):(Ee(),l.routeData.hasRouterLink.value===!0&&be())}function wt(l){b.splice(b.indexOf(l),1),_.value--,H(),z!==void 0&&l.routeData!==void 0&&(b.every(d=>d.routeData===void 0)===!0&&z(),be())}const Le={currentModel:T,tabProps:J,hasFocus:n,hasActiveTab:pe,registerTab:pt,unregisterTab:wt,verifyRouteModel:be,updateModel:r,onKbdNavigate:vt,avoidRouteWatcher:!1};Qt(Xe,Le);function Fe(){s!==null&&clearTimeout(s),Z(),z!==void 0&&z()}let je;return Ge(Fe),St(()=>{je=z!==void 0,Fe()}),Pt(()=>{je===!0&&Ee(),H()}),()=>$("div",{ref:L,class:ve.value,role:"tablist",onFocusin:_t,onFocusout:yt},[$(Et,{onResize:a}),$("div",{ref:c,class:qe.value,onScroll:re},ce(h.default)),$(le,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(U.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||f.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:Ie,onTouchstartPassive:Ie,onMouseupPassive:Z,onMouseleavePassive:Z,onTouchendPassive:Z}),$(le,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(B.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||f.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:$e,onTouchstartPassive:$e,onMouseupPassive:Z,onMouseleavePassive:Z,onTouchendPassive:Z})])}}),Je=fe({name:"QTabPanel",props:Wt,setup(e,{slots:h}){return()=>$("div",{class:"q-tab-panel",role:"tabpanel"},ce(h.default))}}),_a=fe({name:"QTabPanels",props:{...Ht,...ot},emits:Jt,setup(e,{slots:h}){const v=ye(),m=nt(e,v.proxy.$q),{updatePanelsList:f,getPanelContent:k,panelDirectives:M}=Gt(),A=S(()=>"q-tab-panels q-panel-parent"+(m.value===!0?" q-tab-panels--dark q-dark":""));return()=>(f(h),Ze("div",{class:A.value},k(),"pan",e.swipeable,()=>M.value))}}),ya=fe({name:"QSplitter",props:{...ot,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:h,emit:v}){const{proxy:{$q:m}}=ye(),f=nt(e,m),k=p(null),M={before:p(null),after:p(null)},A=S(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(f.value===!0?" q-splitter--dark":"")),R=S(()=>e.horizontal===!0?"height":"width"),E=S(()=>e.reverse!==!0?"before":"after"),I=S(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function N(n){return(e.unit==="%"?n:Math.round(n))+e.unit}const L=S(()=>({[E.value]:{[R.value]:N(e.modelValue)}}));let c,T,F,U,B;function W(n){if(n.isFirst===!0){const V=k.value.getBoundingClientRect()[R.value];c=e.horizontal===!0?"up":"left",T=e.unit==="%"?100:V,F=Math.min(T,I.value[1],Math.max(I.value[0],e.modelValue)),U=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:m.lang.rtl===!0?-1:1)*(e.unit==="%"?V===0?0:100/V:1),k.value.classList.add("q-splitter--active");return}if(n.isFinal===!0){B!==e.modelValue&&v("update:modelValue",B),k.value.classList.remove("q-splitter--active");return}const s=F+U*(n.direction===c?-1:1)*n.distance[e.horizontal===!0?"y":"x"];B=Math.min(T,I.value[1],Math.max(I.value[0],s)),M[E.value].value.style[R.value]=N(B),e.emitImmediately===!0&&e.modelValue!==B&&v("update:modelValue",B)}const b=S(()=>[[Xt,W,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function _(n,s){n<s[0]?v("update:modelValue",s[0]):n>s[1]&&v("update:modelValue",s[1])}return Y(()=>e.modelValue,n=>{_(n,I.value)}),Y(()=>e.limits,()=>{et(()=>{_(e.modelValue,I.value)})}),()=>{const n=[$("div",{ref:M.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:L.value.before},ce(h.before)),$("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[Ze("div",{class:"q-splitter__separator-area absolute-full"},ce(h.separator),"sep",e.disable!==!0,()=>b.value)]),$("div",{ref:M.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:L.value.after},ce(h.after))];return $("div",{class:A.value,ref:k},Ye(h.default,n))}}});const dt=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],pa=(e,h=0,v=!1)=>{let m;return(...f)=>{v&&!m&&e(...f),clearTimeout(m),m=setTimeout(()=>{e(...f)},h)}},wa=(e,h,v)=>{const m=p(e);return Bt((f,k)=>({get(){return f(),m.value},set:pa(M=>{m.value=M,k()},h,v)}))};const qa={class:"self-center full-width no-outline",tabindex:"0"},xa=Pe({__name:"MonthBudgetForm",props:{month:null,budgetMonth:{default:()=>({quantity:0})},estimatedAmount:{default:0}},emits:["update:quantity"],setup(e,{emit:h}){const v=e;tt();const m=Qe(),{id:f}=m.params,k=at(st(v.budgetMonth)),M=wa(k.quantity||0,250,!1);return Y(M,A=>{A>=0&&(k.quantity=A,k.month=v.month,k.budget_detail_id=f,h("update:quantity",k))}),(A,R)=>(X(),ue(Be,{class:"month-container"},{default:o(()=>[t(de,null,{default:o(()=>[t(me,{overline:""},{default:o(()=>[q(y(e.month),1)]),_:1}),t(oe,{modelValue:K(M),"onUpdate:modelValue":R[0]||(R[0]=E=>lt(M)?M.value=E:null),modelModifiers:{number:!0},dense:"","input-class":"tw-text-right",label:"Cantidad",min:"0",outlined:"",type:"number"},null,8,["modelValue"])]),_:1}),t(de,{side:""},{default:o(()=>[t(me,{overline:""},{default:o(()=>[q("\xA0\xA0\xA0")]),_:1}),t(jt,{dense:"",label:"Total",outlined:"","stack-label":""},{control:o(()=>[x("div",qa,y(k.quantity*v.estimatedAmount),1)]),prepend:o(()=>[t(le,{name:"o_attach_money"})]),_:1})]),_:1})]),_:1}))}});var mt=na(xa,[["__scopeId","data-v-5bd66e44"]]);const Ca=x("div",{class:"tw-text-xl"},"Agregar bien",-1),Ta={class:"row q-col-gutter-md q-mb-md"},Va={class:"col col-md-2"},ka={class:"col col-md-10"},Ma={class:"row q-col-gutter-md q-mb-md"},Da={class:"col col-md-2"},Sa={class:"col col-md-10"},Pa={class:"row q-col-gutter-md q-mb-md"},Qa={class:"col"},Ba={class:"row q-col-gutter-md q-mb-md"},Aa={class:"col"},Ia={class:"col"},$a={class:"col"},Ra={class:"row"},Ea={class:"col"},La=Pe({__name:"BudgetDetailForm",setup(e){tt();const h=Qe(),{id:v}=h.params,{actionDictionary:m,lineDictionary:f,areaDictionary:k,getArticleByName:M}=oa(),{storeBudgetDetailMutation:A}=ia(),{isLoading:R}=A,E=p(m.value),I=p(f.value),N=p(k.value),L=p([]),c=at({action:null,line:null,area:null,article:null,estimated_amount:0,justification:"",month:[],total:0,budgetMonths:[]}),T=p([]);At(()=>{if(T.value.length>0){const _=T.value.reduce((n,s)=>n+s.quantity,0);c.total=_*c.estimated_amount}});function F(_,n,s){n(()=>{const V=_.toLowerCase();N.value=k.value.filter(z=>z.label.toLowerCase().indexOf(V)>-1)})}function U(_,n,s){if(_.length<2){s();return}n(()=>{const V=_.toLowerCase();L.value=M(V).value})}function B(_){const n=T.value.findIndex(s=>s.month===_.month);n>-1?T.value[n]=_:T.value.push(_)}function W({value:_}){T.value=T.value.filter(n=>n.month!==_)}async function b(){c.budgetMonths=T.value,await A.mutateAsync({budgetId:v,budgetDetail:c}),c.action=null,c.line=null,c.area=null,c.article=null,c.estimated_amount=0,c.justification="",c.month=[],c.total=0,c.budgetMonths=[],T.value=[]}return(_,n)=>(X(),ue(rt,null,{default:o(()=>[t(he,null,{default:o(()=>[Ca]),_:1}),t(ae),t(he,null,{default:o(()=>[t(aa,null,{default:o(()=>[x("div",Ta,[x("div",Va,[t(se,{modelValue:c.action,"onUpdate:modelValue":n[0]||(n[0]=s=>c.action=s),dense:"",label:"ACC",options:E.value,outlined:""},null,8,["modelValue","options"])]),x("div",ka,[t(se,{modelValue:c.area,"onUpdate:modelValue":n[1]||(n[1]=s=>c.area=s),dense:"",label:"\xC1rea",options:N.value,outlined:"","use-input":"",onFilter:F},null,8,["modelValue","options"])])]),x("div",Ma,[x("div",Da,[t(se,{modelValue:c.line,"onUpdate:modelValue":n[2]||(n[2]=s=>c.line=s),dense:"",label:"Partida",options:I.value,outlined:""},null,8,["modelValue","options"])]),x("div",Sa,[t(se,{modelValue:c.article,"onUpdate:modelValue":n[3]||(n[3]=s=>c.article=s),dense:"",hint:"M\xEDnimo 2 caracteres para activar el filtrado",label:"Art\xEDculos",options:L.value,outlined:"","use-input":"",onFilter:U},{option:o(s=>[t(Be,It($t(s.itemProps)),{default:o(()=>[t(de,null,{default:o(()=>[t(me,null,{default:o(()=>[q(y(s.opt.label),1)]),_:2},1024),t(me,{caption:""},{default:o(()=>[q(y(s.opt.caption),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])])]),x("div",Pa,[x("div",Qa,[t(oe,{modelValue:c.justification,"onUpdate:modelValue":n[4]||(n[4]=s=>c.justification=s),dense:"",label:"Justificaci\xF3n",outlined:"",type:"textarea"},null,8,["modelValue"])])]),x("div",Ba,[x("div",Aa,[t(se,{modelValue:c.month,"onUpdate:modelValue":n[5]||(n[5]=s=>c.month=s),dense:"",label:"Mes",multiple:"",options:K(dt),outlined:"","use-chips":"",onRemove:W},null,8,["modelValue","options"])]),x("div",Ia,[t(oe,{modelValue:c.estimated_amount,"onUpdate:modelValue":n[6]||(n[6]=s=>c.estimated_amount=s),modelModifiers:{number:!0},dense:"","input-class":"tw-text-right",label:"Monto estimado",outlined:"",type:"number"},{prepend:o(()=>[t(le,{name:"o_attach_money"})]),_:1},8,["modelValue"])]),x("div",$a,[t(oe,{modelValue:c.total,"onUpdate:modelValue":n[7]||(n[7]=s=>c.total=s),dense:"","input-class":"tw-text-right",label:"Total",outlined:"",readonly:"",type:"number"},{prepend:o(()=>[t(le,{name:"o_attach_money"})]),_:1},8,["modelValue"])])]),x("div",Ra,[x("div",Ea,[(X(!0),Me(De,null,Se(c.month,s=>(X(),ue(mt,{key:s,"estimated-amount":c.estimated_amount,month:s,"onUpdate:quantity":B},null,8,["estimated-amount","month"]))),128))])])]),_:1})]),_:1}),t(ae),t(it,null,{default:o(()=>[t(la),t(te,{color:"primary",icon:"o_save",loading:K(R),unelevated:"",onClick:b},{default:o(()=>[q(" guardar ")]),_:1},8,["loading"])]),_:1})]),_:1}))}});var ft={create({budgetId:e,budgetDetailId:h,payload:v}){return Oe.post(`/budgets/${e}/budget-details/${h}/months`,v)},update({budgetId:e,budgetDetailId:h,BudgetDetailMonthId:v,payload:m}){return delete m.id,delete m.total,Oe.patch(`/budgets/${e}/budget-details/${h}/months/${v}`,m)}};const Fa=async({budgetId:e,budgetDetailId:h,payload:v})=>{const{data:m}=await ft.create({budgetId:e,budgetDetailId:h,payload:v});return m},ja=async({budgetId:e,budgetDetailId:h,BudgetDetailMonthId:v,payload:m})=>{const{data:f}=await ft.update({budgetId:e,budgetDetailId:h,BudgetDetailMonthId:v,payload:m});return f},Ua=()=>{const e=ut();return{storeBudgetDetailMonthMutation:ct({mutationFn:v=>Fa(v),onSuccess:async(v,m)=>{await e.invalidateQueries(["budget",m.budgetId]),_e.showSuccessNotification("El bien se agreg\xF3 al presupuesto con \xE9xito")},onError:()=>{_e.showErrorNotification("Error al agregar el bien al presupuesto")}})}},za=()=>{const e=ut();return{updateBudgetDetailMonthMutation:ct({mutationFn:v=>ja(v),onSuccess:async(v,m)=>{await e.invalidateQueries(["budget",m.budgetId]),_e.showSuccessNotification("El bien se agreg\xF3 al presupuesto con \xE9xito")},onError:()=>{_e.showErrorNotification("Error al agregar el bien al presupuesto")}})}},Oa={class:"q-my-xs q-pt-sm q-ml-md tw-text-2xl tw-font-bold tw-text-slate-700"},Na={class:"row"},Ka={class:"col"},Wa=x("div",{class:"text-h6"},"Editar Art\xEDculo",-1),Ha={class:"text-h6"},Ja=x("div",{class:"text-caption"},"L\xEDnea",-1),Ga={class:"text-h6"},Xa=x("div",{class:"text-caption"},"Acci\xF3n",-1),Ya={class:"text-h6"},Za={class:"text-caption"},el={class:"text-h6"},tl={class:"text-subtitle2"},al=x("div",{class:"text-caption"},"Art\xEDculo",-1),Wl=Pe({__name:"DetailPage",setup(e){const{exportDataToCsv:h}=sa(),{updateBudgetDetailMutation:v}=ra(),{updateBudgetDetailMonthMutation:m}=za(),{storeBudgetDetailMonthMutation:f}=Ua(),k=p(),M=Qe(),{id:A}=M.params,{budget:R}=ea(A),{currencyFormat:E}=ua(),I=[{name:"consecutiveId",label:"ID",field:"consecutiveId",sortable:!1,required:!0},{name:"edit",required:!0,label:"Editar",align:"left",field:"edit",format:i=>"edit"},{name:"action",field:i=>i.action.name,label:"Acci\xF3n",sortable:!0,align:"left"},{name:"line",field:i=>i.line.name,label:"Partida",sortable:!0,align:"left"},{name:"department",field:i=>i.department.alias,label:"\xC1rea",sortable:!0,align:"left"},{name:"article",field:i=>i.article.name,label:"Bien",sortable:!0,align:"left"},{name:"article_description",field:i=>i.article.description,label:"Descripci\xF3n del bien",sortable:!0,align:"left"},{name:"justification",field:"justification",label:"Justificaci\xF3n",sortable:!0,align:"left"},{name:"enero",field:i=>{var r;return(r=i.enero)==null?void 0:r.quantity},label:"Enero",sortable:!0,align:"right"},{name:"febrero",field:i=>{var r;return(r=i.febrero)==null?void 0:r.quantity},label:"Febrero",sortable:!0,align:"right"},{name:"marzo",field:i=>{var r;return(r=i.marzo)==null?void 0:r.quantity},label:"Marzo",sortable:!0,align:"right"},{name:"abril",field:i=>{var r;return(r=i.abril)==null?void 0:r.quantity},label:"Abril",sortable:!0,align:"right"},{name:"mayo",field:i=>{var r;return(r=i.mayo)==null?void 0:r.quantity},label:"Mayo",sortable:!0,align:"right"},{name:"junio",field:i=>{var r;return(r=i.junio)==null?void 0:r.quantity},label:"Junio",sortable:!0,align:"right"},{name:"julio",field:i=>{var r;return(r=i.julio)==null?void 0:r.quantity},label:"Julio",sortable:!0,align:"right"},{name:"agosto",field:i=>{var r;return(r=i.agosto)==null?void 0:r.quantity},label:"Agosto",sortable:!0,align:"right"},{name:"septiembre",field:i=>{var r;return(r=i.septiembre)==null?void 0:r.quantity},label:"Septiembre",sortable:!0,align:"right"},{name:"octubre",field:i=>{var r;return(r=i.octubre)==null?void 0:r.quantity},label:"Octubre",sortable:!0,align:"right"},{name:"noviembre",field:i=>{var r;return(r=i.noviembre)==null?void 0:r.quantity},label:"Noviembre",sortable:!0,align:"right"},{name:"diciembre",field:i=>{var r;return(r=i.diciembre)==null?void 0:r.quantity},label:"Diciembre",sortable:!0,align:"right"},{name:"estimated_amount",field:i=>`${E(+i.estimated_amount)}`,label:"Precio",sortable:!0,align:"right"},{name:"total",field:i=>`${E(+i.total)}`,label:"Total",sortable:!0,align:"right"}],N=p(["action","line","department","article","estimated_amount","enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre","total"]),L=I.map(i=>({label:i.label,value:i.name})),{searchQuery:c,pagination:T,updatePagination:F}=ca(),U=p([]),B=p("articles-list"),W=p(20),b=p(!1),_=p(-1),n=p({});p({});const s=p(dt.map(i=>i.toLowerCase())),V=p([]);Y(R,()=>{var i;U.value=st(((i=R.value)==null?void 0:i.details)||[])},{immediate:!0}),Y(_,()=>{_.value===-1&&(V.value=[]),_.value>-1&&s.value.forEach(i=>{n.value[i]&&V.value.push(n.value[i])})});function z(){h(k.value.filteredSortedRows,I,"presupuesto")}async function J(i,r){r(),await v.mutateAsync({budgetDetail:i})}async function pe(i,r){r(),await v.mutateAsync({budgetDetail:i})}function we(i){_.value=U.value.indexOf(i),n.value={...i},b.value=!0}function ve(){b.value=!1,et(()=>{_.value=-1,n.value={}})}function qe(i){const r=V.value.findIndex(a=>a.month===i.month),H={...i,budget_detail_id:n.value.id,authorized_quantity:null,authorized:!1};r>-1?V.value[r]=H:V.value.push(H)}async function ne(i){await Promise.allSettled(i)}async function ie(){const i=V.value.map(({id:r,total:H,...a})=>r?m.mutateAsync({budgetId:A,budgetDetailId:a.budget_detail_id,BudgetDetailMonthId:r,payload:a}):f.mutateAsync({budgetId:A,budgetDetailId:a.budget_detail_id,payload:a}));await ne(i),ve()}return(i,r)=>(X(),ue(Zt,null,{default:o(()=>{var H;return[x("h5",Oa,"Presupuesto "+y((H=K(R))==null?void 0:H.year),1),t(ya,{modelValue:W.value,"onUpdate:modelValue":r[4]||(r[4]=a=>W.value=a),horizontal:""},{before:o(()=>[t(ha,{modelValue:B.value,"onUpdate:modelValue":r[0]||(r[0]=a=>B.value=a),class:"text-teal"},{default:o(()=>[t(He,{icon:"mail",label:"Art\xEDculos",name:"articles-list"}),t(He,{icon:"alarm",label:"Nuevo",name:"add-article"})]),_:1},8,["modelValue"])]),after:o(()=>[t(_a,{modelValue:B.value,"onUpdate:modelValue":r[3]||(r[3]=a=>B.value=a),animated:"",swipeable:"","transition-next":"jump-up","transition-prev":"jump-up",vertical:""},{default:o(()=>[t(Je,{name:"articles-list"},{default:o(()=>[x("div",Na,[x("div",Ka,[t(ta,null,{"card-body":o(()=>[t(K(Nt),{ref_key:"qTablePresupuesto",ref:k,columns:I,filter:K(c),pagination:K(T),"row-key":"id",rows:U.value,"rows-per-page-options":[13,26,52,0],separator:"cell",title:"Detalle","visible-columns":N.value,"onUpdate:pagination":K(F)},{"top-right":o(a=>[t(te,{class:"tw-mr-2",color:"primary","fab-mini":"",flat:"",icon:"tune",size:"sm"},{default:o(()=>[t(Ke,null,{default:o(()=>[q(" Mostrar/Ocultar columnas ")]),_:1}),t(Lt,{anchor:"top end",self:"center start"},{default:o(()=>[t(zt,null,{default:o(()=>[(X(!0),Me(De,null,Se(K(L),u=>(X(),ue(Be,{key:u.value,clickable:""},{default:o(()=>[t(de,null,{default:o(()=>[t(me,null,{default:o(()=>[q(y(u.label),1)]),_:2},1024)]),_:2},1024),t(de,{side:""},{default:o(()=>[t(Ut,{modelValue:N.value,"onUpdate:modelValue":r[1]||(r[1]=O=>N.value=O),color:"primary",val:u.value},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(te,{dense:"",flat:"",icon:a.inFullscreen?"fullscreen_exit":"fullscreen",round:"",onClick:a.toggleFullscreen},{default:o(()=>[t(Ke,{disable:i.$q.platform.is.mobile},{default:o(()=>[q(y(a.inFullscreen?"Salir de Pantalla Completa":"Pantalla Completa"),1)]),_:2},1032,["disable"])]),_:2},1032,["icon","onClick"]),t(oe,{modelValue:K(c),"onUpdate:modelValue":r[2]||(r[2]=u=>lt(c)?c.value=u:null),class:"q-mr-xs",clearable:"",debounce:"300",dense:"",outlined:"",placeholder:"Buscar"},{append:o(()=>[t(le,{name:"search"})]),_:1},8,["modelValue"]),t(Ot,{unelevated:""},{default:o(()=>[t(te,{color:"primary","icon-right":"archive",label:"Exportar a CSV",onClick:z})]),_:1})]),body:o(a=>[t(Kt,{props:a},{default:o(()=>[t(D,{key:"consecutiveId",props:a},{default:o(()=>[q(y(a.rowIndex+1),1)]),_:2},1032,["props"]),t(D,{key:"edit",props:a},{default:o(()=>[t(te,{color:"primary",dense:"",flat:"",icon:"edit",round:"",size:"sm",onClick:u=>we(a.row)},null,8,["onClick"])]),_:2},1032,["props"]),t(D,{key:"action",props:a},{default:o(()=>[q(y(a.row.action.name),1)]),_:2},1032,["props"]),t(D,{key:"line",props:a},{default:o(()=>[q(y(a.row.line.name),1)]),_:2},1032,["props"]),t(D,{key:"department",props:a},{default:o(()=>[q(y(a.row.department.alias),1)]),_:2},1032,["props"]),t(D,{key:"article",props:a},{default:o(()=>[q(y(a.row.article.name),1)]),_:2},1032,["props"]),t(D,{key:"article_description",props:a},{default:o(()=>[q(y(a.row.article.description),1)]),_:2},1032,["props"]),t(D,{key:"justification",props:a},{default:o(()=>[q(y(a.row.justification),1)]),_:2},1032,["props"]),t(D,{key:"enero",props:a},{default:o(()=>{var u;return[q(y((u=a.row.enero)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"febrero",props:a},{default:o(()=>{var u;return[q(y((u=a.row.febrero)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"marzo",props:a},{default:o(()=>{var u;return[q(y((u=a.row.marzo)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"abril",props:a},{default:o(()=>{var u;return[q(y((u=a.row.abril)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"mayo",props:a},{default:o(()=>{var u;return[q(y((u=a.row.mayo)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"junio",props:a},{default:o(()=>{var u;return[q(y((u=a.row.junio)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"julio",props:a},{default:o(()=>{var u;return[q(y((u=a.row.julio)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"agosto",props:a},{default:o(()=>{var u;return[q(y((u=a.row.agosto)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"septiembre",props:a},{default:o(()=>{var u;return[q(y((u=a.row.septiembre)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"octubre",props:a},{default:o(()=>{var u;return[q(y((u=a.row.octubre)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"noviembre",props:a},{default:o(()=>{var u;return[q(y((u=a.row.noviembre)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"diciembre",props:a},{default:o(()=>{var u;return[q(y((u=a.row.diciembre)==null?void 0:u.quantity),1)]}),_:2},1032,["props"]),t(D,{key:"estimated_amount",class:"tw-cursor-pointer",props:a},{default:o(()=>[q(y(K(E)(+a.row.estimated_amount))+" ",1),t(We,{modelValue:a.row.estimated_amount,"onUpdate:modelValue":u=>a.row.estimated_amount=u},{default:o(u=>[t(oe,{modelValue:u.value,"onUpdate:modelValue":O=>u.value=O,modelModifiers:{number:!0},autofocus:"",dense:"",outlined:"",type:"number",onKeyup:ze(O=>pe(a.row,u.set),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),t(D,{key:"total",class:"tw-cursor-pointer",props:a},{default:o(()=>[q(y(K(E)(+a.row.total))+" ",1),t(We,{modelValue:a.row.total,"onUpdate:modelValue":u=>a.row.total=u},{default:o(u=>[t(oe,{modelValue:u.value,"onUpdate:modelValue":O=>u.value=O,modelModifiers:{number:!0},autofocus:"",dense:"",outlined:"",type:"number",onKeyup:ze(O=>J(a.row,u.set),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["filter","pagination","rows","visible-columns","onUpdate:pagination"])]),_:1})])])]),_:1}),t(Je,{name:"add-article"},{default:o(()=>[t(La)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),t(Yt,{modelValue:b.value,"onUpdate:modelValue":r[5]||(r[5]=a=>b.value=a),position:"right"},{default:o(()=>[t(rt,{class:"tw-w-[35rem]"},{default:o(()=>[t(he,{class:"bg-secondary text-white"},{default:o(()=>[Wa]),_:1}),t(ae),t(he,{class:"tw-max-h-[80vh] scroll"},{default:o(()=>[x("div",Ha,y(n.value.line.name),1),Ja,t(ae,{class:"tw-my-4"}),x("div",Ga,y(n.value.action.name),1),Xa,t(ae,{class:"tw-my-4"}),x("div",Ya,y(n.value.department.description),1),x("div",Za,"Departamento ("+y(n.value.department.alias)+")",1),t(ae,{class:"tw-my-4"}),x("div",el,y(n.value.article.name),1),x("div",tl,y(n.value.article.description),1),al,t(ae,{class:"tw-my-4"}),(X(!0),Me(De,null,Se(s.value,a=>(X(),ue(mt,{key:a,"budget-month":n.value[a],"estimated-amount":+n.value.estimated_amount,month:a,"onUpdate:quantity":qe},null,8,["budget-month","estimated-amount","month"]))),128))]),_:1}),t(ae),t(it,{align:"right"},{default:o(()=>[ge(t(te,{color:"secondary",flat:"",label:"Cancelar",onClick:ve},null,512),[[ke]]),ge(t(te,{color:"negative",flat:"",label:"Eliminar"},null,512),[[ke]]),ge(t(te,{color:"positive",flat:"",label:"Guardar",onClick:ie},null,512),[[ke]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}});export{Wl as default};
