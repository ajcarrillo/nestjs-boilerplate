import{c as i,v as ke,r as T,w as te,h as r,$ as de,x as mt,g as ye,J as $e,X as Q,aV as ht,a2 as We,a3 as gt,a5 as Ke,aa as yt,a9 as bt,ah as _t,ax as xt}from"./index.0b175f01.js";import{u as Ct,a as Dt}from"./use-dark.46bf0f81.js";import{a as Ue,i as wt,h as qt,u as Mt,b as St,d as Ft,c as kt,e as Vt,f as Be}from"./layout.e5b39b81.js";import{t as pt,_ as Ht,a as Re,f as jt,g as Ot,j as Se}from"./date.2de2ec43.js";import{v as ae,x as Yt,B as Tt,Q as It,G as Pt,H as Nt,I as At}from"./format.bc6b5d0a.js";import{Q as Et,h as zt}from"./QSelect.a01fc3f8.js";import{u as $t}from"./QForm.e02b1b3f.js";function Bt(){const a=new Map;return{getCache:function(f,g){return a[f]===void 0?a[f]=g:a[f]},getCacheWithFn:function(f,g){return a[f]===void 0?a[f]=g():a[f]}}}const Rt=["gregorian","persian"],Qt={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:a=>Rt.includes(a),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},Lt=["update:modelValue"];function K(a){return a.year+"/"+ae(a.month)+"/"+ae(a.day)}function Wt(a,f){const g=i(()=>a.disable!==!0&&a.readonly!==!0),k=i(()=>a.editable===!0?0:-1),h=i(()=>{const y=[];return a.color!==void 0&&y.push(`bg-${a.color}`),a.textColor!==void 0&&y.push(`text-${a.textColor}`),y.join(" ")});function q(){return a.locale!==void 0?{...f.lang.date,...a.locale}:f.lang.date}function D(y){const I=new Date,P=y===!0?null:0;if(a.calendar==="persian"){const j=pt(I);return{year:j.jy,month:j.jm,day:j.jd}}return{year:I.getFullYear(),month:I.getMonth()+1,day:I.getDate(),hour:P,minute:P,second:P,millisecond:P}}return{editable:g,tabindex:k,headerClass:h,getLocale:q,getCurrentDate:D}}const ee=20,Kt=["Calendar","Years","Months"],Qe=a=>Kt.includes(a),Fe=a=>/^-?[\d]+\/[0-1]\d$/.test(a),ue=" \u2014 ";function U(a){return a.year+"/"+ae(a.month)}var oa=ke({name:"QDate",props:{...Qt,...Ue,...Ct,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Fe},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Fe},navigationMaxYearMonth:{type:String,validator:Fe},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Qe}},emits:[...Lt,"rangeStart","rangeEnd","navigation"],setup(a,{slots:f,emit:g}){const{proxy:k}=ye(),{$q:h}=k,q=Dt(a,h),{getCache:D}=Bt(),{tabindex:y,headerClass:I,getLocale:P,getCurrentDate:j}=Wt(a,h);let O;const L=wt(a),J=qt(L),R=T(null),c=T(Te()),x=T(P()),ie=i(()=>Te()),v=i(()=>P()),M=i(()=>j()),s=T(Ie(c.value,x.value)),V=T(a.defaultView),b=h.lang.rtl===!0?"right":"left",H=T(b.value),E=T(b.value),C=s.value.year,S=T(C-C%ee-(C<0?ee:0)),p=T(null),ve=i(()=>{const e=a.landscape===!0?"landscape":"portrait";return`q-date q-date--${e} q-date--${e}-${a.minimal===!0?"minimal":"standard"}`+(q.value===!0?" q-date--dark q-dark":"")+(a.bordered===!0?" q-date--bordered":"")+(a.square===!0?" q-date--square no-border-radius":"")+(a.flat===!0?" q-date--flat no-shadow":"")+(a.disable===!0?" disabled":a.readonly===!0?" q-date--readonly":"")}),B=i(()=>a.color||"primary"),$=i(()=>a.textColor||"white"),ne=i(()=>a.emitImmediately===!0&&a.multiple!==!0&&a.range!==!0),se=i(()=>Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue!==null&&a.modelValue!==void 0?[a.modelValue]:[]),d=i(()=>se.value.filter(e=>typeof e=="string").map(e=>xe(e,c.value,x.value)).filter(e=>e.dateHash!==null&&e.day!==null&&e.month!==null&&e.year!==null)),F=i(()=>{const e=t=>xe(t,c.value,x.value);return se.value.filter(t=>ht(t)===!0&&t.from!==void 0&&t.to!==void 0).map(t=>({from:e(t.from),to:e(t.to)})).filter(t=>t.from.dateHash!==null&&t.to.dateHash!==null&&t.from.dateHash<t.to.dateHash)}),Y=i(()=>a.calendar!=="persian"?e=>new Date(e.year,e.month-1,e.day):e=>{const t=Re(e.year,e.month,e.day);return new Date(t.gy,t.gm-1,t.gd)}),X=i(()=>a.calendar==="persian"?K:(e,t,n)=>jt(new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond),t===void 0?c.value:t,n===void 0?x.value:n,e.year,e.timezoneOffset)),G=i(()=>d.value.length+F.value.reduce((e,t)=>e+1+Ot(Y.value(t.to),Y.value(t.from)),0)),Ve=i(()=>{if(a.title!==void 0&&a.title!==null&&a.title.length>0)return a.title;if(p.value!==null){const n=p.value.init,o=Y.value(n);return x.value.daysShort[o.getDay()]+", "+x.value.monthsShort[n.month-1]+" "+n.day+ue+"?"}if(G.value===0)return ue;if(G.value>1)return`${G.value} ${x.value.pluralDay}`;const e=d.value[0],t=Y.value(e);return isNaN(t.valueOf())===!0?ue:x.value.headerTitle!==void 0?x.value.headerTitle(t,e):x.value.daysShort[t.getDay()]+", "+x.value.monthsShort[e.month-1]+" "+e.day}),Je=i(()=>d.value.concat(F.value.map(t=>t.from)).sort((t,n)=>t.year-n.year||t.month-n.month)[0]),Xe=i(()=>d.value.concat(F.value.map(t=>t.to)).sort((t,n)=>n.year-t.year||n.month-t.month)[0]),pe=i(()=>{if(a.subtitle!==void 0&&a.subtitle!==null&&a.subtitle.length>0)return a.subtitle;if(G.value===0)return ue;if(G.value>1){const e=Je.value,t=Xe.value,n=x.value.monthsShort;return n[e.month-1]+(e.year!==t.year?" "+e.year+ue+n[t.month-1]+" ":e.month!==t.month?ue+n[t.month-1]:"")+" "+t.year}return d.value[0].year}),fe=i(()=>{const e=[h.iconSet.datetime.arrowLeft,h.iconSet.datetime.arrowRight];return h.lang.rtl===!0?e.reverse():e}),He=i(()=>a.firstDayOfWeek!==void 0?Number(a.firstDayOfWeek):x.value.firstDayOfWeek),Ge=i(()=>{const e=x.value.daysShort,t=He.value;return t>0?e.slice(t,7).concat(e.slice(0,t)):e}),W=i(()=>{const e=s.value;return a.calendar!=="persian"?new Date(e.year,e.month,0).getDate():Se(e.year,e.month)}),Ze=i(()=>typeof a.eventColor=="function"?a.eventColor:()=>a.eventColor),N=i(()=>{if(a.navigationMinYearMonth===void 0)return null;const e=a.navigationMinYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),A=i(()=>{if(a.navigationMaxYearMonth===void 0)return null;const e=a.navigationMaxYearMonth.split("/");return{year:parseInt(e[0],10),month:parseInt(e[1],10)}}),be=i(()=>{const e={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return N.value!==null&&N.value.year>=s.value.year&&(e.year.prev=!1,N.value.year===s.value.year&&N.value.month>=s.value.month&&(e.month.prev=!1)),A.value!==null&&A.value.year<=s.value.year&&(e.year.next=!1,A.value.year===s.value.year&&A.value.month<=s.value.month&&(e.month.next=!1)),e}),me=i(()=>{const e={};return d.value.forEach(t=>{const n=U(t);e[n]===void 0&&(e[n]=[]),e[n].push(t.day)}),e}),je=i(()=>{const e={};return F.value.forEach(t=>{const n=U(t.from),o=U(t.to);if(e[n]===void 0&&(e[n]=[]),e[n].push({from:t.from.day,to:n===o?t.to.day:void 0,range:t}),n<o){let l;const{year:_,month:u}=t.from,m=u<12?{year:_,month:u+1}:{year:_+1,month:1};for(;(l=U(m))<=o;)e[l]===void 0&&(e[l]=[]),e[l].push({from:void 0,to:l===o?t.to.day:void 0,range:t}),m.month++,m.month>12&&(m.year++,m.month=1)}}),e}),ce=i(()=>{if(p.value===null)return;const{init:e,initHash:t,final:n,finalHash:o}=p.value,[l,_]=t<=o?[e,n]:[n,e],u=U(l),m=U(_);if(u!==z.value&&m!==z.value)return;const w={};return u===z.value?(w.from=l.day,w.includeFrom=!0):w.from=1,m===z.value?(w.to=_.day,w.includeTo=!0):w.to=W.value,w}),z=i(()=>U(s.value)),et=i(()=>{const e={};if(a.options===void 0){for(let n=1;n<=W.value;n++)e[n]=!0;return e}const t=typeof a.options=="function"?a.options:n=>a.options.includes(n);for(let n=1;n<=W.value;n++){const o=z.value+"/"+ae(n);e[n]=t(o)}return e}),tt=i(()=>{const e={};if(a.events===void 0)for(let t=1;t<=W.value;t++)e[t]=!1;else{const t=typeof a.events=="function"?a.events:n=>a.events.includes(n);for(let n=1;n<=W.value;n++){const o=z.value+"/"+ae(n);e[n]=t(o)===!0&&Ze.value(o)}}return e}),at=i(()=>{let e,t;const{year:n,month:o}=s.value;if(a.calendar!=="persian")e=new Date(n,o-1,1),t=new Date(n,o-1,0).getDate();else{const l=Re(n,o,1);e=new Date(l.gy,l.gm-1,l.gd);let _=o-1,u=n;_===0&&(_=12,u--),t=Se(u,_)}return{days:e.getDay()-He.value-1,endDay:t}}),Oe=i(()=>{const e=[],{days:t,endDay:n}=at.value,o=t<0?t+7:t;if(o<6)for(let u=n-o;u<=n;u++)e.push({i:u,fill:!0});const l=e.length;for(let u=1;u<=W.value;u++){const m={i:u,event:tt.value[u],classes:[]};et.value[u]===!0&&(m.in=!0,m.flat=!0),e.push(m)}if(me.value[z.value]!==void 0&&me.value[z.value].forEach(u=>{const m=l+u-1;Object.assign(e[m],{selected:!0,unelevated:!0,flat:!1,color:B.value,textColor:$.value})}),je.value[z.value]!==void 0&&je.value[z.value].forEach(u=>{if(u.from!==void 0){const m=l+u.from-1,w=l+(u.to||W.value)-1;for(let Me=m;Me<=w;Me++)Object.assign(e[Me],{range:u.range,unelevated:!0,color:B.value,textColor:$.value});Object.assign(e[m],{rangeFrom:!0,flat:!1}),u.to!==void 0&&Object.assign(e[w],{rangeTo:!0,flat:!1})}else if(u.to!==void 0){const m=l+u.to-1;for(let w=l;w<=m;w++)Object.assign(e[w],{range:u.range,unelevated:!0,color:B.value,textColor:$.value});Object.assign(e[m],{flat:!1,rangeTo:!0})}else{const m=l+W.value-1;for(let w=l;w<=m;w++)Object.assign(e[w],{range:u.range,unelevated:!0,color:B.value,textColor:$.value})}}),ce.value!==void 0){const u=l+ce.value.from-1,m=l+ce.value.to-1;for(let w=u;w<=m;w++)e[w].color=B.value,e[w].editRange=!0;ce.value.includeFrom===!0&&(e[u].editRangeFrom=!0),ce.value.includeTo===!0&&(e[m].editRangeTo=!0)}s.value.year===M.value.year&&s.value.month===M.value.month&&(e[l+M.value.day-1].today=!0);const _=e.length%7;if(_>0){const u=7-_;for(let m=1;m<=u;m++)e.push({i:m,fill:!0})}return e.forEach(u=>{let m="q-date__calendar-item ";u.fill===!0?m+="q-date__calendar-item--fill":(m+=`q-date__calendar-item--${u.in===!0?"in":"out"}`,u.range!==void 0&&(m+=` q-date__range${u.rangeTo===!0?"-to":u.rangeFrom===!0?"-from":""}`),u.editRange===!0&&(m+=` q-date__edit-range${u.editRangeFrom===!0?"-from":""}${u.editRangeTo===!0?"-to":""}`),(u.range!==void 0||u.editRange===!0)&&(m+=` text-${u.color}`)),u.classes=m}),e}),nt=i(()=>a.disable===!0?{"aria-disabled":"true"}:a.readonly===!0?{"aria-readonly":"true"}:{});te(()=>a.modelValue,e=>{if(O===e)O=0;else{const{year:t,month:n}=Ie(c.value,x.value);le(t,n)}}),te(V,()=>{R.value!==null&&k.$el.contains(document.activeElement)===!0&&R.value.focus()}),te(()=>s.value.year,e=>{g("navigation",{year:e,month:s.value.month})}),te(()=>s.value.month,e=>{g("navigation",{year:s.value.year,month:e})}),te(ie,e=>{ze(e,x.value,"mask"),c.value=e}),te(v,e=>{ze(c.value,e,"locale"),x.value=e});function Ye(){const e=M.value,t=me.value[U(e)];(t===void 0||t.includes(e.day)===!1)&&De(e),_e(e.year,e.month)}function lt(e){Qe(e)===!0&&(V.value=e)}function ot(e,t){["month","year"].includes(e)&&(e==="month"?Ne:Ce)(t===!0?-1:1)}function _e(e,t){V.value="Calendar",le(e,t)}function ut(e,t){if(a.range===!1||!e){p.value=null;return}const n=Object.assign({...s.value},e),o=t!==void 0?Object.assign({...s.value},t):n;p.value={init:n,initHash:K(n),final:o,finalHash:K(o)},_e(n.year,n.month)}function Te(){return a.calendar==="persian"?"YYYY/MM/DD":a.mask}function xe(e,t,n){return Ht(e,t,n,a.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Ie(e,t){const n=Array.isArray(a.modelValue)===!0?a.modelValue:a.modelValue?[a.modelValue]:[];if(n.length===0)return Pe();const o=n[n.length-1],l=xe(o.from!==void 0?o.from:o,e,t);return l.dateHash===null?Pe():l}function Pe(){let e,t;if(a.defaultYearMonth!==void 0){const n=a.defaultYearMonth.split("/");e=parseInt(n[0],10),t=parseInt(n[1],10)}else{const n=M.value!==void 0?M.value:j();e=n.year,t=n.month}return{year:e,month:t,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:e+"/"+ae(t)+"/01"}}function Ne(e){let t=s.value.year,n=Number(s.value.month)+e;n===13?(n=1,t++):n===0&&(n=12,t--),le(t,n),ne.value===!0&&he("month")}function Ce(e){const t=Number(s.value.year)+e;le(t,s.value.month),ne.value===!0&&he("year")}function rt(e){le(e,s.value.month),V.value=a.defaultView==="Years"?"Months":"Calendar",ne.value===!0&&he("year")}function it(e){le(s.value.year,e),V.value="Calendar",ne.value===!0&&he("month")}function st(e,t){const n=me.value[t];(n!==void 0&&n.includes(e.day)===!0?we:De)(e)}function Z(e){return{year:e.year,month:e.month,day:e.day}}function le(e,t){N.value!==null&&e<=N.value.year&&(e=N.value.year,t<N.value.month&&(t=N.value.month)),A.value!==null&&e>=A.value.year&&(e=A.value.year,t>A.value.month&&(t=A.value.month));const n=e+"/"+ae(t)+"/01";n!==s.value.dateHash&&(H.value=s.value.dateHash<n==(h.lang.rtl!==!0)?"left":"right",e!==s.value.year&&(E.value=H.value),$e(()=>{S.value=e-e%ee-(e<0?ee:0),Object.assign(s.value,{year:e,month:t,day:1,dateHash:n})}))}function Ae(e,t,n){const o=e!==null&&e.length===1&&a.multiple===!1?e[0]:e;O=o;const{reason:l,details:_}=Ee(t,n);g("update:modelValue",o,l,_)}function he(e){const t=d.value[0]!==void 0&&d.value[0].dateHash!==null?{...d.value[0]}:{...s.value};$e(()=>{t.year=s.value.year,t.month=s.value.month;const n=a.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Se(t.year,t.month);t.day=Math.min(Math.max(1,t.day),n);const o=oe(t);O=o;const{details:l}=Ee("",t);g("update:modelValue",o,e,l)})}function Ee(e,t){return t.from!==void 0?{reason:`${e}-range`,details:{...Z(t.target),from:Z(t.from),to:Z(t.to)}}:{reason:`${e}-day`,details:Z(t)}}function oe(e,t,n){return e.from!==void 0?{from:X.value(e.from,t,n),to:X.value(e.to,t,n)}:X.value(e,t,n)}function De(e){let t;if(a.multiple===!0)if(e.from!==void 0){const n=K(e.from),o=K(e.to),l=d.value.filter(u=>u.dateHash<n||u.dateHash>o),_=F.value.filter(({from:u,to:m})=>m.dateHash<n||u.dateHash>o);t=l.concat(_).concat(e).map(u=>oe(u))}else{const n=se.value.slice();n.push(oe(e)),t=n}else t=oe(e);Ae(t,"add",e)}function we(e){if(a.noUnset===!0)return;let t=null;if(a.multiple===!0&&Array.isArray(a.modelValue)===!0){const n=oe(e);e.from!==void 0?t=a.modelValue.filter(o=>o.from!==void 0?o.from!==n.from&&o.to!==n.to:!0):t=a.modelValue.filter(o=>o!==n),t.length===0&&(t=null)}Ae(t,"remove",e)}function ze(e,t,n){const o=d.value.concat(F.value).map(l=>oe(l,e,t)).filter(l=>l.from!==void 0?l.from.dateHash!==null&&l.to.dateHash!==null:l.dateHash!==null);g("update:modelValue",(a.multiple===!0?o:o[0])||null,n)}function ct(){if(a.minimal!==!0)return r("div",{class:"q-date__header "+I.value},[r("div",{class:"relative-position"},[r(de,{name:"q-transition--fade"},()=>r("div",{key:"h-yr-"+pe.value,class:"q-date__header-subtitle q-date__header-link "+(V.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:y.value,...D("vY",{onClick(){V.value="Years"},onKeyup(e){e.keyCode===13&&(V.value="Years")}})},[pe.value]))]),r("div",{class:"q-date__header-title relative-position flex no-wrap"},[r("div",{class:"relative-position col"},[r(de,{name:"q-transition--fade"},()=>r("div",{key:"h-sub"+Ve.value,class:"q-date__header-title-label q-date__header-link "+(V.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:y.value,...D("vC",{onClick(){V.value="Calendar"},onKeyup(e){e.keyCode===13&&(V.value="Calendar")}})},[Ve.value]))]),a.todayBtn===!0?r(Q,{class:"q-date__header-today self-start",icon:h.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:y.value,onClick:Ye}):null])])}function qe({label:e,type:t,key:n,dir:o,goTo:l,boundaries:_,cls:u}){return[r("div",{class:"row items-center q-date__arrow"},[r(Q,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[0],tabindex:y.value,disable:_.prev===!1,...D("go-#"+t,{onClick(){l(-1)}})})]),r("div",{class:"relative-position overflow-hidden flex flex-center"+u},[r(de,{name:"q-transition--jump-"+o},()=>r("div",{key:n},[r(Q,{flat:!0,dense:!0,noCaps:!0,label:e,tabindex:y.value,...D("view#"+t,{onClick:()=>{V.value=t}})})]))]),r("div",{class:"row items-center q-date__arrow"},[r(Q,{round:!0,dense:!0,size:"sm",flat:!0,icon:fe.value[1],tabindex:y.value,disable:_.next===!1,...D("go+#"+t,{onClick(){l(1)}})})])]}const dt={Calendar:()=>[r("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[r("div",{class:"q-date__navigation row items-center no-wrap"},qe({label:x.value.months[s.value.month-1],type:"Months",key:s.value.month,dir:H.value,goTo:Ne,boundaries:be.value.month,cls:" col"}).concat(qe({label:s.value.year,type:"Years",key:s.value.year,dir:E.value,goTo:Ce,boundaries:be.value.year,cls:""}))),r("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Ge.value.map(e=>r("div",{class:"q-date__calendar-item"},[r("div",e)]))),r("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[r(de,{name:"q-transition--slide-"+H.value},()=>r("div",{key:z.value,class:"q-date__calendar-days fit"},Oe.value.map(e=>r("div",{class:e.classes},[e.in===!0?r(Q,{class:e.today===!0?"q-date__today":"",dense:!0,flat:e.flat,unelevated:e.unelevated,color:e.color,textColor:e.textColor,label:e.i,tabindex:y.value,...D("day#"+e.i,{onClick:()=>{vt(e.i)},onMouseover:()=>{ft(e.i)}})},e.event!==!1?()=>r("div",{class:"q-date__event bg-"+e.event}):null):r("div",""+e.i)]))))])])],Months(){const e=s.value.year===M.value.year,t=o=>N.value!==null&&s.value.year===N.value.year&&N.value.month>o||A.value!==null&&s.value.year===A.value.year&&A.value.month<o,n=x.value.monthsShort.map((o,l)=>{const _=s.value.month===l+1;return r("div",{class:"q-date__months-item flex flex-center"},[r(Q,{class:e===!0&&M.value.month===l+1?"q-date__today":null,flat:_!==!0,label:o,unelevated:_,color:_===!0?B.value:null,textColor:_===!0?$.value:null,tabindex:y.value,disable:t(l+1),...D("month#"+l,{onClick:()=>{it(l+1)}})})])});return a.yearsInMonthView===!0&&n.unshift(r("div",{class:"row no-wrap full-width"},[qe({label:s.value.year,type:"Years",key:s.value.year,dir:E.value,goTo:Ce,boundaries:be.value.year,cls:" col"})])),r("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const e=S.value,t=e+ee,n=[],o=l=>N.value!==null&&N.value.year>l||A.value!==null&&A.value.year<l;for(let l=e;l<=t;l++){const _=s.value.year===l;n.push(r("div",{class:"q-date__years-item flex flex-center"},[r(Q,{key:"yr"+l,class:M.value.year===l?"q-date__today":null,flat:!_,label:l,dense:!0,unelevated:_,color:_===!0?B.value:null,textColor:_===!0?$.value:null,tabindex:y.value,disable:o(l),...D("yr#"+l,{onClick:()=>{rt(l)}})})]))}return r("div",{class:"q-date__view q-date__years flex flex-center"},[r("div",{class:"col-auto"},[r(Q,{round:!0,dense:!0,flat:!0,icon:fe.value[0],tabindex:y.value,disable:o(e),...D("y-",{onClick:()=>{S.value-=ee}})})]),r("div",{class:"q-date__years-content col self-stretch row items-center"},n),r("div",{class:"col-auto"},[r(Q,{round:!0,dense:!0,flat:!0,icon:fe.value[1],tabindex:y.value,disable:o(t),...D("y+",{onClick:()=>{S.value+=ee}})})])])}};function vt(e){const t={...s.value,day:e};if(a.range===!1){st(t,z.value);return}if(p.value===null){const n=Oe.value.find(l=>l.fill!==!0&&l.i===e);if(a.noUnset!==!0&&n.range!==void 0){we({target:t,from:n.range.from,to:n.range.to});return}if(n.selected===!0){we(t);return}const o=K(t);p.value={init:t,initHash:o,final:t,finalHash:o},g("rangeStart",Z(t))}else{const n=p.value.initHash,o=K(t),l=n<=o?{from:p.value.init,to:t}:{from:t,to:p.value.init};p.value=null,De(n===o?t:{target:t,...l}),g("rangeEnd",{from:Z(l.from),to:Z(l.to)})}}function ft(e){if(p.value!==null){const t={...s.value,day:e};Object.assign(p.value,{final:t,finalHash:K(t)})}}return Object.assign(k,{setToday:Ye,setView:lt,offsetCalendar:ot,setCalendarTo:_e,setEditingRange:ut}),()=>{const e=[r("div",{class:"q-date__content col relative-position"},[r(de,{name:"q-transition--fade"},dt[V.value])])],t=mt(f.default);return t!==void 0&&e.push(r("div",{class:"q-date__actions"},t)),a.name!==void 0&&a.disable!==!0&&J(e,"push"),r("div",{class:ve.value,...nt.value},[ct(),r("div",{ref:R,class:"q-date__main col column",tabindex:-1},e)])}}}),ua=ke({name:"QPopupProxy",props:{...Yt,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(a,{slots:f,emit:g,attrs:k}){const{proxy:h}=ye(),{$q:q}=h,D=T(!1),y=T(null),I=i(()=>parseInt(a.breakpoint,10)),{canShow:P}=Tt({showing:D});function j(){return q.screen.width<I.value||q.screen.height<I.value?"dialog":"menu"}const O=T(j()),L=i(()=>O.value==="menu"?{maxHeight:"99vh"}:{});te(()=>j(),c=>{D.value!==!0&&(O.value=c)});function J(c){D.value=!0,g("show",c)}function R(c){D.value=!1,O.value=j(),g("hide",c)}return Object.assign(h,{show(c){P(c)===!0&&y.value.show(c)},hide(c){y.value.hide(c)},toggle(c){y.value.toggle(c)}}),We(h,"currentComponent",()=>({type:O.value,ref:y.value})),()=>{const c={ref:y,...L.value,...k,onShow:J,onHide:R};let x;return O.value==="dialog"?x=Et:(x=It,Object.assign(c,{target:a.target,contextMenu:a.contextMenu,noParentEvent:!0,separateClosePopup:!0})),r(x,c,f.default)}}});function re(a,f,g,k){const h=[];return a.forEach(q=>{k(q)===!0?h.push(q):f.push({failedPropValidation:g,file:q})}),h}function ge(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),Ke(a)}const Ut={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Jt=["rejected"];function Xt({editable:a,dnd:f,getFileInput:g,addFilesToQueue:k}){const{props:h,emit:q,proxy:D}=ye(),y=T(null),I=i(()=>h.accept!==void 0?h.accept.split(",").map(v=>(v=v.trim(),v==="*"?"*/":(v.endsWith("/*")&&(v=v.slice(0,v.length-1)),v.toUpperCase()))):null),P=i(()=>parseInt(h.maxFiles,10)),j=i(()=>parseInt(h.maxTotalSize,10));function O(v){if(a.value)if(v!==Object(v)&&(v={target:null}),v.target!==null&&v.target.matches('input[type="file"]')===!0)v.clientX===0&&v.clientY===0&&gt(v);else{const M=g();M&&M!==v.target&&M.click(v)}}function L(v){a.value&&v&&k(null,v)}function J(v,M,s,V){let b=Array.from(M||v.target.files);const H=[],E=()=>{H.length>0&&q("rejected",H)};if(h.accept!==void 0&&I.value.indexOf("*/")===-1&&(b=re(b,H,"accept",C=>I.value.some(S=>C.type.toUpperCase().startsWith(S)||C.name.toUpperCase().endsWith(S))),b.length===0))return E();if(h.maxFileSize!==void 0){const C=parseInt(h.maxFileSize,10);if(b=re(b,H,"max-file-size",S=>S.size<=C),b.length===0)return E()}if(h.multiple!==!0&&b.length>0&&(b=[b[0]]),b.forEach(C=>{C.__key=C.webkitRelativePath+C.lastModified+C.name+C.size}),V===!0){const C=s.map(S=>S.__key);b=re(b,H,"duplicate",S=>C.includes(S.__key)===!1)}if(b.length===0)return E();if(h.maxTotalSize!==void 0){let C=V===!0?s.reduce((S,p)=>S+p.size,0):0;if(b=re(b,H,"max-total-size",S=>(C+=S.size,C<=j.value)),b.length===0)return E()}if(typeof h.filter=="function"){const C=h.filter(b);b=re(b,H,"filter",S=>C.includes(S))}if(h.maxFiles!==void 0){let C=V===!0?s.length:0;if(b=re(b,H,"max-files",()=>(C++,C<=P.value)),b.length===0)return E()}if(E(),b.length>0)return b}function R(v){ge(v),f.value!==!0&&(f.value=!0)}function c(v){Ke(v),(v.relatedTarget!==null||yt.is.safari!==!0?v.relatedTarget!==y.value:document.elementsFromPoint(v.clientX,v.clientY).includes(y.value)===!1)===!0&&(f.value=!1)}function x(v){ge(v);const M=v.dataTransfer.files;M.length>0&&k(null,M),f.value=!1}function ie(v){if(f.value===!0)return r("div",{ref:y,class:`q-${v}__dnd absolute-full`,onDragenter:ge,onDragover:ge,onDragleave:c,onDrop:x})}return Object.assign(D,{pickFiles:O,addFiles:L}),{pickFiles:O,addFiles:L,onDragover:R,onDragleave:c,processFiles:J,getDndNode:ie,maxFilesNumber:P,maxTotalSizeNumber:j}}var ra=ke({name:"QFile",inheritAttrs:!1,props:{...Mt,...Ue,...Ut,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...St,...Jt],setup(a,{slots:f,emit:g,attrs:k}){const{proxy:h}=ye(),q=Ft(),D=T(null),y=T(!1),I=kt(a),{pickFiles:P,onDragover:j,onDragleave:O,processFiles:L,getDndNode:J}=Xt({editable:q.editable,dnd:y,getFileInput:ve,addFilesToQueue:B}),R=$t(a),c=i(()=>Object(a.modelValue)===a.modelValue?"length"in a.modelValue?Array.from(a.modelValue):[a.modelValue]:[]),x=i(()=>Be(c.value)),ie=i(()=>c.value.map(d=>d.name).join(", ")),v=i(()=>Pt(c.value.reduce((d,F)=>d+F.size,0))),M=i(()=>({totalSize:v.value,filesNumber:c.value.length,maxFiles:a.maxFiles})),s=i(()=>({tabindex:-1,type:"file",title:"",accept:a.accept,capture:a.capture,name:I.value,...k,id:q.targetUid.value,disabled:q.editable.value!==!0})),V=i(()=>"q-file q-field--auto-height"+(y.value===!0?" q-file--dnd":"")),b=i(()=>a.multiple===!0&&a.append===!0);function H(d){const F=c.value.slice();F.splice(d,1),C(F)}function E(d){const F=c.value.findIndex(d);F>-1&&H(F)}function C(d){g("update:modelValue",a.multiple===!0?d:d[0])}function S(d){d.keyCode===13&&bt(d)}function p(d){(d.keyCode===13||d.keyCode===32)&&P(d)}function ve(){return D.value}function B(d,F){const Y=L(d,F,c.value,b.value),X=ve();X!=null&&(X.value=""),Y!==void 0&&((a.multiple===!0?a.modelValue&&Y.every(G=>c.value.includes(G)):a.modelValue===Y[0])||C(b.value===!0?c.value.concat(Y):Y))}function $(){return[r("input",{class:[a.inputClass,"q-file__filler"],style:a.inputStyle})]}function ne(){if(f.file!==void 0)return c.value.length===0?$():c.value.map((F,Y)=>f.file({index:Y,file:F,ref:this}));if(f.selected!==void 0)return c.value.length===0?$():f.selected({files:c.value,ref:this});if(a.useChips===!0)return c.value.length===0?$():c.value.map((F,Y)=>r(zt,{key:"file-"+Y,removable:q.editable.value,dense:!0,textColor:a.color,tabindex:a.tabindex,onRemove:()=>{H(Y)}},()=>r("span",{class:"ellipsis",textContent:F.name})));const d=a.displayValue!==void 0?a.displayValue:ie.value;return d.length>0?[r("div",{class:a.inputClass,style:a.inputStyle,textContent:d})]:$()}function se(){const d={ref:D,...s.value,...R.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:B};return a.multiple===!0&&(d.multiple=!0),r("input",d)}return Object.assign(q,{fieldClass:V,emitValue:C,hasValue:x,inputRef:D,innerValue:c,floatingLabel:i(()=>x.value===!0||Be(a.displayValue)),computedCounter:i(()=>{if(a.counterLabel!==void 0)return a.counterLabel(M.value);const d=a.maxFiles;return`${c.value.length}${d!==void 0?" / "+d:""} (${v.value})`}),getControlChild:()=>J("file"),getControl:()=>{const d={ref:q.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:a.tabindex};return q.editable.value===!0&&Object.assign(d,{onDragover:j,onDragleave:O,onKeydown:S,onKeyup:p}),r("div",d,[se()].concat(ne()))}}),Object.assign(h,{removeAtIndex:H,removeFile:E,getNativeElement:()=>D.value}),We(h,"nativeEl",()=>D.value),Vt(q)}});function Le(a){if(a===!1)return 0;if(a===!0||a===void 0)return 1;const f=parseInt(a,10);return isNaN(f)?0:f}var ia=_t({name:"close-popup",beforeMount(a,{value:f}){const g={depth:Le(f),handler(k){g.depth!==0&&setTimeout(()=>{const h=Nt(a);h!==void 0&&At(h,k,g.depth)})},handlerKey(k){xt(k,13)===!0&&g.handler(k)}};a.__qclosepopup=g,a.addEventListener("click",g.handler),a.addEventListener("keyup",g.handlerKey)},updated(a,{value:f,oldValue:g}){f!==g&&(a.__qclosepopup.depth=Le(f))},beforeUnmount(a){const f=a.__qclosepopup;a.removeEventListener("click",f.handler),a.removeEventListener("keyup",f.handlerKey),delete a.__qclosepopup}});export{ia as C,ua as Q,oa as a,ra as b};
