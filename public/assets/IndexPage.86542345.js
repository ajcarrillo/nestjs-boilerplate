import{j as q,N as y,r as A,c as w,p as S,k as N,l as a,d as e,u as c,X as g,aH as M,_ as h,s as I}from"./index.c6535512.js";import{Q as L,a as _}from"./QForm.866d1cbd.js";import{Q as T}from"./QTd.daad9830.js";import{T as B,Q as z}from"./QTable.25e693b7.js";import{u as K,a as F,b as U,Q as $}from"./QChip.b9af2c8a.js";import{A as Q}from"./AreaResource.6f3e1c6c.js";import{l as b}from"./layout.7b62d204.js";import{Q as D,a as C,b as V}from"./QItemLabel.05af1820.js";import{c as H}from"./index.7adaf3a2.js";import{C as P}from"./CardForm.355d16b8.js";import"./focus-manager.33224ae2.js";import"./QCard.5e2e9fe0.js";import"./use-dark.23b804b4.js";import"./QPage.508d9960.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./format.e5167fe8.js";import"./scroll.883daedc.js";import"./utils.esm.588a85b6.js";import"./index.2cf0d985.js";import"./QCardActions.76db5bf9.js";const j=async()=>{const{data:t}=await Q.getAreas();return t},G=async t=>{const{data:r}=await Q.storeArea(t);return r},R=async t=>{const{id:r,description:l,alias:n}=t,{data:o}=await Q.updateArea(r,{description:l,alias:n});return o},X=()=>{const{isLoading:t,isError:r,data:l,error:n}=K({queryKey:["areas"],queryFn:j,staleTime:6e5});return{isLoading:t,isError:r,data:l,error:n}},J=()=>{const t=F();return{areaStoreMutations:U({mutationFn:G,onSuccess:()=>{t.invalidateQueries({queryKey:["areas"]}),b.showSuccessNotification("\xC1rea creada con \xE9xito")},onError:()=>{b.showErrorNotification("Error al crear \xE1rea")}})}},O=()=>{const t=F();return{areaUpdateMutations:U({mutationFn:R,onSuccess:()=>{t.invalidateQueries({queryKey:["areas"]}),b.showSuccessNotification("\xC1rea actualizada con \xE9xito")},onError:()=>{b.showErrorNotification("Error al actualizar \xE1rea")}})}},W=q({__name:"AreaForm",props:{area:null},setup(t){const r=t,{areaStoreMutations:l}=J(),{isLoading:n}=l,{areaUpdateMutations:o}=O(),{isLoading:f}=o,v=y({description:"",alias:""}),s=y(H(r.area||v)),m=A(),u={description:[x=>!!x||"El nombre es requerido"]},i=w(()=>r.area&&"id"in r.area),E=w(()=>i.value?"Editar \xE1rea":"Agregar \xE1rea");async function k(){var d,p;!await((d=m.value)==null?void 0:d.validate())||(i.value?await o.mutateAsync(s):(await l.mutateAsync(s),s.description="",s.alias="",(p=m.value)==null||p.reset()))}return(x,d)=>(S(),N(P,{title:c(E)},{form:a(()=>[e(c(L),{ref_key:"areaForm",ref:m,class:"q-gutter-md"},{default:a(()=>[e(D,null,{default:a(()=>[e(C,null,{default:a(()=>[e(V,null,{default:a(()=>[e(_,{modelValue:s.description,"onUpdate:modelValue":d[0]||(d[0]=p=>s.description=p),dense:"",label:"Nombre",outlined:"",rules:u.description},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(V,null,{default:a(()=>[e(_,{modelValue:s.alias,"onUpdate:modelValue":d[1]||(d[1]=p=>s.alias=p),dense:"",label:"Alias",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),actions:a(()=>[e(g,{color:"primary",label:"Guardar",loading:c(n)||c(f),onClick:k},null,8,["loading"])]),_:1},8,["title"]))}}),Y={class:"q-gutter-sm"},xe=q({__name:"IndexPage",setup(t){const{data:r,isLoading:l}=X(),n=A(""),o=A(!1);let f=y({description:"",alias:""});const v=[{name:"id",field:"id",required:!0,label:"ID",sortable:!0,align:"left"},{name:"description",field:"description",label:"Nombre",sortable:!0,align:"left"},{name:"alias",field:"alias",label:"Alias",sortable:!1,align:"left"},{name:"action",align:"center",label:"Acciones",field:"action",sortable:!1}];M(()=>{o.value||(f=y({description:"",alias:""}))});function s(m){o.value=!0,f=m}return(m,u)=>(S(),N(B,null,{"card-body":a(()=>[e(z,{columns:v,loading:c(l),rows:c(r),"rows-per-page-options":[20,30,40,50],title:"\xC1reas"},{"top-right":a(()=>[e(g,{class:"q-mr-xs",color:"primary",icon:"add",label:"Nueva \xC1rea",outline:"",onClick:u[0]||(u[0]=i=>o.value=!0)}),e(_,{modelValue:n.value,"onUpdate:modelValue":u[1]||(u[1]=i=>n.value=i),class:"q-mr-xs",debounce:"300",dense:"",outlined:"",placeholder:"Search"},{append:a(()=>[e(h,{name:"search"})]),_:1},8,["modelValue"]),e(g,{color:"primary","icon-right":"archive",label:"Exportar CSV","no-caps":""})]),"body-cell-action":a(i=>[e(T,{props:i},{default:a(()=>[I("div",Y,[e(g,{color:"primary",dense:"",flat:"",icon:"edit",rounded:"",size:"sm",onClick:E=>s(i.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["loading","rows"])]),footer:a(()=>[e($,{modelValue:o.value,"onUpdate:modelValue":u[2]||(u[2]=i=>o.value=i)},{default:a(()=>[e(W,{area:c(f)},null,8,["area"])]),_:1},8,["modelValue"])]),_:1}))}});export{xe as default};
