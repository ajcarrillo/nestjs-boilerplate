import{j as F,N as g,r as _,c as w,p as E,k as V,l as e,d as t,u,X as y,aH as h,_ as k,s as U}from"./index.764f91da.js";import{Q as M,a as C}from"./QForm.249823eb.js";import{Q as I,a as L}from"./QTable.c2f3088c.js";import{u as T,a as q,b as S,Q as B}from"./QChip.24db411d.js";import{T as z}from"./TablePage.fad92f6b.js";import{Q as K,a as $}from"./QItemLabel.aeee3940.js";import{Q as D}from"./QList.c3267100.js";import{A as x}from"./ActionResource.4c3135ec.js";import{l as A}from"./layout.885dabeb.js";import{c as H}from"./index.7adaf3a2.js";import{C as P}from"./CardForm.362d4219.js";import"./focus-manager.33224ae2.js";import"./format.5c717855.js";import"./use-dark.8941baf2.js";import"./scroll.7eebca94.js";import"./QSelect.2dbe0ba1.js";import"./QCheckbox.47de988e.js";import"./utils.esm.73bc7e0b.js";import"./QCard.85e6f4b4.js";import"./QPage.1fc2c1b7.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./index.2cf0d985.js";import"./QCardActions.c423be21.js";const j=async()=>{const{data:o}=await x.getActions();return o},G=async o=>{const{data:a}=await x.storeAction(o);return a},R=async o=>{const{id:a,name:i}=o,{data:r}=await x.updateAction(a,{name:i});return r},X=()=>{const{isLoading:o,isError:a,data:i,error:r}=T({queryKey:["actions"],queryFn:j,staleTime:6e5});return{isLoading:o,isError:a,data:i,error:r}},J=()=>{const o=q();return{actionStoreMutations:S({mutationFn:G,onSuccess:()=>{o.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n creada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al crear acci\xF3n")}})}},O=()=>{const o=q();return{actionUpdateMutations:S({mutationFn:R,onSuccess:()=>{o.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n actualizada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al actualizar acci\xF3n")}})}},W=F({__name:"ActionForm",props:{action:null},setup(o){const a=o,{actionStoreMutations:i}=J(),{isLoading:r}=i,{actionUpdateMutations:s}=O(),{isLoading:d}=s,b=g({name:""}),l=g(H(a.action||b)),m=_(),c={name:[v=>!!v||"El nombre es requerido"]},n=w(()=>a.action&&"id"in a.action),Q=w(()=>n.value?"Editar acci\xF3n":"Agregar acci\xF3n");async function N(){var p,f;!await((p=m.value)==null?void 0:p.validate())||(n.value?await s.mutateAsync(l):(await i.mutateAsync(l),l.name="",(f=m.value)==null||f.reset()))}return(v,p)=>(E(),V(P,{title:u(Q)},{form:e(()=>[t(u(M),{ref_key:"actionForm",ref:m,class:"q-gutter-md"},{default:e(()=>[t(D,null,{default:e(()=>[t(K,null,{default:e(()=>[t($,null,{default:e(()=>[t(C,{modelValue:l.name,"onUpdate:modelValue":p[0]||(p[0]=f=>l.name=f),dense:"",label:"Nombre",outlined:"",rules:c.name},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),actions:e(()=>[t(y,{color:"primary",label:"Guardar",loading:u(r)||u(d),onClick:N},null,8,["loading"])]),_:1},8,["title"]))}}),Y={class:"q-gutter-sm"},Qt=F({__name:"IndexPage",setup(o){const{data:a,isLoading:i}=X(),r=_(""),s=_(!1);let d=g({name:""});const b=[{name:"id",field:"id",required:!0,label:"ID",sortable:!0,align:"left"},{name:"name",field:"name",label:"Nombre",sortable:!0,align:"left"},{name:"action",align:"center",label:"Acciones",field:"action",sortable:!1}];h(()=>{s.value||(d=g({name:""}))});function l(m){s.value=!0,d=m}return(m,c)=>(E(),V(z,null,{"card-body":e(()=>[t(L,{columns:b,loading:u(i),rows:u(a),"rows-per-page-options":[20,30,40,50],title:"Acciones"},{"top-right":e(()=>[t(y,{class:"q-mr-xs",color:"primary",icon:"add",label:"Nueva Acci\xF3n",outline:"",onClick:c[0]||(c[0]=n=>s.value=!0)}),t(C,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=n=>r.value=n),class:"q-mr-xs",debounce:"300",dense:"",outlined:"",placeholder:"Search"},{append:e(()=>[t(k,{name:"search"})]),_:1},8,["modelValue"]),t(y,{color:"primary","icon-right":"archive",label:"Exportar CSV","no-caps":""})]),"body-cell-action":e(n=>[t(I,{props:n},{default:e(()=>[U("div",Y,[t(y,{color:"primary",dense:"",flat:"",icon:"edit",rounded:"",size:"sm",onClick:Q=>l(n.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["loading","rows"])]),footer:e(()=>[t(B,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=n=>s.value=n)},{default:e(()=>[t(W,{action:u(d)},null,8,["action"])]),_:1},8,["modelValue"])]),_:1}))}});export{Qt as default};
