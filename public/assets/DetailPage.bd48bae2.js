import{y as Se,r as _,c as M,z as Xe,o as Tt,i as Vt,ah as xe,aS as Mt,h as S,b0 as Ye,a5 as je,ar as kt,a7 as Dt,_ as oe,N as Ze,g as Me,aY as Pt,v as ye,w as Y,E as Qt,D as St,x as ge,H as Bt,ai as et,O as tt,b1 as At,j as Ie,V as at,m as $e,M as lt,p as G,k as ie,l as n,d as t,q as K,t as Q,u as N,b as ot,s as y,aH as It,ap as $t,b2 as Lt,ag as ve,F as be,an as he,X as ae,b3 as Oe}from"./index.e80209f7.js";import{u as Rt,p as Ne}from"./planeacion.api.11872094.js";import{Q as Et}from"./QResizeObserver.7679a873.js";import{j as Be,c as Ke,a as le,Q as Ft}from"./format.409cdf28.js";import{r as Ut,b as zt,Q as fe}from"./QSelect.91f23f70.js";import{Q as We}from"./QTooltip.79a33578.js";import{a as _e,b as pe,Q as Le}from"./QItemLabel.f32247a6.js";import{Q as jt}from"./QToggle.c6861ec7.js";import{Q as Ot}from"./QList.c86c30fc.js";import{Q as re,l as Te}from"./layout.50bbef5d.js";import{Q as Nt}from"./QBtnGroup.978fb4bb.js";import{a as Kt,Q as ce}from"./QTable.dae4da34.js";import{Q as Wt,a as He}from"./QTr.e2773879.js";import{u as Ht,a as Gt,b as Jt,c as Xt}from"./use-panel.74a62ccc.js";import{u as nt,a as it}from"./use-dark.0aa077e8.js";import{T as Yt}from"./TouchPan.8b41c826.js";import{Q as Ve}from"./QCardSection.f8679c73.js";import{Q as rt}from"./QCardActions.2ef66417.js";import{Q as ut}from"./QCard.6c844bf8.js";import{a as st,Q as Zt}from"./QChip.c85dbe45.js";import{Q as ea}from"./QPage.8040596a.js";import{C as Ae}from"./ClosePopup.6ee45768.js";import{b as ta}from"./useBudgets.b66093d4.js";import{T as aa}from"./TablePage.2fc145fe.js";import{Q as la}from"./QForm.8e1d928a.js";import{Q as oa}from"./QSpace.7a58004c.js";import{u as ct}from"./useDictionaries.9a3a5fbf.js";import{c as dt}from"./index.7adaf3a2.js";import{_ as na}from"./plugin-vue_export-helper.21dcd24c.js";import{u as ia,a as ra}from"./useBudgetDetail.2b7d4b8d.js";import{u as ua}from"./useMoney.dbc60660.js";import{u as sa}from"./useExportDataToCsv.1d622e22.js";import{u as ca}from"./useTableFilter.3ac891f1.js";import{u as mt}from"./useMutation.esm.337bf2db.js";import"./index.2cf0d985.js";import"./scroll.7506c226.js";import"./QCheckbox.83297780.js";import"./touch.70a9dd44.js";import"./utils.esm.81184f94.js";import"./app.ed4ed52c.js";import"./ArticleResource.6e8964e4.js";import"./date.6c4106c7.js";import"./mutation.esm.bab4c0d3.js";let da=0;const ma=["click","keydown"],fa={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${da++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function va(e,v,d,u){const c=Vt(Ye,Se);if(c===Se)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Se;const{proxy:x}=Me(),T=_(null),B=_(null),A=_(null),z=M(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),P=M(()=>c.currentModel.value===e.name),J=M(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(P.value===!0?" q-tab--active"+(c.tabProps.value.activeClass?" "+c.tabProps.value.activeClass:"")+(c.tabProps.value.activeColor?` text-${c.tabProps.value.activeColor}`:"")+(c.tabProps.value.activeBgColor?` bg-${c.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&c.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||c.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(u!==void 0?u.linkClass.value:"")),E=M(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(c.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),s=M(()=>e.disable===!0||c.hasFocus.value===!0||P.value===!1&&c.hasActiveTab.value===!0?-1:e.tabindex||0);function w(f,g){if(g!==!0&&T.value!==null&&T.value.focus(),e.disable===!0){u!==void 0&&u.hasRouterLink.value===!0&&je(f);return}if(u===void 0){c.updateModel({name:e.name}),d("click",f);return}if(u.hasRouterLink.value===!0){const l=(o={})=>{let V;const L=o.to===void 0||Pt(o.to,e.to)===!0?c.avoidRouteWatcher=Rt():null;return u.navigateToRouterLink(f,{...o,returnRouterError:!0}).catch(O=>{V=O}).then(O=>{if(L===c.avoidRouteWatcher&&(c.avoidRouteWatcher=!1,V===void 0&&(O===void 0||O.message.startsWith("Avoided redundant navigation")===!0)&&c.updateModel({name:e.name})),o.returnRouterError===!0)return V!==void 0?Promise.reject(V):O})};d("click",f,l),f.defaultPrevented!==!0&&l();return}d("click",f)}function I(f){kt(f,[13,32])?w(f,!0):Dt(f)!==!0&&f.keyCode>=35&&f.keyCode<=40&&f.altKey!==!0&&f.metaKey!==!0&&c.onKbdNavigate(f.keyCode,x.$el)===!0&&je(f),d("keydown",f)}function W(){const f=c.tabProps.value.narrowIndicator,g=[],l=S("div",{ref:A,class:["q-tab__indicator",c.tabProps.value.indicatorClass]});e.icon!==void 0&&g.push(S(oe,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&g.push(S("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&g.push(e.alertIcon!==void 0?S(oe,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):S("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),f===!0&&g.push(l);const o=[S("div",{class:"q-focus-helper",tabindex:-1,ref:T}),S("div",{class:E.value},Ze(v.default,g))];return f===!1&&o.push(l),o}const $={name:M(()=>e.name),rootRef:B,tabIndicatorRef:A,routeData:u};Xe(()=>{c.unregisterTab($)}),Tt(()=>{c.registerTab($)});function j(f,g){const l={ref:B,class:J.value,tabindex:s.value,role:"tab","aria-selected":P.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:w,onKeydown:I,...g};return xe(S(f,l,W()),[[Mt,z.value]])}return{renderTab:j,$tabs:c}}var Ge=ye({name:"QTab",props:fa,emits:ma,setup(e,{slots:v,emit:d}){const{renderTab:u}=va(e,v,d);return()=>u("div")}});function ba(e,v,d){const u=d===!0?["left","right"]:["top","bottom"];return`absolute-${v===!0?u[0]:u[1]}${e?` text-${e}`:""}`}const ha=["left","center","right","justify"];var ga=ye({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>ha.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:v,emit:d}){const{proxy:u}=Me(),{$q:c}=u,{registerTick:x}=Be(),{registerTick:T}=Be(),{registerTick:B}=Be(),{registerTimeout:A,removeTimeout:z}=Ke(),{registerTimeout:P,removeTimeout:J}=Ke(),E=_(null),s=_(null),w=_(e.modelValue),I=_(!1),W=_(!0),$=_(!1),j=_(!1),f=[],g=_(0),l=_(!1);let o=null,V=null,L;const O=M(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:ba(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),F=M(()=>{const a=g.value,r=w.value;for(let b=0;b<a;b++)if(f[b].name.value===r)return!0;return!1}),we=M(()=>`q-tabs__content--align-${I.value===!0?"left":j.value===!0?"justify":e.align}`),Z=M(()=>`q-tabs row no-wrap items-center q-tabs--${I.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),ke=M(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+we.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),ue=M(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),se=M(()=>e.vertical!==!0&&c.lang.rtl===!0),de=M(()=>Ut===!1&&se.value===!0);Y(se,i),Y(()=>e.modelValue,a=>{me({name:a,setCurrent:!0,skipEmit:!0})}),Y(()=>e.outsideArrows,ne);function me({name:a,setCurrent:r,skipEmit:b}){w.value!==a&&(b!==!0&&e["onUpdate:modelValue"]!==void 0&&d("update:modelValue",a),(r===!0||e["onUpdate:modelValue"]===void 0)&&(De(w.value,a),w.value=a))}function ne(){x(()=>{Ce({width:E.value.offsetWidth,height:E.value.offsetHeight})})}function Ce(a){if(ue.value===void 0||s.value===null)return;const r=a[ue.value.container],b=Math.min(s.value[ue.value.scroll],Array.prototype.reduce.call(s.value.children,(D,q)=>D+(q[ue.value.content]||0),0)),k=r>0&&b>r;I.value=k,k===!0&&T(i),j.value=r<parseInt(e.breakpoint,10)}function De(a,r){const b=a!=null&&a!==""?f.find(D=>D.name.value===a):null,k=r!=null&&r!==""?f.find(D=>D.name.value===r):null;if(b&&k){const D=b.tabIndicatorRef.value,q=k.tabIndicatorRef.value;o!==null&&(clearTimeout(o),o=null),D.style.transition="none",D.style.transform="none",q.style.transition="none",q.style.transform="none";const p=D.getBoundingClientRect(),U=q.getBoundingClientRect();q.style.transform=e.vertical===!0?`translate3d(0,${p.top-U.top}px,0) scale3d(1,${U.height?p.height/U.height:1},1)`:`translate3d(${p.left-U.left}px,0,0) scale3d(${U.width?p.width/U.width:1},1,1)`,B(()=>{o=setTimeout(()=>{o=null,q.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",q.style.transform="none"},70)})}k&&I.value===!0&&ee(k.rootRef.value)}function ee(a){const{left:r,width:b,top:k,height:D}=s.value.getBoundingClientRect(),q=a.getBoundingClientRect();let p=e.vertical===!0?q.top-k:q.left-r;if(p<0){s.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(p),i();return}p+=e.vertical===!0?q.height-D:q.width-b,p>0&&(s.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(p),i())}function i(){const a=s.value;if(a===null)return;const r=a.getBoundingClientRect(),b=e.vertical===!0?a.scrollTop:Math.abs(a.scrollLeft);se.value===!0?(W.value=Math.ceil(b+r.width)<a.scrollWidth-1,$.value=b>0):(W.value=b>0,$.value=e.vertical===!0?Math.ceil(b+r.height)<a.scrollHeight:Math.ceil(b+r.width)<a.scrollWidth)}function C(a){V!==null&&clearInterval(V),V=setInterval(()=>{gt(a)===!0&&h()},5)}function R(){C(de.value===!0?Number.MAX_SAFE_INTEGER:0)}function m(){C(de.value===!0?0:Number.MAX_SAFE_INTEGER)}function h(){V!==null&&(clearInterval(V),V=null)}function H(a,r){const b=Array.prototype.filter.call(s.value.children,U=>U===r||U.matches&&U.matches(".q-tab.q-focusable")===!0),k=b.length;if(k===0)return;if(a===36)return ee(b[0]),b[0].focus(),!0;if(a===35)return ee(b[k-1]),b[k-1].focus(),!0;const D=a===(e.vertical===!0?38:37),q=a===(e.vertical===!0?40:39),p=D===!0?-1:q===!0?1:void 0;if(p!==void 0){const U=se.value===!0?-1:1,X=b.indexOf(r)+p*U;return X>=0&&X<k&&(ee(b[X]),b[X].focus({preventScroll:!0})),!0}}const ht=M(()=>de.value===!0?{get:a=>Math.abs(a.scrollLeft),set:(a,r)=>{a.scrollLeft=-r}}:e.vertical===!0?{get:a=>a.scrollTop,set:(a,r)=>{a.scrollTop=r}}:{get:a=>a.scrollLeft,set:(a,r)=>{a.scrollLeft=r}});function gt(a){const r=s.value,{get:b,set:k}=ht.value;let D=!1,q=b(r);const p=a<q?-1:1;return q+=p*5,q<0?(D=!0,q=0):(p===-1&&q<=a||p===1&&q>=a)&&(D=!0,q=a),k(r,q),i(),D}function Re(a,r){for(const b in a)if(a[b]!==r[b])return!1;return!0}function _t(){let a=null,r={matchedLen:0,queryDiff:9999,hrefLen:0};const b=f.filter(p=>p.routeData!==void 0&&p.routeData.hasRouterLink.value===!0),{hash:k,query:D}=u.$route,q=Object.keys(D).length;for(const p of b){const U=p.routeData.exact.value===!0;if(p.routeData[U===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:X,query:Pe,matched:qt,href:xt}=p.routeData.resolvedLink.value,Qe=Object.keys(Pe).length;if(U===!0){if(X!==k||Qe!==q||Re(D,Pe)===!1)continue;a=p.name.value;break}if(X!==""&&X!==k||Qe!==0&&Re(Pe,D)===!1)continue;const te={matchedLen:qt.length,queryDiff:q-Qe,hrefLen:xt.length-X.length};if(te.matchedLen>r.matchedLen){a=p.name.value,r=te;continue}else if(te.matchedLen!==r.matchedLen)continue;if(te.queryDiff<r.queryDiff)a=p.name.value,r=te;else if(te.queryDiff!==r.queryDiff)continue;te.hrefLen>r.hrefLen&&(a=p.name.value,r=te)}a===null&&f.some(p=>p.routeData===void 0&&p.name.value===w.value)===!0||me({name:a,setCurrent:!0})}function pt(a){if(z(),l.value!==!0&&E.value!==null&&a.target&&typeof a.target.closest=="function"){const r=a.target.closest(".q-tab");r&&E.value.contains(r)===!0&&(l.value=!0,I.value===!0&&ee(r))}}function yt(){A(()=>{l.value=!1},30)}function qe(){Fe.avoidRouteWatcher===!1?P(_t):J()}function Ee(){if(L===void 0){const a=Y(()=>u.$route.fullPath,qe);L=()=>{a(),L=void 0}}}function wt(a){f.push(a),g.value++,ne(),a.routeData===void 0||u.$route===void 0?P(()=>{if(I.value===!0){const r=w.value,b=r!=null&&r!==""?f.find(k=>k.name.value===r):null;b&&ee(b.rootRef.value)}}):(Ee(),a.routeData.hasRouterLink.value===!0&&qe())}function Ct(a){f.splice(f.indexOf(a),1),g.value--,ne(),L!==void 0&&a.routeData!==void 0&&(f.every(r=>r.routeData===void 0)===!0&&L(),qe())}const Fe={currentModel:w,tabProps:O,hasFocus:l,hasActiveTab:F,registerTab:wt,unregisterTab:Ct,verifyRouteModel:qe,updateModel:me,onKbdNavigate:H,avoidRouteWatcher:!1};Bt(Ye,Fe);function Ue(){o!==null&&clearTimeout(o),h(),L!==void 0&&L()}let ze;return Xe(Ue),Qt(()=>{ze=L!==void 0,Ue()}),St(()=>{ze===!0&&Ee(),ne()}),()=>S("div",{ref:E,class:Z.value,role:"tablist",onFocusin:pt,onFocusout:yt},[S(Et,{onResize:Ce}),S("div",{ref:s,class:ke.value,onScroll:i},ge(v.default)),S(oe,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(W.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||c.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:R,onTouchstartPassive:R,onMouseupPassive:h,onMouseleavePassive:h,onTouchendPassive:h}),S(oe,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+($.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||c.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:m,onTouchstartPassive:m,onMouseupPassive:h,onMouseleavePassive:h,onTouchendPassive:h})])}}),Je=ye({name:"QTabPanel",props:Ht,setup(e,{slots:v}){return()=>S("div",{class:"q-tab-panel",role:"tabpanel"},ge(v.default))}}),_a=ye({name:"QTabPanels",props:{...Gt,...nt},emits:Jt,setup(e,{slots:v}){const d=Me(),u=it(e,d.proxy.$q),{updatePanelsList:c,getPanelContent:x,panelDirectives:T}=Xt(),B=M(()=>"q-tab-panels q-panel-parent"+(u.value===!0?" q-tab-panels--dark q-dark":""));return()=>(c(v),et("div",{class:B.value},x(),"pan",e.swipeable,()=>T.value))}}),pa=ye({name:"QSplitter",props:{...nt,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:v,emit:d}){const{proxy:{$q:u}}=Me(),c=it(e,u),x=_(null),T={before:_(null),after:_(null)},B=M(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(c.value===!0?" q-splitter--dark":"")),A=M(()=>e.horizontal===!0?"height":"width"),z=M(()=>e.reverse!==!0?"before":"after"),P=M(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function J(l){return(e.unit==="%"?l:Math.round(l))+e.unit}const E=M(()=>({[z.value]:{[A.value]:J(e.modelValue)}}));let s,w,I,W,$;function j(l){if(l.isFirst===!0){const V=x.value.getBoundingClientRect()[A.value];s=e.horizontal===!0?"up":"left",w=e.unit==="%"?100:V,I=Math.min(w,P.value[1],Math.max(P.value[0],e.modelValue)),W=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:u.lang.rtl===!0?-1:1)*(e.unit==="%"?V===0?0:100/V:1),x.value.classList.add("q-splitter--active");return}if(l.isFinal===!0){$!==e.modelValue&&d("update:modelValue",$),x.value.classList.remove("q-splitter--active");return}const o=I+W*(l.direction===s?-1:1)*l.distance[e.horizontal===!0?"y":"x"];$=Math.min(w,P.value[1],Math.max(P.value[0],o)),T[z.value].value.style[A.value]=J($),e.emitImmediately===!0&&e.modelValue!==$&&d("update:modelValue",$)}const f=M(()=>[[Yt,j,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function g(l,o){l<o[0]?d("update:modelValue",o[0]):l>o[1]&&d("update:modelValue",o[1])}return Y(()=>e.modelValue,l=>{g(l,P.value)}),Y(()=>e.limits,()=>{tt(()=>{g(e.modelValue,P.value)})}),()=>{const l=[S("div",{ref:T.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:E.value.before},ge(v.before)),S("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[et("div",{class:"q-splitter__separator-area absolute-full"},ge(v.separator),"sep",e.disable!==!0,()=>f.value)]),S("div",{ref:T.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:E.value.after},ge(v.after))];return S("div",{class:B.value,ref:x},Ze(v.default,l))}}});const ft=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],ya=(e,v=0,d=!1)=>{let u;return(...c)=>{d&&!u&&e(...c),clearTimeout(u),u=setTimeout(()=>{e(...c)},v)}},wa=(e,v,d)=>{const u=_(e);return At((c,x)=>({get(){return c(),u.value},set:ya(T=>{u.value=T,x()},v,d)}))};const Ca={class:"self-center full-width no-outline",tabindex:"0"},qa=Ie({__name:"MonthBudgetForm",props:{month:null,budgetMonth:{default:()=>({quantity:0})},estimatedAmount:{default:0}},emits:["update:quantity"],setup(e,{emit:v}){const d=e;at();const u=$e(),{id:c}=u.params,x=lt(dt(d.budgetMonth)),T=wa(x.quantity||0,250,!1);return Y(T,B=>{B>=0&&(x.quantity=B,x.month=d.month,x.budget_detail_id=c,v("update:quantity",x))}),(B,A)=>(G(),ie(Le,{class:"month-container"},{default:n(()=>[t(_e,null,{default:n(()=>[t(pe,{overline:""},{default:n(()=>[K(Q(e.month),1)]),_:1}),t(re,{modelValue:N(T),"onUpdate:modelValue":A[0]||(A[0]=z=>ot(T)?T.value=z:null),modelModifiers:{number:!0},dense:"","input-class":"tw-text-right",label:"Cantidad",min:"0",outlined:"",type:"number"},null,8,["modelValue"])]),_:1}),t(_e,{side:""},{default:n(()=>[t(pe,{overline:""},{default:n(()=>[K("\xA0\xA0\xA0")]),_:1}),t(zt,{dense:"",label:"Total",outlined:"","stack-label":""},{control:n(()=>[y("div",Ca,Q(x.quantity*d.estimatedAmount),1)]),prepend:n(()=>[t(oe,{name:"o_attach_money"})]),_:1})]),_:1})]),_:1}))}});var vt=na(qa,[["__scopeId","data-v-5bd66e44"]]);const xa=y("div",{class:"tw-text-xl"},"Agregar bien",-1),Ta={class:"row q-col-gutter-md q-mb-md"},Va={class:"col col-md-2"},Ma={class:"col col-md-10"},ka={class:"row q-col-gutter-md q-mb-md"},Da={class:"col col-md-2"},Pa={class:"col col-md-10"},Qa={class:"row q-col-gutter-md q-mb-md"},Sa={class:"col"},Ba={class:"row q-col-gutter-md q-mb-md"},Aa={class:"col"},Ia={class:"col"},$a={class:"col"},La={class:"row"},Ra={class:"col"},Ea=Ie({__name:"BudgetDetailForm",setup(e){at();const v=$e(),{id:d}=v.params,{actionDictionary:u,lineDictionary:c,areaDictionary:x,getArticleByName:T}=ct(),{storeBudgetDetailMutation:B}=ia(),{isLoading:A}=B,z=_(u.value),P=_(c.value),J=_(x.value),E=_([]),s=lt({action:null,line:null,area:null,article:null,estimated_amount:0,justification:"",month:[],total:0,budgetMonths:[]}),w=_([]);It(()=>{if(w.value.length>0){const g=w.value.reduce((l,o)=>l+o.quantity,0);s.total=g*s.estimated_amount}});function I(g,l,o){l(()=>{const V=g.toLowerCase();J.value=x.value.filter(L=>L.label.toLowerCase().indexOf(V)>-1)})}function W(g,l,o){if(g.length<2){o();return}l(()=>{const V=g.toLowerCase();E.value=T(V).value})}function $(g){const l=w.value.findIndex(o=>o.month===g.month);l>-1?w.value[l]=g:w.value.push(g)}function j({value:g}){w.value=w.value.filter(l=>l.month!==g)}async function f(){s.budgetMonths=w.value,await B.mutateAsync({budgetId:d,budgetDetail:s}),s.action=null,s.line=null,s.area=null,s.article=null,s.estimated_amount=0,s.justification="",s.month=[],s.total=0,s.budgetMonths=[],w.value=[]}return(g,l)=>(G(),ie(ut,null,{default:n(()=>[t(Ve,null,{default:n(()=>[xa]),_:1}),t(le),t(Ve,null,{default:n(()=>[t(la,null,{default:n(()=>[y("div",Ta,[y("div",Va,[t(fe,{modelValue:s.action,"onUpdate:modelValue":l[0]||(l[0]=o=>s.action=o),dense:"",label:"ACC",options:z.value,outlined:""},null,8,["modelValue","options"])]),y("div",Ma,[t(fe,{modelValue:s.area,"onUpdate:modelValue":l[1]||(l[1]=o=>s.area=o),dense:"",label:"\xC1rea",options:J.value,outlined:"","use-input":"",onFilter:I},null,8,["modelValue","options"])])]),y("div",ka,[y("div",Da,[t(fe,{modelValue:s.line,"onUpdate:modelValue":l[2]||(l[2]=o=>s.line=o),dense:"",label:"Partida",options:P.value,outlined:""},null,8,["modelValue","options"])]),y("div",Pa,[t(fe,{modelValue:s.article,"onUpdate:modelValue":l[3]||(l[3]=o=>s.article=o),dense:"",hint:"M\xEDnimo 2 caracteres para activar el filtrado",label:"Art\xEDculos",options:E.value,outlined:"","use-input":"",onFilter:W},{option:n(o=>[t(Le,$t(Lt(o.itemProps)),{default:n(()=>[t(_e,null,{default:n(()=>[t(pe,null,{default:n(()=>[K(Q(o.opt.label),1)]),_:2},1024),t(pe,{caption:""},{default:n(()=>[K(Q(o.opt.caption),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])])]),y("div",Qa,[y("div",Sa,[t(re,{modelValue:s.justification,"onUpdate:modelValue":l[4]||(l[4]=o=>s.justification=o),dense:"",label:"Justificaci\xF3n",outlined:"",type:"textarea"},null,8,["modelValue"])])]),y("div",Ba,[y("div",Aa,[t(fe,{modelValue:s.month,"onUpdate:modelValue":l[5]||(l[5]=o=>s.month=o),dense:"",label:"Mes",multiple:"",options:N(ft),outlined:"","use-chips":"",onRemove:j},null,8,["modelValue","options"])]),y("div",Ia,[t(re,{modelValue:s.estimated_amount,"onUpdate:modelValue":l[6]||(l[6]=o=>s.estimated_amount=o),modelModifiers:{number:!0},dense:"","input-class":"tw-text-right",label:"Monto estimado",outlined:"",type:"number"},{prepend:n(()=>[t(oe,{name:"o_attach_money"})]),_:1},8,["modelValue"])]),y("div",$a,[t(re,{modelValue:s.total,"onUpdate:modelValue":l[7]||(l[7]=o=>s.total=o),dense:"","input-class":"tw-text-right",label:"Total",outlined:"",readonly:"",type:"number"},{prepend:n(()=>[t(oe,{name:"o_attach_money"})]),_:1},8,["modelValue"])])]),y("div",La,[y("div",Ra,[(G(!0),ve(be,null,he(s.month,o=>(G(),ie(vt,{key:o,"estimated-amount":s.estimated_amount,month:o,"onUpdate:quantity":$},null,8,["estimated-amount","month"]))),128))])])]),_:1})]),_:1}),t(le),t(rt,null,{default:n(()=>[t(oa),t(ae,{color:"primary",icon:"o_save",loading:N(A),unelevated:"",onClick:f},{default:n(()=>[K(" guardar ")]),_:1},8,["loading"])]),_:1})]),_:1}))}});var bt={create({budgetId:e,budgetDetailId:v,payload:d}){return Ne.post(`/budgets/${e}/budget-details/${v}/months`,d)},update({budgetId:e,budgetDetailId:v,BudgetDetailMonthId:d,payload:u}){return delete u.id,delete u.total,Ne.patch(`/budgets/${e}/budget-details/${v}/months/${d}`,u)}};const Fa=async({budgetId:e,budgetDetailId:v,payload:d})=>{const{data:u}=await bt.create({budgetId:e,budgetDetailId:v,payload:d});return u},Ua=async({budgetId:e,budgetDetailId:v,BudgetDetailMonthId:d,payload:u})=>{const{data:c}=await bt.update({budgetId:e,budgetDetailId:v,BudgetDetailMonthId:d,payload:u});return c},za=()=>{const e=st();return{storeBudgetDetailMonthMutation:mt({mutationFn:d=>Fa(d),onSuccess:async(d,u)=>{await e.invalidateQueries(["budget",u.budgetId]),Te.showSuccessNotification("El bien se agreg\xF3 al presupuesto con \xE9xito")},onError:()=>{Te.showErrorNotification("Error al agregar el bien al presupuesto")}})}},ja=()=>{const e=st();return{updateBudgetDetailMonthMutation:mt({mutationFn:d=>Ua(d),onSuccess:async(d,u)=>{await e.invalidateQueries(["budget",u.budgetId]),Te.showSuccessNotification("El bien se agreg\xF3 al presupuesto con \xE9xito")},onError:()=>{Te.showErrorNotification("Error al agregar el bien al presupuesto")}})}},Oa={class:"q-my-xs q-pt-sm q-ml-md tw-text-2xl tw-font-bold tw-text-slate-700"},Na={class:"row"},Ka={class:"col"},Wa=y("div",{class:"text-h6"},"Editar Art\xEDculo",-1),Ha={class:"text-h6"},Ga=y("div",{class:"text-caption"},"L\xEDnea",-1),Ja={class:"text-h6"},Xa=y("div",{class:"text-caption"},"Acci\xF3n",-1),Ya={class:"text-h6"},Za={class:"text-caption"},el={class:"text-h6"},tl={class:"text-subtitle2"},al=y("div",{class:"text-caption"},"Art\xEDculo",-1),Kl=Ie({__name:"DetailPage",setup(e){const{monthsDictionary:v}=ct(),{exportDataToCsv:d}=sa(),{updateBudgetDetailMutation:u}=ra(),{updateBudgetDetailMonthMutation:c}=ja(),{storeBudgetDetailMonthMutation:x}=za(),T=_(),B=$e(),{id:A}=B.params,{budget:z}=ta(A),{currencyFormat:P}=ua(),J=[{name:"consecutiveId",label:"ID",field:"consecutiveId",sortable:!1,required:!0},{name:"edit",required:!0,label:"Editar",align:"left",field:"edit",format:i=>"edit"},{name:"action",field:i=>i.action.name,label:"Acci\xF3n",sortable:!0,align:"left"},{name:"line",field:i=>i.line.name,label:"Partida",sortable:!0,align:"left"},{name:"department",field:i=>i.department.alias,label:"\xC1rea",sortable:!0,align:"left"},{name:"article",field:i=>i.article.name,label:"Bien",sortable:!0,align:"left"},{name:"article_description",field:i=>i.article.description,label:"Descripci\xF3n del bien",sortable:!0,align:"left"},{name:"justification",field:"justification",label:"Justificaci\xF3n",sortable:!0,align:"left"}],E=v.map(i=>({name:i.toLowerCase(),field:C=>{var R;return(R=C[i.toLowerCase()])==null?void 0:R.quantity},label:i,sortable:!0,align:"right"})),s=[{name:"estimated_amount",field:i=>`${P(+i.estimated_amount)}`,label:"Precio",sortable:!0,align:"right"},{name:"total",field:i=>`${P(+i.total)}`,label:"Total",sortable:!0,align:"right"}],w=[...J,...E,...s],I=_(["action","line","department","article","estimated_amount","enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre","total"]),W=[{key:"action",property:"name"},{key:"line",property:"name"},{key:"department",property:"alias"},{key:"article",property:"name"},{key:"article_description",property:"description"},{key:"justification",property:null}],$=w.map(i=>({label:i.label,value:i.name})),{searchQuery:j,pagination:f,updatePagination:g}=ca(),l=_([]),o=_("articles-list"),V=_(20),L=_(!1),O=_(-1),F=_({});_({});const we=_(ft.map(i=>i.toLowerCase())),Z=_([]),ke=[13,26,52,0];Y(z,()=>{var i;l.value=dt(((i=z.value)==null?void 0:i.details)||[])},{immediate:!0}),Y(O,()=>{O.value===-1&&(Z.value=[]),O.value>-1&&we.value.forEach(i=>{F.value[i]&&Z.value.push(F.value[i])})});function ue(){d(T.value.filteredSortedRows,w,"presupuesto")}async function se(i,C){C(),await u.mutateAsync({budgetDetail:i})}async function de(i,C){C(),await u.mutateAsync({budgetDetail:i})}function me(i){O.value=l.value.indexOf(i),F.value={...i},L.value=!0}function ne(){L.value=!1,tt(()=>{O.value=-1,F.value={}})}function Ce(i){const C=Z.value.findIndex(m=>m.month===i.month),R={...i,budget_detail_id:F.value.id,authorized_quantity:null,authorized:!1};C>-1?Z.value[C]=R:Z.value.push(R)}async function De(i){await Promise.allSettled(i)}async function ee(){const i=Z.value.map(({id:C,...R})=>C?c.mutateAsync({budgetId:A,budgetDetailId:R.budget_detail_id,BudgetDetailMonthId:C,payload:R}):x.mutateAsync({budgetId:A,budgetDetailId:R.budget_detail_id,payload:R}));await De(i),ne()}return(i,C)=>(G(),ie(ea,null,{default:n(()=>{var R;return[y("h5",Oa," Presupuesto "+Q((R=N(z))==null?void 0:R.year),1),t(pa,{modelValue:V.value,"onUpdate:modelValue":C[4]||(C[4]=m=>V.value=m),horizontal:""},{before:n(()=>[t(ga,{modelValue:o.value,"onUpdate:modelValue":C[0]||(C[0]=m=>o.value=m),align:"left",class:"text-secondary"},{default:n(()=>[t(Ge,{icon:"format_list_numbered",label:"Art\xEDculos",name:"articles-list"}),t(Ge,{icon:"playlist_add",label:"Nuevo",name:"add-article"})]),_:1},8,["modelValue"])]),after:n(()=>[t(_a,{modelValue:o.value,"onUpdate:modelValue":C[3]||(C[3]=m=>o.value=m),animated:"",swipeable:"","transition-next":"jump-up","transition-prev":"jump-up",vertical:""},{default:n(()=>[t(Je,{name:"articles-list"},{default:n(()=>[y("div",Na,[y("div",Ka,[t(aa,null,{"card-body":n(()=>[t(N(Kt),{ref_key:"qTablePresupuesto",ref:T,columns:w,filter:N(j),pagination:N(f),"row-key":"id",rows:l.value,"rows-per-page-options":ke,separator:"cell",title:"Detalle","visible-columns":I.value,"onUpdate:pagination":N(g)},{"top-right":n(m=>[t(ae,{class:"tw-mr-2",color:"primary","fab-mini":"",flat:"",icon:"tune",size:"sm"},{default:n(()=>[t(We,null,{default:n(()=>[K(" Mostrar/Ocultar columnas ")]),_:1}),t(Ft,{anchor:"top end",self:"center start"},{default:n(()=>[t(Ot,null,{default:n(()=>[(G(!0),ve(be,null,he(N($),h=>(G(),ie(Le,{key:h.value,clickable:""},{default:n(()=>[t(_e,null,{default:n(()=>[t(pe,null,{default:n(()=>[K(Q(h.label),1)]),_:2},1024)]),_:2},1024),t(_e,{side:""},{default:n(()=>[t(jt,{modelValue:I.value,"onUpdate:modelValue":C[1]||(C[1]=H=>I.value=H),color:"primary",val:h.value},null,8,["modelValue","val"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(ae,{dense:"",flat:"",icon:m.inFullscreen?"fullscreen_exit":"fullscreen",round:"",onClick:m.toggleFullscreen},{default:n(()=>[t(We,{disable:i.$q.platform.is.mobile},{default:n(()=>[K(Q(m.inFullscreen?"Salir de Pantalla Completa":"Pantalla Completa"),1)]),_:2},1032,["disable"])]),_:2},1032,["icon","onClick"]),t(re,{modelValue:N(j),"onUpdate:modelValue":C[2]||(C[2]=h=>ot(j)?j.value=h:null),class:"q-mr-xs",clearable:"",debounce:"300",dense:"",outlined:"",placeholder:"Buscar"},{append:n(()=>[t(oe,{name:"search"})]),_:1},8,["modelValue"]),t(Nt,{unelevated:""},{default:n(()=>[t(ae,{color:"primary","icon-right":"archive",label:"Exportar a CSV",onClick:ue})]),_:1})]),body:n(m=>[t(Wt,{props:m},{default:n(()=>[t(ce,{key:"consecutiveId",props:m},{default:n(()=>[K(Q(m.rowIndex+1),1)]),_:2},1032,["props"]),t(ce,{key:"edit",props:m},{default:n(()=>[t(ae,{color:"primary",dense:"",flat:"",icon:"edit",round:"",size:"sm",onClick:h=>me(m.row)},null,8,["onClick"])]),_:2},1032,["props"]),(G(),ve(be,null,he(W,h=>t(ce,{key:h.key,props:m},{default:n(()=>[K(Q(h.property?m.row[h.key][h.property]:m.row[h.key]),1)]),_:2},1032,["props"])),64)),(G(!0),ve(be,null,he(N(v),h=>(G(),ie(ce,{key:h.toLowerCase(),props:m},{default:n(()=>{var H;return[K(Q((H=m.row[h.toLowerCase()])==null?void 0:H.quantity),1)]}),_:2},1032,["props"]))),128)),t(ce,{key:"estimated_amount",class:"tw-cursor-pointer",props:m},{default:n(()=>[K(Q(N(P)(+m.row.estimated_amount))+" ",1),t(He,{modelValue:m.row.estimated_amount,"onUpdate:modelValue":h=>m.row.estimated_amount=h},{default:n(h=>[t(re,{modelValue:h.value,"onUpdate:modelValue":H=>h.value=H,modelModifiers:{number:!0},autofocus:"",dense:"",outlined:"",type:"number",onKeyup:Oe(H=>de(m.row,h.set),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),t(ce,{key:"total",class:"tw-cursor-pointer",props:m},{default:n(()=>[K(Q(N(P)(+m.row.total))+" ",1),t(He,{modelValue:m.row.total,"onUpdate:modelValue":h=>m.row.total=h},{default:n(h=>[t(re,{modelValue:h.value,"onUpdate:modelValue":H=>h.value=H,modelModifiers:{number:!0},autofocus:"",dense:"",outlined:"",type:"number",onKeyup:Oe(H=>se(m.row,h.set),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["filter","pagination","rows","visible-columns","onUpdate:pagination"])]),_:1})])])]),_:1}),t(Je,{name:"add-article"},{default:n(()=>[t(Ea)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),t(Zt,{modelValue:L.value,"onUpdate:modelValue":C[5]||(C[5]=m=>L.value=m),position:"right"},{default:n(()=>[t(ut,{class:"tw-w-[35rem]"},{default:n(()=>[t(Ve,{class:"bg-secondary text-white"},{default:n(()=>[Wa]),_:1}),t(le),t(Ve,{class:"tw-max-h-[80vh] scroll"},{default:n(()=>[y("div",Ha,Q(F.value.line.name),1),Ga,t(le,{class:"tw-my-4"}),y("div",Ja,Q(F.value.action.name),1),Xa,t(le,{class:"tw-my-4"}),y("div",Ya,Q(F.value.department.description),1),y("div",Za," Departamento ("+Q(F.value.department.alias)+") ",1),t(le,{class:"tw-my-4"}),y("div",el,Q(F.value.article.name),1),y("div",tl,Q(F.value.article.description),1),al,t(le,{class:"tw-my-4"}),(G(!0),ve(be,null,he(we.value,m=>(G(),ie(vt,{key:m,"budget-month":F.value[m],"estimated-amount":+F.value.estimated_amount,month:m,"onUpdate:quantity":Ce},null,8,["budget-month","estimated-amount","month"]))),128))]),_:1}),t(le),t(rt,{align:"right"},{default:n(()=>[xe(t(ae,{color:"secondary",flat:"",label:"Cancelar",onClick:ne},null,512),[[Ae]]),xe(t(ae,{color:"negative",flat:"",label:"Eliminar"},null,512),[[Ae]]),xe(t(ae,{color:"positive",flat:"",label:"Guardar",onClick:ee},null,512),[[Ae]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}});export{Kl as default};
