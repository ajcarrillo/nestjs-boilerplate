import{j as C,R as V,r as c,S as k,U as S,k as U,l as o,V as z,p as B,d as a,s as r,W as N,X as f,Y as $,Z as q,_ as x}from"./index.a852c7dd.js";import{Q as I}from"./QImg.3db4217f.js";import{Q as w}from"./QCardSection.1618d2d3.js";import{Q as g}from"./QInput.5a757dc1.js";import{Q as R}from"./QForm.1eb75f72.js";import{Q as j}from"./QCard.1e7bb02d.js";import{Q as F}from"./QPage.ea4e39d9.js";import{Q as L,a as P}from"./QLayout.1c78c5c2.js";import{u as E,p as D}from"./BudgetResource.e21a87b9.js";import{l as v}from"./layout.1849cf49.js";import"./use-key-composition.0193e5f8.js";import"./use-dark.84119dd2.js";import"./focus-manager.387b0375.js";import"./scroll.1d333f42.js";import"./QResizeObserver.2d66d329.js";import"./index.2cf0d985.js";const J=r("div",{class:"row no-wrap items-center"},[r("div",{class:"col text-h6 ellipsis"},"Iniciar sesi\xF3n")],-1),ie=C({__name:"LoginPage",setup(W){const u=V(),h=E(),y=z(),i=c(""),n=c(""),{authUser:l,isAuthenticated:m}=k(u),{flushDictionaries:Q,fetchDictionaries:_}=h;S(async()=>{if(m.value){await p(l.value.firstName);return}localStorage.clear(),Q()});function A(){var e,t,s,d;return((e=l.value)==null?void 0:e.roles.length)===1&&((t=l.value)==null?void 0:t.roles[0])==="departament"?{name:"department.welcome",params:{departmentKey:(d=(s=l.value)==null?void 0:s.area)==null?void 0:d.alias.toLocaleLowerCase()}}:{name:"welcome"}}async function b(){try{const{data:e}=await D.post("/auth/login",{email:i.value,password:n.value});u.setUser(e),await p(e.firstName)}catch{v.showErrorNotification("Authentication Failed")}}async function p(e){m&&(v.showSuccessNotification(`Bienvenid@ de vuelta, ${e}`),await _(),await y.push(A()))}return(e,t)=>(B(),U(L,null,{default:o(()=>[a(P,null,{default:o(()=>[a(F,{class:"flex flex-center"},{default:o(()=>[r("div",{id:"particles-js",class:N(e.$q.dark.isActive?"dark_gradient":"normal_gradient")},null,2),a(f,{class:"absolute-top-right",color:"white",flat:"",icon:e.$q.dark.isActive?"nights_stay":"wb_sunny",round:"",onClick:t[0]||(t[0]=s=>e.$q.dark.toggle())},null,8,["icon"]),a(j,{class:"login-form",style:$(e.$q.platform.is.mobile?{width:"80%"}:{width:"30%"})},{default:o(()=>[a(I,{src:"https://pbs.twimg.com/media/EjzUi4lWsAApJJV?format=jpg&name=large"}),a(w,null,{default:o(()=>[a(q,{class:"absolute tw-top-0 tw-right-6 tw-translate-y-[-50%] tw-bg-orange-600",size:"74px"},{default:o(()=>[a(x,{color:"white",name:"perm_identity"})]),_:1}),J]),_:1}),a(w,null,{default:o(()=>[a(R,{class:"q-gutter-md"},{default:o(()=>[a(g,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),filled:"",label:"Usuario","lazy-rules":""},null,8,["modelValue"]),a(g,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=s=>n.value=s),filled:"",label:"Contrase\xF1a","lazy-rules":"",type:"password"},null,8,["modelValue"]),r("div",null,[a(f,{color:"primary",label:"Entrar",type:"button",onClick:b})])]),_:1})]),_:1})]),_:1},8,["style"])]),_:1})]),_:1})]),_:1}))}});export{ie as default};
