import{p as i}from"./planeacion.api.0342f2e3.js";import{l as g}from"./layout.f6c7d4be.js";import{u as o,a as r}from"./QChip.c57cfaf9.js";import{u as b}from"./useMutation.esm.6c972cd2.js";import{r as S,w as q,c as p}from"./index.6e0dc468.js";function m(e,t){return e[t]}const y=e=>{const t=new FormData,u=["requisition_number","preparation_date","processing_date","estimated_amount","area_id","sub_budget_id"];for(const a of u)t.append(a,m(e,a).toString());const s=[{field:"file",value:e.file}];for(const{field:a,value:d}of s)d&&t.append(a,d);return t};var n={getSubBudgets(){return i.get("/sub-budgets")},createSubBudget(e){return i.post("/sub-budgets",e)},createSubBudgetAdjustment(e){return i.post("/sub-budget-adjustment",e)},getSubBudget(e){return i.get(`/sub-budgets/${e}`)},updateSubBudget(e,t){const{id:u,...s}=t;return i.patch(`/sub-budgets/${e}`,s)},getSubBudgetRequisitionsDictionary(){return i.get("/sub-budgets/requisitions/dictionary")},getSubBudgetRequisitions(){return i.get("/sub-budgets/requisitions/all")},createSubBudgetRequisition(e){const t=y(e);return i.post(`/sub-budgets/${e.sub_budget_id}/requisitions`,t,{headers:{"Content-Type":"multipart/form-data"}})},editSubBudgetRequisition(e){delete e.file;const t=y(e);return i.patch(`/sub-budgets/${e.sub_budget_id}/requisitions/${e.id}`,t,{headers:{"Content-Type":"multipart/form-data"}})},getSubBudgetRequisition(e,t){return i.get(`/sub-budgets/${e}/requisitions/${t}`)},getSubBudgetDictionary(e){return i.get(`/sub-budgets/dictionary?search=${e}`)}};const l=async()=>(await n.getSubBudgets()).data,R=async e=>(await n.createSubBudget(e)).data,f=async({createSubBudgetAdjustmentDto:e})=>(await n.createSubBudgetAdjustment(e)).data,w=async e=>(await n.getSubBudget(e)).data,F=async()=>(await n.getSubBudgetRequisitionsDictionary()).data,h=async()=>(await n.getSubBudgetRequisitions()).data,D=async({createRequisitionSubBudgetDto:e})=>(await n.createSubBudgetRequisition(e)).data,v=async({dto:e})=>(await n.editSubBudgetRequisition(e)).data,Q=async({subBudgetId:e,requisitionId:t})=>(await n.getSubBudgetRequisition(e,t)).data,_=async({search:e})=>(await n.getSubBudgetDictionary(e)).data,C=async({subBudgetId:e,updateSubBudgetDto:t})=>(await n.updateSubBudget(e,t)).data,T=()=>({subBudgetQuery:o({queryKey:["subBudgets"],queryFn:l,staleTime:6e5})}),$=e=>({subBudgetQuery:o({queryKey:["subBudget",e],queryFn:()=>w(e),staleTime:6e4})}),I=()=>{const e=r();return{createSubBudgetMutation:b({mutationFn:R,onSuccess:async()=>{g.showSuccessNotification("Presupuesto creado exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},K=()=>{const e=r();return{updateSubBudgetMutation:b({mutationFn:C,onSuccess:async(u,s)=>{g.showSuccessNotification("Presupuesto actualizado exitosamente"),await e.invalidateQueries(["subBudgets"]),await e.setQueryData(["subBudget",s.subBudgetId],u)}})}},N=()=>{const e=r();return{createSubBudgetAdjustmentMutation:b({mutationFn:f,onSuccess:async()=>{g.showSuccessNotification("Adecuaci\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},P=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitionsDictionary"],queryFn:F,staleTime:6e5});return{subBudgetReqDictionaryIsLoading:e,subBudgetReqDictionaryIsFetching:t,subBudgetReqDictionary:u}},U=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitions"],queryFn:h,staleTime:6e5});return{subBudgetRequisitionsIsLoading:e,subBudgetRequisitionsIsFetching:t,subBudgetRequisitions:u}},z=()=>{const e=r();return{createSubBudgetRequisitionMutation:b({mutationFn:D,onSuccess:async()=>{g.showSuccessNotification("Requisici\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgetRequisitions"])}})}},E=()=>{const e=r();return{editSubBudgetRequisitionMutation:b({mutationFn:v,onSuccess:async(u,s)=>{g.showSuccessNotification("Requisici\xF3n editada exitosamente"),e.setQueryData(["subBudgetRequisition",s.dto.sub_budget_id,s.dto.id],u),await e.invalidateQueries(["subBudgetRequisitions"])}})}},H=({subBudgetId:e,requisitionId:t})=>{r();const{isLoading:u,isFetching:s,data:a}=o({queryKey:["subBudgetRequisition",e,t],queryFn:()=>Q({subBudgetId:e,requisitionId:t}),staleTime:1e3*60});return{subBudgetRequisitionIsLoading:u,subBudgetRequisitionIsFetching:s,subBudgetRequisition:a}},c=S(""),V=()=>{const{isLoading:e,isFetching:t,data:u,refetch:s}=o({queryKey:["subBudgetDictionary",c.value],queryFn:()=>c.value===""?[]:_({search:c.value}),staleTime:6e5});q(c,async()=>{await s()});const a=p(()=>{var d;return(d=u.value)==null?void 0:d.map(B=>({id:B.value,event:B.label}))});return{subBudgetDictionaryIsLoading:e,subBudgetDictionaryIsFetching:t,subBudgetDictionary:a,search:c}};export{T as a,N as b,I as c,K as d,U as e,V as f,$ as g,z as h,E as i,H as j,P as u};
