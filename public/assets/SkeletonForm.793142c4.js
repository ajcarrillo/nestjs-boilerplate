import{Q as v}from"./QInput.e430ec3b.js";import{j as y,M as N,r as Q,o as I,p as c,k as E,l as s,d as e,s as r,bb as $,_ as j,u as n,X as p,q as D,ba as L,ae as k,F as W,ai as G}from"./index.c148c0c6.js";import{Q as P}from"./QFile.f6c09f2d.js";import{Q as _}from"./QCardSection.c5a77f55.js";import{a as g}from"./QMenu.f4712139.js";import{Q as S}from"./QCardActions.3e077162.js";import{Q as H}from"./QForm.667ad4d7.js";import{_ as h}from"./DatePicker.311462d2.js";import{i as T,j as X}from"./useSubBudgets.32ab3150.js";import{u as z}from"./useGoBack.378adbcf.js";import{F as J}from"./FilePreview.43865edb.js";import{c as K}from"./index.7adaf3a2.js";import{Q as f}from"./QSkeleton.c744978f.js";import{Q as O}from"./QCard.029ff02f.js";const Y={class:"row q-gutter-md"},Z={class:"col-12 col-md-6 col-lg-4"},ee={class:"col-12 col-md-6 col-lg-4"},te={class:"col-12 col-md-6 col-lg-4"},oe={class:"col-12 col-md-6 col-lg-4"},ae={class:"col-12 col-md-6 col-lg-4"},Fe=y({__name:"SubBudgetRequisitionForm",props:{populateWith:{default:null},isEditing:{type:Boolean,default:!1},subBudget:null},setup(u){const l=u,b="https://nestjs-boilerplate-production.up.railway.app",{goBack:q}=z(),{createSubBudgetRequisitionMutation:d}=T(),{isLoading:C}=d,{editSubBudgetRequisitionMutation:F}=X(),{isLoading:w}=F,A={area_id:l.subBudget.department.id,file:void 0,estimated_amount:0,preparation_date:"",processing_date:"",requisition_number:"",sub_budget_id:l.subBudget.id},o=N(K(l.populateWith)||A),x=Q(),m={estimated_amount:[t=>!!t||"El campo monto estimado es requerido"],preparation_date:[t=>!!t||"El campo fecha de preparaci\xF3n es requerido"],processing_date:[t=>!!t||"El campo fecha de procesamiento es requerido"],requisition_number:[t=>!!t||"El campo n\xFAmero de requisici\xF3n es requerido",t=>t.length==3||"El campo n\xFAmero de requisici\xF3n debe tener 3 d\xEDgitos",t=>!isNaN(Number(t))||"El campo n\xFAmero de requisici\xF3n debe ser un n\xFAmero"]},B=Q();async function R(){var a;await((a=x.value)==null?void 0:a.validate())&&(l.isEditing?await F.mutateAsync({dto:o}):await d.mutateAsync({createRequisitionSubBudgetDto:o}))}I(()=>{l.isEditing&&(o.area_id=l.subBudget.department.id,o.sub_budget_id=l.subBudget.id)});function M(t){o.file=t}return(t,a)=>(c(),E(n(H),{ref_key:"qSubBudgetReqForm",ref:x,onSubmit:L(R,["prevent"])},{default:s(()=>[e(_,null,{default:s(()=>{var V;return[r("div",Y,[r("div",Z,[e(v,{modelValue:o.requisition_number,"onUpdate:modelValue":a[0]||(a[0]=i=>o.requisition_number=i),dense:"",label:"N\xFAmero de requisici\xF3n",outlined:"",rules:m.requisition_number,"stack-label":""},null,8,["modelValue","rules"])]),r("div",ee,[e(v,{modelValue:o.estimated_amount,"onUpdate:modelValue":a[1]||(a[1]=i=>o.estimated_amount=i),modelModifiers:{number:!0},dense:"",label:"Monto estimado",outlined:"",rules:m.estimated_amount,"stack-label":""},null,8,["modelValue","rules"])]),r("div",te,[e(h,{modelValue:o.preparation_date,"onUpdate:modelValue":a[2]||(a[2]=i=>o.preparation_date=i),label:"Fecha de preparaci\xF3n",rules:m.preparation_date},null,8,["modelValue","rules"])]),r("div",oe,[e(h,{modelValue:o.processing_date,"onUpdate:modelValue":a[3]||(a[3]=i=>o.processing_date=i),label:"Fecha de procesamiento",rules:m.processing_date},null,8,["modelValue","rules"])]),r("div",ae,[e(P,{modelValue:B.value,"onUpdate:modelValue":[a[4]||(a[4]=i=>B.value=i),M],accept:".jpg, image/*, application/pdf",dense:"",label:"Haga click para subir el archivo o arrastralo aqu\xED",name:"file",outlined:"","use-chips":""},$({prepend:s(()=>[e(j,{name:"attach_file"})]),_:2},[u.isEditing&&((V=l.populateWith)==null?void 0:V.file)?{name:"append",fn:s(()=>{var i;return[e(J,{"file-url":`${n(b)}/api/files/preview/${(i=l.populateWith)==null?void 0:i.file}`},{activator:s(({showPreview:U})=>[e(p,{color:"primary",flat:"",icon:"o_description","no-caps":"",onClick:U},{default:s(()=>[D(" Ver archivo ")]),_:2},1032,["onClick"])]),_:1},8,["file-url"])]}),key:"0"}:void 0]),1032,["modelValue"])])])]}),_:1}),e(g),e(S,{align:"right"},{default:s(()=>[e(p,{color:"primary",label:"Guardar",loading:n(w)||n(C),type:"submit"},null,8,["loading"]),e(p,{color:"primary",flat:"",label:"Atr\xE1s",onClick:n(q)},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit"]))}}),ie={class:"text-caption"},xe=y({__name:"SkeletonForm",props:{inputCount:null},setup(u){const l=u;return(b,q)=>(c(),E(O,{bordered:"",flat:""},{default:s(()=>[e(_,null,{default:s(()=>[r("div",ie,[e(f,{type:"text"})])]),_:1}),e(g),e(_,{class:"tw-flex tw-flex-col tw-gap-4"},{default:s(()=>[(c(!0),k(W,null,G(l.inputCount,d=>(c(),k("div",{key:d},[e(f,{type:"QInput"})]))),128))]),_:1}),e(g),e(S,{align:"right"},{default:s(()=>[e(f,{type:"QBtn"})]),_:1})]),_:1}))}});export{xe as _,Fe as a};
