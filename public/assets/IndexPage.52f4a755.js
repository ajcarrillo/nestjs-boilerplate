import{M as F,H as g,r as x,c as Q,m as E,j as V,k as o,d as t,u,S as y,ax as k,a2 as N,p as M}from"./index.812f81a0.js";import{l as A,b as U,c as C}from"./layout.a9526a0e.js";import{C as I,Q as L}from"./CardForm.4536dc52.js";import{u as T,a as S,b as q,c as B,T as z,Q as K,d as $}from"./QCardActions.08f71cf5.js";import{k as D,Q as H,h as P}from"./QSeparator.e38ba453.js";import{A as _}from"./ActionResource.d6c0be8e.js";import"./uid.41ce9c26.js";import"./index.2cf0d985.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./scroll.7ca003e8.js";import"./QPage.3dfb7345.js";import"./utils.esm.48473d4c.js";const j=async()=>{const{data:e}=await _.getActions();return e},G=async e=>{const{data:a}=await _.storeAction(e);return a},R=async e=>{const{id:a,name:i}=e,{data:r}=await _.updateAction(a,{name:i});return r},J=()=>{const{isLoading:e,isError:a,data:i,error:r}=T({queryKey:["actions"],queryFn:j,staleTime:6e5});return{isLoading:e,isError:a,data:i,error:r}},O=()=>{const e=S();return{actionStoreMutations:q({mutationFn:G,onSuccess:()=>{e.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n creada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al crear acci\xF3n")}})}},W=()=>{const e=S();return{actionUpdateMutations:q({mutationFn:R,onSuccess:()=>{e.invalidateQueries({queryKey:["actions"]}),A.showSuccessNotification("Acci\xF3n actualizada con \xE9xito")},onError:()=>{A.showErrorNotification("Error al actualizar acci\xF3n")}})}},X=F({__name:"ActionForm",props:{action:null},setup(e){const a=e,{actionStoreMutations:i}=O(),{isLoading:r}=i,{actionUpdateMutations:s}=W(),{isLoading:m}=s,b=g({name:""}),l=g(B(a.action||b)),d=x(),c={name:[v=>!!v||"El nombre es requerido"]},n=Q(()=>a.action&&"id"in a.action),w=Q(()=>n.value?"Editar acci\xF3n":"Agregar acci\xF3n");async function h(){var p,f;!await((p=d.value)==null?void 0:p.validate())||(n.value?await s.mutateAsync(l):(await i.mutateAsync(l),l.name="",(f=d.value)==null||f.reset()))}return(v,p)=>(E(),V(I,{title:u(w)},{form:o(()=>[t(u(U),{ref_key:"actionForm",ref:d,class:"q-gutter-md"},{default:o(()=>[t(D,null,{default:o(()=>[t(H,null,{default:o(()=>[t(P,null,{default:o(()=>[t(C,{modelValue:l.name,"onUpdate:modelValue":p[0]||(p[0]=f=>l.name=f),dense:"",label:"Nombre",outlined:"",rules:c.name},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),actions:o(()=>[t(y,{color:"primary",label:"Guardar",loading:u(r)||u(m),onClick:h},null,8,["loading"])]),_:1},8,["title"]))}}),Y={class:"q-gutter-sm"},dt=F({__name:"IndexPage",setup(e){const{data:a,isLoading:i}=J(),r=x(""),s=x(!1);let m=g({name:""});const b=[{name:"id",field:"id",required:!0,label:"ID",sortable:!0,align:"left"},{name:"name",field:"name",label:"Nombre",sortable:!0,align:"left"},{name:"action",align:"center",label:"Acciones",field:"action",sortable:!1}];k(()=>{s.value||(m=g({name:""}))});function l(d){s.value=!0,m=d}return(d,c)=>(E(),V(z,null,{"card-body":o(()=>[t(K,{columns:b,loading:u(i),rows:u(a),"rows-per-page-options":[20,30,40,50],title:"Acciones"},{"top-right":o(()=>[t(y,{class:"q-mr-xs",color:"primary",icon:"add",label:"Nueva Acci\xF3n",outline:"",onClick:c[0]||(c[0]=n=>s.value=!0)}),t(C,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=n=>r.value=n),class:"q-mr-xs",debounce:"300",dense:"",outlined:"",placeholder:"Search"},{append:o(()=>[t(N,{name:"search"})]),_:1},8,["modelValue"]),t(y,{color:"primary","icon-right":"archive",label:"Exportar CSV","no-caps":""})]),"body-cell-action":o(n=>[t(L,{props:n},{default:o(()=>[M("div",Y,[t(y,{color:"primary",dense:"",flat:"",icon:"edit",rounded:"",size:"sm",onClick:w=>l(n.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["loading","rows"])]),footer:o(()=>[t($,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=n=>s.value=n)},{default:o(()=>[t(X,{action:u(m)},null,8,["action"])]),_:1},8,["modelValue"])]),_:1}))}});export{dt as default};
