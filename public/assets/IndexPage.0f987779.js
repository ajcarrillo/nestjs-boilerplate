import{Q as P}from"./layout.4b2b4fc6.js";import{Q as p,a as b}from"./QItemLabel.a1c43e19.js";import{Q as l,a as Y}from"./QTable.53e8a8a3.js";import{Q as h}from"./QSelect.ba4acd63.js";import{Q as T,a as U}from"./QTr.845b68fb.js";import{j as E,r as c,k as g,l as t,p as _,d as a,q as n,t as u,u as s,aj as M,X as A}from"./index.5aa8c638.js";import{e as N,f as $,g as j}from"./useSubBudgets.d5a5500c.js";import{T as G}from"./TablePage.ea16b8f9.js";import{d as L}from"./date.aa601987.js";import{F as X}from"./FilePreview.bdbb4120.js";import{u as z}from"./useMoney.dbc60660.js";import{_ as H}from"./DeleteCardDialog.afe87d00.js";import"./use-dark.11b5bbd8.js";import"./planeacion.api.1cf4c236.js";import"./index.2cf0d985.js";import"./format.6cb58920.js";import"./scroll.00ea7ec0.js";import"./QList.96ab8b8e.js";import"./QCheckbox.32454bb7.js";import"./QChip.fc48aeaf.js";import"./utils.esm.649b663e.js";import"./useMutation.esm.1dca9e79.js";import"./mutation.esm.96a56e6b.js";import"./QCard.a4abc093.js";import"./QPage.e306aaa5.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./QTooltip.94c8a25a.js";import"./QCardSection.f8ea1e29.js";import"./QImg.d3fae112.js";import"./QSpace.6eeaa7fa.js";import"./QBanner.9942f602.js";import"./MyCardTitle.f1fc33c8.js";const v=L.formatDate,Fe=E({__name:"IndexPage",setup(J){const{currencyFormat:w}=z(),y="https://nestjs-boilerplate-production.up.railway.app",{subBudgetRequisitions:D}=N(),{search:B,subBudgetDictionary:q,subBudgetDictionaryIsFetching:K}=$(),k=[{name:"consecutiveId",field:"consecutiveId",label:"ID",align:"left"},{name:"requisition_number",field:"requisition_number",label:"N\xFAm. Requisici\xF3n"},{name:"estimated_amount",field:"estimated_amount",label:"Monto Estimado"},{name:"preparation_date",field:i=>v(i.preparation_date,"YYYY-MM-DD"),label:"Fecha de Preparaci\xF3n",align:"left"},{name:"processing_date",field:i=>v(i.processing_date,"YYYY-MM-DD"),label:"Fecha de Procesamiento",align:"left"},{name:"area",field:i=>i.area.description,label:"\xC1rea",align:"left"},{name:"event",field:i=>i.subBudget.event,label:"Evento",align:"left"},{name:"file",field:"file",label:"Archivo",align:"left"},{name:"actions",field:"actions",label:"Acciones",align:"left"}];c(void 0);const f=c(""),d=c(!1),m=c(void 0),{isDeletingSubBudgetRequisition:V,deleteSubBudgetReq:I}=j();async function x(i,o){if(i===""){o();return}o(()=>{B.value=i})}async function Q(i,o){console.log({value:i,initialValue:o})}function F(i){m.value=i,d.value=!0}async function R(){var i,o;await I({subBudgetId:(i=m.value)==null?void 0:i.subBudget.id,requisitionId:(o=m.value)==null?void 0:o.id}),S()}function S(){d.value=!1,m.value=void 0}return(i,o)=>(_(),g(G,null,{"card-body":t(()=>[a(Y,{columns:k,filter:f.value,pagination:{rowsPerPage:20},rows:s(D),title:"Requisiciones","wrap-cells":""},{"top-right":t(()=>[a(P,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=e=>f.value=e),clearable:"",dense:"",label:"Buscar",outlined:""},null,8,["modelValue"])]),body:t(e=>[a(T,{props:e},{default:t(()=>[a(l,{key:"consecutiveId",props:e},{default:t(()=>[a(p,{class:"text-primary tw-font-bold",clickable:"",to:{name:"sub-budgets.edit.requisition",params:{id:e.row.subBudget.id,reqId:e.row.id}}},{default:t(()=>[a(b,null,{default:t(()=>[n(u((e.rowIndex+1).toString()),1)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1032,["props"]),a(l,{key:"requisition_number",props:e},{default:t(()=>[n(u(e.row.requisition_number),1)]),_:2},1032,["props"]),a(l,{key:"estimated_amount",props:e},{default:t(()=>[n(u(s(w)(e.row.estimated_amount)),1)]),_:2},1032,["props"]),a(l,{key:"preparation_date",props:e},{default:t(()=>[n(u(e.row.preparation_date),1)]),_:2},1032,["props"]),a(l,{key:"processing_date",props:e},{default:t(()=>[n(u(e.row.processing_date),1)]),_:2},1032,["props"]),a(l,{key:"area",props:e},{default:t(()=>[n(u(e.row.area.description),1)]),_:2},1032,["props"]),a(l,{key:"event",props:e},{default:t(()=>[n(u(e.row.subBudget.event)+" ",1),a(U,{modelValue:e.row.subBudget,"onUpdate:modelValue":r=>e.row.subBudget=r,buttons:"","label-cancel":"Cancelar","label-set":"Guardar",persistent:"",onSave:Q},{default:t(r=>[a(h,{modelValue:r.value,"onUpdate:modelValue":C=>r.value=C,class:"full-width",clearable:"",dense:"","emit-value":"","input-debounce":"600",label:"Evento","map-options":"","option-label":"event","option-value":"id",options:s(q),outlined:"","use-input":"",onFilter:x},{"no-option":t(()=>[a(p,null,{default:t(()=>[a(b,{class:"text-grey"},{default:t(()=>[n(" Sin resultados ")]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(l,{key:"file",props:e},{default:t(()=>[e.row.file?(_(),g(X,{key:0,"file-url":`${s(y)}/api/files/preview/${e.row.file}`},null,8,["file-url"])):M("",!0)]),_:2},1032,["props"]),a(l,{key:"actions",props:e},{default:t(()=>[a(A,{color:"negative",flat:"",icon:"delete",round:"",onClick:r=>F(e.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["filter","rows"])]),footer:t(()=>[a(H,{modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value=e),"card-title":"\xBFDesea eliminar la requisici\xF3n?",deleting:s(V),onConfirmDelete:R},null,8,["modelValue","deleting"])]),_:1}))}});export{Fe as default};
