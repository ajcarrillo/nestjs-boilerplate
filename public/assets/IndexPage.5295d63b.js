import{j as C,N as x,r as E,c as Q,p as D,k as F,l as t,d as e,u as d,Z as g,aH as N,a6 as M,s as h}from"./index.404f6180.js";import{l as b,Q as I,a as v}from"./layout.eb1e0f2e.js";import{C as L,Q as T}from"./CardForm.95c686e3.js";import{u as B,a as S,b as U,c as z,T as K,Q as $,d as H}from"./QCardActions.4c2ff797.js";import{A as _}from"./ArticleResource.d52eaf9f.js";import{a as P,b as V,c as q}from"./format.e886d86d.js";import"./use-dark.ed1c6acc.js";import"./focus-manager.33224ae2.js";import"./index.2cf0d985.js";import"./QCard.f0638023.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./scroll.75c71c19.js";import"./QPage.63d049a8.js";import"./utils.esm.dcf38a17.js";const j=async()=>{const{data:a}=await _.getArticles();return a},G=async a=>{const{data:r}=await _.storeArticle(a);return r},R=async a=>{const{id:r,name:s,description:c}=a,{data:o}=await _.updateArticle(r,{name:s,description:c});return o},Z=()=>{const{isLoading:a,isError:r,data:s,error:c}=B({queryKey:["articles"],queryFn:j,staleTime:6e5});return{isLoading:a,isError:r,data:s,error:c}},J=()=>{const a=S();return{articleStoreMutations:U({mutationFn:G,onSuccess:()=>{a.invalidateQueries({queryKey:["articles"]}),b.showSuccessNotification("Art\xEDculo creado con \xE9xito")},onError:()=>{b.showErrorNotification("Error al crear art\xEDculo")}})}},O=()=>{const a=S();return{articleUpdateMutations:U({mutationFn:R,onSuccess:()=>{a.invalidateQueries({queryKey:["articles"]}),b.showSuccessNotification("Art\xEDculo actualizado con \xE9xito")},onError:()=>{b.showErrorNotification("Error al actualizar art\xEDculo")}})}},W=C({__name:"ArticleForm",props:{article:null},setup(a){const r=a,{articleStoreMutations:s}=J(),{isLoading:c}=s,{articleUpdateMutations:o}=O(),{isLoading:f}=o,A=x({name:"",description:""}),l=x(z(r.article||A)),m=E(),n={name:[y=>!!y||"El nombre es requerido"],description:[y=>!!y||"La descripci\xF3n es requerida"]},i=Q(()=>r.article&&"id"in r.article),w=Q(()=>i.value?"Editar art\xEDculo":"Agregar art\xEDculo");async function k(){var u,p;await((u=m.value)==null?void 0:u.validate())&&(i.value?await o.mutateAsync(l):(await s.mutateAsync(l),l.name="",l.description="",(p=m.value)==null||p.reset()))}return(y,u)=>(D(),F(L,{title:d(w)},{form:t(()=>[e(d(I),{ref_key:"articleForm",ref:m,class:"q-gutter-md"},{default:t(()=>[e(P,null,{default:t(()=>[e(V,null,{default:t(()=>[e(q,null,{default:t(()=>[e(v,{modelValue:l.name,"onUpdate:modelValue":u[0]||(u[0]=p=>l.name=p),dense:"",label:"Art\xEDculo",outlined:"",rules:n.name},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(q,null,{default:t(()=>[e(v,{modelValue:l.description,"onUpdate:modelValue":u[1]||(u[1]=p=>l.description=p),dense:"",label:"Descripci\xF3n",outlined:"",rules:n.description,type:"textarea"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),actions:t(()=>[e(g,{color:"primary",label:"Guardar",loading:d(c)||d(f),"no-caps":"",type:"submit",onClick:k},null,8,["loading"])]),_:1},8,["title"]))}}),X={class:"q-gutter-sm"},pe=C({__name:"IndexPage",setup(a){const{data:r,isLoading:s}=Z(),c=E(""),o=E(!1);let f=x({name:"",description:""});const A=[{name:"id",field:"id",required:!0,label:"ID",sortable:!0,align:"left"},{name:"name",field:"name",label:"Nombre",sortable:!0,align:"left"},{name:"description",field:"description",label:"Descripci\xF3n",sortable:!1,align:"left"},{name:"action",align:"center",label:"Acciones",field:"action",sortable:!1}];N(()=>{o.value||(f=x({name:"",description:""}))});function l(m){o.value=!0,f=m}return(m,n)=>(D(),F(K,null,{"card-body":t(()=>[e($,{columns:A,loading:d(s),rows:d(r),"rows-per-page-options":[20,30,40,50],title:"Art\xEDculos"},{"top-right":t(()=>[e(g,{class:"q-mr-xs",color:"primary",icon:"add",label:"Art\xEDculo",outline:"",onClick:n[0]||(n[0]=i=>o.value=!0)}),e(v,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=i=>c.value=i),class:"q-mr-xs",debounce:"300",dense:"",outlined:"",placeholder:"Search"},{append:t(()=>[e(M,{name:"search"})]),_:1},8,["modelValue"]),e(g,{color:"primary","icon-right":"archive",label:"Exportar CSV","no-caps":""})]),"body-cell-action":t(i=>[e(T,{props:i},{default:t(()=>[h("div",X,[e(g,{color:"primary",dense:"",flat:"",icon:"edit",rounded:"",size:"sm",onClick:w=>l(i.row)},null,8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["loading","rows"])]),footer:t(()=>[e(H,{modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=i=>o.value=i)},{default:t(()=>[e(W,{article:d(f)},null,8,["article"])]),_:1},8,["modelValue"])]),_:1}))}});export{pe as default};
