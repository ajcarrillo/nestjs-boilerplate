import{p as i}from"./planeacion.api.e983001c.js";import{l as g}from"./layout.21328db8.js";import{u as o,a as r}from"./QChip.4ddd763a.js";import{u as b}from"./useMutation.esm.262c3a3f.js";import{r as S,w as q,c as p}from"./index.ac1fe3a4.js";function m(e,t){return e[t]}const y=e=>{const t=new FormData,u=["requisition_number","preparation_date","processing_date","estimated_amount","area_id","sub_budget_id"];for(const a of u)t.append(a,m(e,a).toString());const s=[{field:"file",value:e.file}];for(const{field:a,value:d}of s)d&&t.append(a,d);return t};var n={getSubBudgets(){return i.get("/sub-budgets")},createSubBudget(e){return i.post("/sub-budgets",e)},createSubBudgetAdjustment(e){return i.post("/sub-budget-adjustment",e)},getSubBudget(e){return i.get(`/sub-budgets/${e}`)},updateSubBudget(e,t){const{id:u,...s}=t;return i.patch(`/sub-budgets/${e}`,s)},getSubBudgetRequisitionsDictionary(){return i.get("/sub-budgets/requisitions/dictionary")},getSubBudgetRequisitions(){return i.get("/sub-budgets/requisitions/all")},createSubBudgetRequisition(e){const t=y(e);return i.post(`/sub-budgets/${e.sub_budget_id}/requisitions`,t,{headers:{"Content-Type":"multipart/form-data"}})},editSubBudgetRequisition(e){const t=y(e);return i.patch(`/sub-budgets/${e.sub_budget_id}/requisitions/${e.id}`,t,{headers:{"Content-Type":"multipart/form-data"}})},getSubBudgetRequisition(e,t){return i.get(`/sub-budgets/${e}/requisitions/${t}`)},getSubBudgetDictionary(e){return i.get(`/sub-budgets/dictionary?search=${e}`)},getSavings(){return i.get("/sub-budgets/savings")}};const l=async()=>{const{data:e}=await n.getSavings();return e},R=async()=>(await n.getSubBudgets()).data,f=async e=>(await n.createSubBudget(e)).data,w=async({createSubBudgetAdjustmentDto:e})=>(await n.createSubBudgetAdjustment(e)).data,F=async e=>(await n.getSubBudget(e)).data,h=async()=>(await n.getSubBudgetRequisitionsDictionary()).data,D=async()=>(await n.getSubBudgetRequisitions()).data,v=async({createRequisitionSubBudgetDto:e})=>(await n.createSubBudgetRequisition(e)).data,Q=async({dto:e})=>(await n.editSubBudgetRequisition(e)).data,_=async({subBudgetId:e,requisitionId:t})=>(await n.getSubBudgetRequisition(e,t)).data,C=async({search:e})=>(await n.getSubBudgetDictionary(e)).data,M=async({subBudgetId:e,updateSubBudgetDto:t})=>(await n.updateSubBudget(e,t)).data,$=()=>({subBudgetQuery:o({queryKey:["subBudgets"],queryFn:R,staleTime:6e5})}),K=e=>({subBudgetQuery:o({queryKey:["subBudget",e],queryFn:()=>F(e),staleTime:6e4})}),I=()=>{const e=r();return{createSubBudgetMutation:b({mutationFn:f,onSuccess:async()=>{g.showSuccessNotification("Presupuesto creado exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},N=()=>{const e=r();return{updateSubBudgetMutation:b({mutationFn:M,onSuccess:async(u,s)=>{g.showSuccessNotification("Presupuesto actualizado exitosamente"),await e.invalidateQueries(["subBudgets"]),await e.setQueryData(["subBudget",s.subBudgetId],u)}})}},E=()=>{const e=r();return{createSubBudgetAdjustmentMutation:b({mutationFn:w,onSuccess:async()=>{g.showSuccessNotification("Adecuaci\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},P=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitionsDictionary"],queryFn:h,staleTime:6e5});return{subBudgetReqDictionaryIsLoading:e,subBudgetReqDictionaryIsFetching:t,subBudgetReqDictionary:u}},U=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitions"],queryFn:D,staleTime:6e5});return{subBudgetRequisitionsIsLoading:e,subBudgetRequisitionsIsFetching:t,subBudgetRequisitions:u}},k=()=>{const e=r();return{createSubBudgetRequisitionMutation:b({mutationFn:v,onSuccess:async()=>{g.showSuccessNotification("Requisici\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgetRequisitions"])}})}},z=()=>{const e=r();return{editSubBudgetRequisitionMutation:b({mutationFn:Q,onSuccess:async(u,s)=>{g.showSuccessNotification("Requisici\xF3n editada exitosamente"),e.setQueryData(["subBudgetRequisition",s.dto.sub_budget_id,s.dto.id],u),await e.invalidateQueries(["subBudgetRequisitions"])}})}},G=({subBudgetId:e,requisitionId:t})=>{r();const{isLoading:u,isFetching:s,data:a}=o({queryKey:["subBudgetRequisition",e,t],queryFn:()=>_({subBudgetId:e,requisitionId:t}),staleTime:1e3*60});return{subBudgetRequisitionIsLoading:u,subBudgetRequisitionIsFetching:s,subBudgetRequisition:a}},c=S(""),H=()=>{const{isLoading:e,isFetching:t,data:u,refetch:s}=o({queryKey:["subBudgetDictionary",c.value],queryFn:()=>c.value===""?[]:C({search:c.value}),staleTime:6e5});q(c,async()=>{await s()});const a=p(()=>{var d;return(d=u.value)==null?void 0:d.map(B=>({id:B.value,event:B.label}))});return{subBudgetDictionaryIsLoading:e,subBudgetDictionaryIsFetching:t,subBudgetDictionary:a,search:c}},V=()=>{const{isLoading:e,isError:t,data:u,error:s}=o({queryKey:["savings"],queryFn:l,staleTime:6e5});return{isLoading:e,isError:t,savings:u,error:s}};export{$ as a,E as b,I as c,N as d,U as e,H as f,K as g,k as h,z as i,G as j,V as k,P as u};
