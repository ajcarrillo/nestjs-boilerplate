import{p as i}from"./planeacion.api.11872094.js";import{l as d}from"./layout.50bbef5d.js";import{u as o,a as r}from"./QChip.c85dbe45.js";import{u as c}from"./useMutation.esm.337bf2db.js";import{r as y,w as q,c as p}from"./index.e80209f7.js";function l(e,t){return e[t]}const S=e=>{const t=new FormData,u=["requisition_number","preparation_date","processing_date","estimated_amount","area_id","sub_budget_id"];for(const a of u)t.append(a,l(e,a).toString());const s=[{field:"file",value:e.file}];for(const{field:a,value:g}of s)g&&t.append(a,g);return t};var n={getSubBudgets(){return i.get("/sub-budgets")},createSubBudget(e){return i.post("/sub-budgets",e)},createSubBudgetAdjustment(e){return i.post("/sub-budget-adjustment",e)},getSubBudget(e){return i.get(`/sub-budgets/${e}`)},updateSubBudget(e,t){const{id:u,...s}=t;return i.patch(`/sub-budgets/${e}`,s)},getSubBudgetRequisitionsDictionary(){return i.get("/sub-budgets/requisitions/dictionary")},getSubBudgetRequisitions(){return i.get("/sub-budgets/requisitions/all")},createSubBudgetRequisition(e){const t=S(e);return i.post(`/sub-budgets/${e.sub_budget_id}/requisitions`,t,{headers:{"Content-Type":"multipart/form-data"}})},editSubBudgetRequisition(e){const t=S(e);return i.patch(`/sub-budgets/${e.sub_budget_id}/requisitions/${e.id}`,t,{headers:{"Content-Type":"multipart/form-data"}})},getSubBudgetRequisition(e,t){return i.get(`/sub-budgets/${e}/requisitions/${t}`)},getSubBudgetDictionary(e){return i.get(`/sub-budgets/dictionary?search=${e}`)},getSavings(){return i.get("/sub-budgets/savings")},deleteSubBudgetRequisition({subBudgetId:e,requisitionId:t}){return i.delete(`/sub-budgets/${e}/requisitions/${t}`)}};const m=async()=>{const{data:e}=await n.getSavings();return e},R=async()=>(await n.getSubBudgets()).data,f=async e=>(await n.createSubBudget(e)).data,w=async({createSubBudgetAdjustmentDto:e})=>(await n.createSubBudgetAdjustment(e)).data,F=async e=>(await n.getSubBudget(e)).data,D=async()=>(await n.getSubBudgetRequisitionsDictionary()).data,h=async()=>(await n.getSubBudgetRequisitions()).data,v=async({createRequisitionSubBudgetDto:e})=>(await n.createSubBudgetRequisition(e)).data,Q=async({dto:e})=>(await n.editSubBudgetRequisition(e)).data,_=async({subBudgetId:e,requisitionId:t})=>(await n.getSubBudgetRequisition(e,t)).data,C=async({search:e})=>(await n.getSubBudgetDictionary(e)).data,x=async({subBudgetId:e,requisitionId:t})=>(await n.deleteSubBudgetRequisition({subBudgetId:e,requisitionId:t})).data,M=async({subBudgetId:e,updateSubBudgetDto:t})=>(await n.updateSubBudget(e,t)).data,K=()=>({subBudgetQuery:o({queryKey:["subBudgets"],queryFn:R,staleTime:6e5})}),I=e=>({subBudgetQuery:o({queryKey:["subBudget",e],queryFn:()=>F(e),staleTime:6e4})}),N=()=>{const e=r();return{createSubBudgetMutation:c({mutationFn:f,onSuccess:async()=>{d.showSuccessNotification("Presupuesto creado exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},E=()=>{const e=r();return{updateSubBudgetMutation:c({mutationFn:M,onSuccess:async(u,s)=>{d.showSuccessNotification("Presupuesto actualizado exitosamente"),await e.invalidateQueries(["subBudgets"]),await e.setQueryData(["subBudget",s.subBudgetId],u)}})}},P=()=>{const e=r();return{createSubBudgetAdjustmentMutation:c({mutationFn:w,onSuccess:async()=>{d.showSuccessNotification("Adecuaci\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgets"])}})}},U=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitionsDictionary"],queryFn:D,staleTime:6e5});return{subBudgetReqDictionaryIsLoading:e,subBudgetReqDictionaryIsFetching:t,subBudgetReqDictionary:u}},k=()=>{const{isLoading:e,isFetching:t,data:u}=o({queryKey:["subBudgetRequisitions"],queryFn:h,staleTime:6e5});return{subBudgetRequisitionsIsLoading:e,subBudgetRequisitionsIsFetching:t,subBudgetRequisitions:u}},z=()=>{const e=r();return{createSubBudgetRequisitionMutation:c({mutationFn:v,onSuccess:async()=>{d.showSuccessNotification("Requisici\xF3n creada exitosamente"),await e.invalidateQueries(["subBudgetRequisitions"])}})}},G=()=>{const e=r();return{editSubBudgetRequisitionMutation:c({mutationFn:Q,onSuccess:async(u,s)=>{d.showSuccessNotification("Requisici\xF3n editada exitosamente"),e.setQueryData(["subBudgetRequisition",s.dto.sub_budget_id,s.dto.id],u),await e.invalidateQueries(["subBudgetRequisitions"])}})}},H=({subBudgetId:e,requisitionId:t})=>{r();const{isLoading:u,isFetching:s,data:a}=o({queryKey:["subBudgetRequisition",e,t],queryFn:()=>_({subBudgetId:e,requisitionId:t}),staleTime:1e3*60});return{subBudgetRequisitionIsLoading:u,subBudgetRequisitionIsFetching:s,subBudgetRequisition:a}},b=y(""),V=()=>{const{isLoading:e,isFetching:t,data:u,refetch:s}=o({queryKey:["subBudgetDictionary",b.value],queryFn:()=>b.value===""?[]:C({search:b.value}),staleTime:6e5});q(b,async()=>{await s()});const a=p(()=>{var g;return(g=u.value)==null?void 0:g.map(B=>({id:B.value,event:B.label}))});return{subBudgetDictionaryIsLoading:e,subBudgetDictionaryIsFetching:t,subBudgetDictionary:a,search:b}},J=()=>{const{isLoading:e,isError:t,data:u,error:s}=o({queryKey:["savings"],queryFn:m,staleTime:6e5});return{isLoading:e,isError:t,savings:u,error:s}},O=()=>{const e=r(),{mutateAsync:t,isLoading:u,isError:s}=c({mutationFn:x,onSuccess:async()=>{d.showSuccessNotification("Requisici\xF3n eliminada exitosamente"),await e.invalidateQueries(["subBudgetRequisitions"])}});return{deleteSubBudgetReq:t,isDeletingSubBudgetRequisition:u,isDeletingSubBudgetRequisitionError:s}};export{K as a,P as b,N as c,E as d,k as e,V as f,O as g,I as h,z as i,G as j,H as k,J as l,U as u};
