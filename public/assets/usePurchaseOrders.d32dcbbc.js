import{p as t}from"./BudgetResource.e21a87b9.js";import{l as s}from"./layout.1849cf49.js";import{a as n,u as y}from"./useQuery.esm.6e7da3a0.js";import{u as d}from"./useMutation.esm.e5230e92.js";import{r as m}from"./index.a852c7dd.js";var o={getPurchaseOrders(r){return r?t.get("/purchase-orders/requisition-sub-budget"):t.get("/purchase-orders")},createPurchaseOrder(r){return t.post("/purchase-orders",r)},createPurchaseOrderFromRequisition(r){return t.post("/purchase-orders/requisition-sub-budget",r)},uploadFile(r,e){return t.post(`/files/purchase-orders/${r}`,e,{headers:{"Content-Type":"multipart/form-data"}})},getPurchaseDictionary(){return t.get("/purchase-orders/dictionary")},deletePurchaseOrder({id:r,requisitionType:e}){return t.delete(`/purchase-orders/${r}?requisitionType=${e}`)},updatePurchaseOrder(r,e){return t.patch(`/purchase-orders/${r}`,e)}};const h=m(""),O=async r=>{const{data:e}=await o.getPurchaseOrders(r);return e},P=async r=>{const{data:e}=h.value==="PRESUPUESTO"?await o.createPurchaseOrder(r):await o.createPurchaseOrderFromRequisition(r);return e},g=async()=>{const{data:r}=await o.getPurchaseDictionary();return r},E=async({id:r,purchaseOrder:e})=>{const{data:a}=await o.updatePurchaseOrder(r,e);return a},x=()=>{const r=n();return{updatePurchaseOrderMutation:d({mutationFn:E,onSuccess:async()=>{await r.invalidateQueries({queryKey:["purchase-orders"]}),s.showSuccessNotification("Orden de compra actualizada con \xE9xito")},onError:()=>{s.showErrorNotification("Error al actualizar orden de compra")}})}},D=({fromSubBudgets:r,selectedBudget:e})=>{n();const{isLoading:a,isError:c,data:u,isFetching:i,refetch:p}=y({queryKey:["purchase-orders",r,e],queryFn:()=>O(r.value),staleTime:1e3*60});return{isLoading:a,isError:c,orders:u,isFetching:i,purchaseOrderType:h}},b=({fromSubBudgets:r})=>{const e=n(),{isLoading:a,isError:c,mutateAsync:u,data:i}=d({mutationFn:P,onSuccess:async()=>{s.showSuccessNotification("Orden de compra creada con \xE9xito"),await e.invalidateQueries(["purchase-orders"])},onError:()=>{s.showErrorNotification("Error al crear orden de compra")}});return{purchaseOrder:i,createPurchaseOrder:u,isLoading:a,isError:c,purchaseOrderType:h}},v=()=>{const{isLoading:r,isError:e,data:a}=y({queryKey:["purchase-dictionary"],queryFn:g,staleTime:6e4});return{isLoading:r,isError:e,dictionary:a}},C=({fromSubBudgets:r})=>{const e=n(),{isLoading:a,isError:c,mutateAsync:u}=d({mutationFn:async({id:i,requisitionType:p})=>{const{data:l}=await o.deletePurchaseOrder({id:i,requisitionType:p});return l},onSuccess:async()=>{s.showSuccessNotification("Orden de compra eliminada con \xE9xito"),await e.invalidateQueries(["purchase-orders"])},onError:()=>{s.showErrorNotification("Error al eliminar orden de compra")}});return{deletePurchaseOrder:u,isDeleteingPurchaseOrder:a,isErrorDeletingPurchaseOrder:c}};export{o as P,x as a,D as b,C as c,v as d,b as u};
